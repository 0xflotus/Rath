{"version":3,"sources":["../webpack/bootstrap","../../../node_modules/cube-core/built/index.js","../../../node_modules/cube-core/built/utils/aggregation.js","../../../node_modules/cube-core/built/core/index.js","../../../node_modules/cube-core/built/core/periodCube.js","../../../node_modules/cube-core/built/core/momentCube.js","../../../node_modules/cube-core/built/utils/transform.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../../visual-insights/build/esm/impurityMeasure.js","../../visual-insights/build/esm/specification.js","../../visual-insights/build/esm/insights/impurity.js","../../visual-insights/build/esm/insights/cluster.js","../../visual-insights/build/esm/dashboard/utils.js","../../visual-insights/build/esm/dashboard/index.js","workers/dashboard.worker.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","this","__assign","index_1","transform_1","aggregation_1","operatorMap","sum_unsafe","mean","count","createCube","_a","type","_b","aggFunc","_c","factTable","_d","dimensions","_e","measures","periodCube","momentCube","default","props","asFields","operator","dataSource","cube","table","tree2Table","forEach","row","as","__export","subset","sums","mea","_loop_1","len","length","sum","_loop_2","Number","MEASURES","cnts","_loop_3","periodCube_1","momentCube_1","__read","iterator","e","ar","next","done","push","error","__spread","arguments","concat","__values","TypeError","Node","children","Map","_rawData","cache","params","_i","apply","aggData","_aggData","rawData","clearCache","e_1","size","values","children_1","children_1_1","child","data","e_1_1","return","configurable","getNode","search","node","level","e_2","entries","children_2","children_2_1","childName","e_2_1","tree","e_3","children_3","children_3_1","e_3_1","buildTree","insertNode","record","member","has","set","aggTree","e_4","children_4","children_4_1","e_4_1","aggNode","e_5","children_5","children_5_1","e_5_1","setData","assign","dfs","_toConsumableArray","arr","Array","isArray","arr2","iter","toString","from","normalize","frequencyList","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","f","err","map","entropy","probabilityList","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","Math","log2","linearMapPositive","min","a","correlation","fieldX","fieldY","xBar","yBar","sqrt","pow","turnAdjMatrix2List","matrix","edges","j","abs","find","parents","union","n1","n2","p1","p2","findWithEffect","sizes","unionWithEffect","size1","size2","_ref","groups","_ref$groupMaxSize","method","groupMaxSize","_ref$limitSize","limitSize","sort","b","edge","_i2","Set","kruskalWithLimitSize","groupNumber","kruskal","ans","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","meas","meaIndex","crammersV","xSet","ySet","xMembers","yMembers","xDict","yDict","x","y","chis","rowSums","colSums","totalSum","_j","observed","expected","chiSquared","getEntropyMatrix","dimensionsList","_loop","pL","getDashBoardSubspace","fieldFeatureList","correlationMatrix","measureGroups","round","dimCorrelationMatrix","dimensionsInDashBoardSet","fieldFeature","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","dim","add","dimensionsInDashBoard","dashBoardSpaces","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_loop2","group","g","mea1Index","indexOf","_j2","mea2Index","dMatrix","_i3","dim1Index","_j3","dim2Index","dimensionCorrelationMatrix","entropyMatrix","_iterator3","getDashBoardView","dashBoardSpace","visViewList","_loop3","meaIndexList","dimScoreList","index","score","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","dimInView","minIndex","dimensionGroups","dimGroupEntropyMatrix","meaInView","maxValue","Infinity","pos","self","addEventListener","subspaces","subspace","measureScore","transSubspaces2FieldsFeature","dashBoardSubspaces","dashBoardViewList","viewsInDashBoard","postMessage","success","message"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,qBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,IAIjBlC,EAAoBA,EAAoBmC,EAAI,G,+BChFtCC,MAAQA,KAAKC,SAsB5BvB,OAAOC,eAAeb,EAAS,aAAc,CAC3CmB,OAAO,IAGT,IAAIiB,EAAU,EAAQ,GAGlBC,EAAc,EAAQ,GAEtBC,EAAgB,EAAQ,GAExBC,EAAc,CAChB,IAAOD,EAAcE,WACrB,KAAQF,EAAcG,KACtB,MAASH,EAAcI,OAoCzB,SAASC,EAAWC,GAClB,IAAIC,EAAOD,EAAGC,KACVC,EAAKF,EAAGG,QACRA,OAAiB,IAAPD,EAAgBR,EAAcI,MAAQI,EAChDE,EAAKJ,EAAGK,UACRA,OAAmB,IAAPD,EAAgB,GAAKA,EACjCE,EAAKN,EAAGO,WACRA,OAAoB,IAAPD,EAAgB,GAAKA,EAClCE,EAAKR,EAAGS,SACRA,OAAkB,IAAPD,EAAgB,GAAKA,EAEpC,OAAQP,GACN,IAAK,SACH,OAAO,IAAIT,EAAQkB,WAAW,CAC5BP,QAASA,EACTE,UAAWA,EACXE,WAAYA,EACZE,SAAUA,IAGd,IAAK,SAQL,QACE,OAAO,IAAIjB,EAAQmB,WAAW,CAC5BR,QAASA,EACTE,UAAWA,EACXE,WAAYA,EACZE,SAAUA,KAKlBrD,EAAQ2C,WAAaA,EACrB3C,EAAQwD,QAlER,SAAmBC,GACjB,IAAIN,EAAaM,EAAMN,WACnBE,EAAWI,EAAMJ,SACjBK,EAAWD,EAAMC,SACjBC,EAAWF,EAAME,SACjBC,EAAaH,EAAMG,WAEnBC,EAAOlB,EAAW,CACpBE,KAAM,SACNE,QAASR,EAAYoB,IAAarB,EAAcI,MAChDS,WAAYA,EACZE,SAAUA,EACVJ,UAAWW,IAETE,EAAQzB,EAAY0B,WAAW,CACjCZ,WAAYA,EACZE,SAAUA,EACVQ,KAAMA,IAOR,OALAC,EAAME,SAAQ,SAAUC,GACtBP,EAASM,SAAQ,SAAUE,EAAIhE,GAC7B+D,EAAIC,GAAMD,EAAIZ,EAASnD,UAGpB4D,GArDT,SAAkBxD,GAChB,IAAK,IAAI0B,KAAK1B,EACPN,EAAQ+B,eAAeC,KAAIhC,EAAQgC,GAAK1B,EAAE0B,IA+FnDmC,CAAS,EAAQ,K,6BCjHjBvD,OAAOC,eAAeb,EAAS,aAAc,CAC3CmB,OAAO,IAGTnB,EAAQwC,WAAa,SAAU4B,EAAQf,GACrC,IAAIgB,EAAO,GACXhB,EAASW,SAAQ,SAAUM,GACzBD,EAAKC,GAAO,KASd,IANA,IAAIC,EAAU,SAAiBrE,EAAGsE,GAChCnB,EAASW,SAAQ,SAAUM,GACzBD,EAAKC,IAAQF,EAAOlE,GAAGoE,OAIlBpE,EAAI,EAAGsE,EAAMJ,EAAOK,OAAQvE,EAAIsE,EAAKtE,IAC5CqE,EAAQrE,GAGV,OAAOmE,GAGTrE,EAAQ0E,IAAM,SAAUN,EAAQf,GAC9B,IAAIgB,EAAO,GACXhB,EAASW,SAAQ,SAAUM,GACzBD,EAAKC,GAAO,KASd,IANA,IAAIK,EAAU,SAAiBzE,EAAGsE,GAChCnB,EAASW,SAAQ,SAAUM,GACzBD,EAAKC,IAAQM,OAAOR,EAAOlE,GAAGoE,KAAS,MAIlCpE,EAAI,EAAGsE,EAAMJ,EAAOK,OAAQvE,EAAIsE,EAAKtE,IAC5CyE,EAAQzE,GAGV,OAAOmE,GAGTrE,EAAQ0C,MAAQ,SAAU0B,EAAQS,GAChC,IAAIC,EAAO,GACXD,EAASb,SAAQ,SAAUM,GACzBQ,EAAKR,GAAO,KAGd,IAAK,IAAIpE,EAAI,EAAGsE,EAAMJ,EAAOK,OAAQvE,EAAIsE,EAAKtE,IAC5C2E,EAASb,SAAQ,SAAUM,GACzBQ,EAAKR,QAIT,OAAOQ,GAGT9E,EAAQyC,KAAO,SAAU2B,EAAQf,GAC/B,IAAIgB,EAAO,GACXhB,EAASW,SAAQ,SAAUM,GACzBD,EAAKC,GAAO,KASd,IANA,IAAIS,EAAU,SAAiB7E,EAAGsE,GAChCnB,EAASW,SAAQ,SAAUM,GACzBD,EAAKC,IAAQM,OAAOR,EAAOlE,GAAGoE,KAAS,MAIlCpE,EAAI,EAAGsE,EAAMJ,EAAOK,OAAQvE,EAAIsE,EAAKtE,IAC5C6E,EAAQ7E,GAMV,OAHAmD,EAASW,SAAQ,SAAUM,GACzBD,EAAKC,IAAQF,EAAOK,UAEfJ,I,6BC5ETzD,OAAOC,eAAeb,EAAS,aAAc,CAC3CmB,OAAO,IAGT,IAAI6D,EAAe,EAAQ,GAE3BhF,EAAQsD,WAAa0B,EAAaxB,QAElC,IAAIyB,EAAe,EAAQ,GAE3BjF,EAAQuD,WAAa0B,EAAazB,S,6BCVlC,IAAI0B,EAAShD,MAAQA,KAAKgD,QAAU,SAAUvE,EAAGgB,GAC/C,IAAIrB,EAAsB,oBAAXW,QAAyBN,EAAEM,OAAOkE,UACjD,IAAK7E,EAAG,OAAOK,EACf,IACIK,EAEAoE,EAHAlF,EAAII,EAAED,KAAKM,GAEX0E,EAAK,GAGT,IACE,WAAc,IAAN1D,GAAgBA,KAAM,MAAQX,EAAId,EAAEoF,QAAQC,MAClDF,EAAGG,KAAKxE,EAAEG,OAEZ,MAAOsE,GACPL,EAAI,CACFK,MAAOA,GAET,QACA,IACMzE,IAAMA,EAAEuE,OAASjF,EAAIJ,EAAU,SAAII,EAAED,KAAKH,GAC9C,QACA,GAAIkF,EAAG,MAAMA,EAAEK,OAInB,OAAOJ,GAGLK,EAAWxD,MAAQA,KAAKwD,UAAY,WACtC,IAAK,IAAIL,EAAK,GAAInF,EAAI,EAAGA,EAAIyF,UAAUlB,OAAQvE,IAC7CmF,EAAKA,EAAGO,OAAOV,EAAOS,UAAUzF,KAGlC,OAAOmF,GAGLQ,EAAW3D,MAAQA,KAAK2D,UAAY,SAAUlF,GAChD,IAAIsB,EAAsB,oBAAXhB,QAAyBA,OAAOkE,SAC3C7E,EAAI2B,GAAKtB,EAAEsB,GACX/B,EAAI,EACR,GAAII,EAAG,OAAOA,EAAED,KAAKM,GACrB,GAAIA,GAAyB,kBAAbA,EAAE8D,OAAqB,MAAO,CAC5Ca,KAAM,WAEJ,OADI3E,GAAKT,GAAKS,EAAE8D,SAAQ9D,OAAI,GACrB,CACLQ,MAAOR,GAAKA,EAAET,KACdqF,MAAO5E,KAIb,MAAM,IAAImF,UAAU7D,EAAI,0BAA4B,oCAGtDrB,OAAOC,eAAeb,EAAS,aAAc,CAC3CmB,OAAO,IAGT,IAAI4E,EAEJ,WACE,SAASA,EAAKhD,GACZb,KAAK8D,SAAW,IAAIC,IACpB/D,KAAKgE,SAAW,GAChBhE,KAAKa,QAAUA,EACfb,KAAKiE,OAAQ,EAkHf,OA/GAJ,EAAKjE,UAAU0D,KAAO,WAKpB,IAJA,IAAI5C,EAEAwD,EAAS,GAEJC,EAAK,EAAGA,EAAKV,UAAUlB,OAAQ4B,IACtCD,EAAOC,GAAMV,UAAUU,IAGxBzD,EAAKV,KAAKgE,UAAUV,KAAKc,MAAM1D,EAAI8C,EAASU,KAG/CL,EAAKjE,UAAUyE,QAAU,SAAUlD,GAUjC,YATiB,IAAbA,IACFA,EAAW,IAGRnB,KAAKiE,QACRjE,KAAKsE,SAAWtE,KAAKa,QAAQb,KAAKuE,QAASpD,GAC3CnB,KAAKiE,OAAQ,GAGRjE,KAAKsE,UAGdT,EAAKjE,UAAU4E,WAAa,WAC1BxE,KAAKiE,OAAQ,GAGfvF,OAAOC,eAAekF,EAAKjE,UAAW,UAAW,CAC/Cf,IAAK,WACH,IAAI4F,EAAK/D,EAET,IAAKV,KAAKiE,MAAO,CACf,GAA2B,IAAvBjE,KAAK8D,SAASY,KAAY,CAC5B,IAAIZ,EAAW9D,KAAK8D,SAASa,SACzBJ,EAAU,GAEd,IACE,IAAK,IAAIK,EAAajB,EAASG,GAAWe,EAAeD,EAAWxB,QAASyB,EAAaxB,KAAMwB,EAAeD,EAAWxB,OAAQ,CAChI,IAAI0B,EAAQD,EAAa5F,MACrBjB,OAAI,EACJ+G,EAAOD,EAAMP,QACbjC,EAAMyC,EAAKxC,OAEf,IAAKvE,EAAI,EAAGA,EAAIsE,EAAKtE,IACnBuG,EAAQjB,KAAKyB,EAAK/G,KAGtB,MAAOgH,GACPP,EAAM,CACJlB,MAAOyB,GAET,QACA,IACMH,IAAiBA,EAAaxB,OAAS3C,EAAKkE,EAAWK,SAASvE,EAAGvC,KAAKyG,GAC5E,QACA,GAAIH,EAAK,MAAMA,EAAIlB,OAIvBvD,KAAKgE,SAAWO,EAGlBvE,KAAKiE,OAAQ,EAGf,OAAOjE,KAAKgE,UAEdpF,YAAY,EACZsG,cAAc,IAGhBrB,EAAKjE,UAAUuF,QAAU,SAAUlE,GAmCjC,OAlCa,SAASmE,EAAOC,EAAMC,GACjC,IAAIC,EAAK7E,EAET,GAAI4E,IAAUrE,EAAWsB,OACvB,OAAO8C,EAGT,IAAIvB,EAAWuB,EAAKvB,SAAS0B,UAE7B,IACE,IAAK,IAAIC,EAAa9B,EAASG,GAAW4B,EAAeD,EAAWrC,QAASsC,EAAarC,KAAMqC,EAAeD,EAAWrC,OAAQ,CAChI,IAAIxC,EAAKoC,EAAO0C,EAAazG,MAAO,GAChC0G,EAAY/E,EAAG,GACfkE,EAAQlE,EAAG,GAEf,GAAI+E,IAAc1E,EAAWqE,GAC3B,OAAOF,EAAON,EAAOQ,EAAQ,IAGjC,MAAOM,GACPL,EAAM,CACJhC,MAAOqC,GAET,QACA,IACMF,IAAiBA,EAAarC,OAAS3C,EAAK+E,EAAWR,SAASvE,EAAGvC,KAAKsH,GAC5E,QACA,GAAIF,EAAK,MAAMA,EAAIhC,OAIvB,OAAO,KAGF6B,CAAOpF,KAAM,IAGf6D,EAvHT,GA0HIzC,EAEJ,WACE,SAASA,EAAWG,GAClBvB,KAAKa,QAAUU,EAAMV,QACrBb,KAAKe,UAAYQ,EAAMR,UACvBf,KAAKiB,WAAaM,EAAMN,WACxBjB,KAAKmB,SAAWI,EAAMJ,SA2IxB,OAxIAC,EAAWxB,UAAUf,IAAM,SAAUoC,GACnC,IACI4E,EADK7F,KACK6F,KAEV1E,GAHKnB,KAEQa,QAFRb,KAGSmB,UAoClB,OAlCa,SAASiE,EAAOC,EAAMC,GACjC,IAAIQ,EAAKpF,EAET,GAAI4E,IAAUrE,EAAWsB,OACvB,OAAO8C,EAAKhB,QAAQlD,GAGtB,IAAI2C,EAAWuB,EAAKvB,SAAS0B,UAE7B,IACE,IAAK,IAAIO,EAAapC,EAASG,GAAWkC,EAAeD,EAAW3C,QAAS4C,EAAa3C,KAAM2C,EAAeD,EAAW3C,OAAQ,CAChI,IAAIxC,EAAKoC,EAAOgD,EAAa/G,MAAO,GAChC0G,EAAY/E,EAAG,GACfkE,EAAQlE,EAAG,GAEf,GAAI+E,IAAc1E,EAAWqE,GAC3B,OAAOF,EAAON,EAAOQ,EAAQ,IAGjC,MAAOW,GACPH,EAAM,CACJvC,MAAO0C,GAET,QACA,IACMD,IAAiBA,EAAa3C,OAAS3C,EAAKqF,EAAWd,SAASvE,EAAGvC,KAAK4H,GAC5E,QACA,GAAID,EAAK,MAAMA,EAAIvC,OAIvB,OAAO,EAGF6B,CAAOS,EAAM,IAGtBzE,EAAWxB,UAAUuF,QAAU,SAAUlE,GAEvC,OADWjB,KAAK6F,KACJV,QAAQlE,IAGtBG,EAAWxB,UAAUsG,UAAY,WAC/B,IAEIlI,EAFA6H,EAAO,IAAIhC,EAAK7D,KAAKa,SACrByB,EAAMtC,KAAKe,UAAUwB,OAGzB,IAAKvE,EAAI,EAAGA,EAAIsE,EAAKtE,IACnBgC,KAAKmG,WAAWnG,KAAKe,UAAU/C,GAAI6H,EAAM,GAI3C,OADA7F,KAAK6F,KAAOA,EACLA,GAGTzE,EAAWxB,UAAUuG,WAAa,SAAUC,EAAQf,EAAMC,GAIxD,GAHAD,EAAK/B,KAAK8C,GACVf,EAAKpB,OAAQ,EAETqB,EAAQtF,KAAKiB,WAAWsB,OAAQ,CAClC,IAAI8D,EAASD,EAAOpG,KAAKiB,WAAWqE,IAE/BD,EAAKvB,SAASwC,IAAID,IACrBhB,EAAKvB,SAASyC,IAAIF,EAAQ,IAAIxC,EAAK7D,KAAKa,UAG1Cb,KAAKmG,WAAWC,EAAQf,EAAKvB,SAASjF,IAAIwH,GAASf,EAAQ,KAI/DlE,EAAWxB,UAAU4G,QAAU,SAAUnB,GACvC,IAAIoB,EAAK/F,OAEI,IAAT2E,IACFA,EAAOrF,KAAK6F,MAGd,IAAI/B,EAAWuB,EAAKvB,SAASa,SAE7B,IACE,IAAK,IAAI+B,EAAa/C,EAASG,GAAW6C,EAAeD,EAAWtD,QAASuD,EAAatD,KAAMsD,EAAeD,EAAWtD,OAAQ,CAChI,IAAI0B,EAAQ6B,EAAa1H,MACzBe,KAAKwG,QAAQ1B,IAEf,MAAO8B,GACPH,EAAM,CACJlD,MAAOqD,GAET,QACA,IACMD,IAAiBA,EAAatD,OAAS3C,EAAKgG,EAAWzB,SAASvE,EAAGvC,KAAKuI,GAC5E,QACA,GAAID,EAAK,MAAMA,EAAIlD,OAKvB,OADA8B,EAAKhB,QAAQrE,KAAKmB,UACXkE,GAGTjE,EAAWxB,UAAUiH,QAAU,SAAUxB,GACvC,IAAIyB,EAAKpG,OAEI,IAAT2E,IACFA,EAAOrF,KAAK6F,MAGd,IAAI/B,EAAWuB,EAAKvB,SAASa,SAE7B,IACE,IAAK,IAAIoC,EAAapD,EAASG,GAAWkD,EAAeD,EAAW3D,QAAS4D,EAAa3D,KAAM2D,EAAeD,EAAW3D,OAAQ,CAChI,IAAI0B,EAAQkC,EAAa/H,MACzBe,KAAKwG,QAAQ1B,IAEf,MAAOmC,GACPH,EAAM,CACJvD,MAAO0D,GAET,QACA,IACMD,IAAiBA,EAAa3D,OAAS3C,EAAKqG,EAAW9B,SAASvE,EAAGvC,KAAK4I,GAC5E,QACA,GAAID,EAAK,MAAMA,EAAIvD,OAKvB,OADA8B,EAAKhB,QAAQrE,KAAKmB,UACXkE,GAGFjE,EAhJT,GAmJAtD,EAAQwD,QAAUF,G,6BCzUlB,IAAI4B,EAAShD,MAAQA,KAAKgD,QAAU,SAAUvE,EAAGgB,GAC/C,IAAIrB,EAAsB,oBAAXW,QAAyBN,EAAEM,OAAOkE,UACjD,IAAK7E,EAAG,OAAOK,EACf,IACIK,EAEAoE,EAHAlF,EAAII,EAAED,KAAKM,GAEX0E,EAAK,GAGT,IACE,WAAc,IAAN1D,GAAgBA,KAAM,MAAQX,EAAId,EAAEoF,QAAQC,MAClDF,EAAGG,KAAKxE,EAAEG,OAEZ,MAAOsE,GACPL,EAAI,CACFK,MAAOA,GAET,QACA,IACMzE,IAAMA,EAAEuE,OAASjF,EAAIJ,EAAU,SAAII,EAAED,KAAKH,GAC9C,QACA,GAAIkF,EAAG,MAAMA,EAAEK,OAInB,OAAOJ,GAGLK,EAAWxD,MAAQA,KAAKwD,UAAY,WACtC,IAAK,IAAIL,EAAK,GAAInF,EAAI,EAAGA,EAAIyF,UAAUlB,OAAQvE,IAC7CmF,EAAKA,EAAGO,OAAOV,EAAOS,UAAUzF,KAGlC,OAAOmF,GAGLQ,EAAW3D,MAAQA,KAAK2D,UAAY,SAAUlF,GAChD,IAAIsB,EAAsB,oBAAXhB,QAAyBA,OAAOkE,SAC3C7E,EAAI2B,GAAKtB,EAAEsB,GACX/B,EAAI,EACR,GAAII,EAAG,OAAOA,EAAED,KAAKM,GACrB,GAAIA,GAAyB,kBAAbA,EAAE8D,OAAqB,MAAO,CAC5Ca,KAAM,WAEJ,OADI3E,GAAKT,GAAKS,EAAE8D,SAAQ9D,OAAI,GACrB,CACLQ,MAAOR,GAAKA,EAAET,KACdqF,MAAO5E,KAIb,MAAM,IAAImF,UAAU7D,EAAI,0BAA4B,oCAGtDrB,OAAOC,eAAeb,EAAS,aAAc,CAC3CmB,OAAO,IAGT,IAAI4E,EAEJ,WACE,SAASA,IACP7D,KAAK8D,SAAW,IAAIC,IACpB/D,KAAKuE,QAAU,GA8DjB,OA3DAV,EAAKjE,UAAU0D,KAAO,WAKpB,IAJA,IAAI5C,EAEAwD,EAAS,GAEJC,EAAK,EAAGA,EAAKV,UAAUlB,OAAQ4B,IACtCD,EAAOC,GAAMV,UAAUU,IAGxBzD,EAAKV,KAAKuE,SAASjB,KAAKc,MAAM1D,EAAI8C,EAASU,KAG9CL,EAAKjE,UAAUyE,QAAU,SAAUxD,EAASM,GAM1C,YALiB,IAAbA,IACFA,EAAW,IAGbnB,KAAKsE,SAAWzD,EAAQb,KAAKuE,QAASpD,GAC/BnB,KAAKsE,UAGdT,EAAKjE,UAAUuF,QAAU,SAAUlE,GAmCjC,OAlCa,SAASmE,EAAOC,EAAMC,GACjC,IAAIb,EAAK/D,EAET,GAAI4E,IAAUrE,EAAWsB,OACvB,OAAO8C,EAGT,IAAIvB,EAAWuB,EAAKvB,SAAS0B,UAE7B,IACE,IAAK,IAAIZ,EAAajB,EAASG,GAAWe,EAAeD,EAAWxB,QAASyB,EAAaxB,KAAMwB,EAAeD,EAAWxB,OAAQ,CAChI,IAAIxC,EAAKoC,EAAO6B,EAAa5F,MAAO,GAChC0G,EAAY/E,EAAG,GACfkE,EAAQlE,EAAG,GAEf,GAAI+E,IAAc1E,EAAWqE,GAC3B,OAAOF,EAAON,EAAOQ,EAAQ,IAGjC,MAAON,GACPP,EAAM,CACJlB,MAAOyB,GAET,QACA,IACMH,IAAiBA,EAAaxB,OAAS3C,EAAKkE,EAAWK,SAASvE,EAAGvC,KAAKyG,GAC5E,QACA,GAAIH,EAAK,MAAMA,EAAIlB,OAIvB,OAAO,KAGF6B,CAAOpF,KAAM,IAGf6D,EAjET,GAoEA/F,EAAQ+F,KAAOA,EAEf,IAAIxC,EAEJ,WACE,SAASA,EAAWE,GAClBvB,KAAKa,QAAUU,EAAMV,QACrBb,KAAKe,UAAYQ,EAAMR,UACvBf,KAAKiB,WAAaM,EAAMN,WACxBjB,KAAKmB,SAAWI,EAAMJ,SACtBnB,KAAKkG,YACLlG,KAAKwG,UA6IP,OA1IAnF,EAAWzB,UAAUf,IAAM,SAAUoC,GACnC,IACI4E,EADK7F,KACK6F,KACVhF,EAFKb,KAEQa,QACbM,EAHKnB,KAGSmB,SAoClB,OAlCa,SAASiE,EAAOC,EAAMC,GACjC,IAAIC,EAAK7E,EAET,GAAI4E,IAAUrE,EAAWsB,OACvB,OAAO8C,EAAKhB,QAAQxD,EAASM,GAG/B,IAAI2C,EAAWuB,EAAKvB,SAAS0B,UAE7B,IACE,IAAK,IAAIC,EAAa9B,EAASG,GAAW4B,EAAeD,EAAWrC,QAASsC,EAAarC,KAAMqC,EAAeD,EAAWrC,OAAQ,CAChI,IAAIxC,EAAKoC,EAAO0C,EAAazG,MAAO,GAChC0G,EAAY/E,EAAG,GACfkE,EAAQlE,EAAG,GAEf,GAAI+E,IAAc1E,EAAWqE,GAC3B,OAAOF,EAAON,EAAOQ,EAAQ,IAGjC,MAAOM,GACPL,EAAM,CACJhC,MAAOqC,GAET,QACA,IACMF,IAAiBA,EAAarC,OAAS3C,EAAK+E,EAAWR,SAASvE,EAAGvC,KAAKsH,GAC5E,QACA,GAAIF,EAAK,MAAMA,EAAIhC,OAIvB,OAAO,EAGF6B,CAAOS,EAAM,IAGtBxE,EAAWzB,UAAUuF,QAAU,SAAUlE,GAEvC,OADWjB,KAAK6F,KACJV,QAAQlE,IAGtBI,EAAWzB,UAAUsH,QAAU,SAAU3F,GACvC,IAAIb,EAAKa,EAAMV,QACXA,OAAiB,IAAPH,EAAgBV,KAAKa,QAAUH,EACzCE,EAAKW,EAAMR,UACXA,OAAmB,IAAPH,EAAgBZ,KAAKe,UAAYH,EAC7CE,EAAKS,EAAMN,WACXA,OAAoB,IAAPH,EAAgBd,KAAKiB,WAAaH,EAC/CE,EAAKO,EAAMJ,SACXA,OAAkB,IAAPH,EAAgBhB,KAAKmB,SAAWH,EAE3CC,IAAejB,KAAKiB,YAAcF,IAAcf,KAAKe,WACvDf,KAAKiB,WAAaA,EAClBjB,KAAKe,UAAYA,EACjBf,KAAKmB,SAAWA,EAChBnB,KAAKa,QAAUA,EACfb,KAAKkG,YACLlG,KAAKwG,WACIrF,IAAanB,KAAKmB,UAAYN,IAAYb,KAAKa,UACxDb,KAAKmB,SAAWA,EAChBnB,KAAKa,QAAUA,EACfb,KAAKwG,YAITnF,EAAWzB,UAAUsG,UAAY,WAC/B,IAEIlI,EAFA6H,EAAO,IAAIhC,EACXvB,EAAMtC,KAAKe,UAAUwB,OAGzB,IAAKvE,EAAI,EAAGA,EAAIsE,EAAKtE,IACnBgC,KAAKmG,WAAWnG,KAAKe,UAAU/C,GAAI6H,EAAM,GAI3C,OADA7F,KAAK6F,KAAOA,EACLA,GAGTxE,EAAWzB,UAAUuG,WAAa,SAAUC,EAAQf,EAAMC,GACxD,GAAIA,IAAUtF,KAAKiB,WAAWsB,OAC5B8C,EAAK/B,KAAK8C,OACL,CACL,IAAIC,EAASD,EAAOpG,KAAKiB,WAAWqE,IAE/BD,EAAKvB,SAASwC,IAAID,IACrBhB,EAAKvB,SAASyC,IAAIF,EAAQ,IAAIxC,GAGhC7D,KAAKmG,WAAWC,EAAQf,EAAKvB,SAASjF,IAAIwH,GAASf,EAAQ,KAI/DjE,EAAWzB,UAAU4G,QAAU,SAAUnB,GACvC,IAAIS,EAAKpF,EAMT,QAJa,IAAT2E,IACFA,EAAOrF,KAAK6F,MAGVR,EAAKvB,SAASY,KAAO,EAAG,CAC1BW,EAAKd,QAAU,GACf,IAAIT,EAAWuB,EAAKvB,SAASa,SAE7B,IACE,IAAK,IAAIoB,EAAapC,EAASG,GAAWkC,EAAeD,EAAW3C,QAAS4C,EAAa3C,KAAM2C,EAAeD,EAAW3C,OAAQ,CAChI,IAAI0B,EAAQkB,EAAa/G,MACrBjB,OAAI,EACJ+G,EAAO/E,KAAKwG,QAAQ1B,GAAOP,QAC3BjC,EAAMyC,EAAKxC,OAEf,IAAKvE,EAAI,EAAGA,EAAIsE,EAAKtE,IACnBqH,EAAKd,QAAQjB,KAAKyB,EAAK/G,KAG3B,MAAOiI,GACPH,EAAM,CACJvC,MAAO0C,GAET,QACA,IACMD,IAAiBA,EAAa3C,OAAS3C,EAAKqF,EAAWd,SAASvE,EAAGvC,KAAK4H,GAC5E,QACA,GAAID,EAAK,MAAMA,EAAIvC,QAMzB,OADA8B,EAAKhB,QAAQrE,KAAKa,QAASb,KAAKmB,UACzBkE,GAGFhE,EApJT,GAuJAvD,EAAQwD,QAAUD,G,6BCzRlB,IAAIpB,EAAWD,MAAQA,KAAKC,UAAY,WAatC,OAZAA,EAAWvB,OAAOyI,QAAU,SAAUjI,GACpC,IAAK,IAAIa,EAAG/B,EAAI,EAAGyB,EAAIgE,UAAUlB,OAAQvE,EAAIyB,EAAGzB,IAG9C,IAAK,IAAI8B,KAFTC,EAAI0D,UAAUzF,GAGRU,OAAOkB,UAAUC,eAAe1B,KAAK4B,EAAGD,KAAIZ,EAAEY,GAAKC,EAAED,IAI7D,OAAOZ,IAGOkF,MAAMpE,KAAMyD,YAG1BE,EAAW3D,MAAQA,KAAK2D,UAAY,SAAUlF,GAChD,IAAIsB,EAAsB,oBAAXhB,QAAyBA,OAAOkE,SAC3C7E,EAAI2B,GAAKtB,EAAEsB,GACX/B,EAAI,EACR,GAAII,EAAG,OAAOA,EAAED,KAAKM,GACrB,GAAIA,GAAyB,kBAAbA,EAAE8D,OAAqB,MAAO,CAC5Ca,KAAM,WAEJ,OADI3E,GAAKT,GAAKS,EAAE8D,SAAQ9D,OAAI,GACrB,CACLQ,MAAOR,GAAKA,EAAET,KACdqF,MAAO5E,KAIb,MAAM,IAAImF,UAAU7D,EAAI,0BAA4B,oCAGlDiD,EAAShD,MAAQA,KAAKgD,QAAU,SAAUvE,EAAGgB,GAC/C,IAAIrB,EAAsB,oBAAXW,QAAyBN,EAAEM,OAAOkE,UACjD,IAAK7E,EAAG,OAAOK,EACf,IACIK,EAEAoE,EAHAlF,EAAII,EAAED,KAAKM,GAEX0E,EAAK,GAGT,IACE,WAAc,IAAN1D,GAAgBA,KAAM,MAAQX,EAAId,EAAEoF,QAAQC,MAClDF,EAAGG,KAAKxE,EAAEG,OAEZ,MAAOsE,GACPL,EAAI,CACFK,MAAOA,GAET,QACA,IACMzE,IAAMA,EAAEuE,OAASjF,EAAIJ,EAAU,SAAII,EAAED,KAAKH,GAC9C,QACA,GAAIkF,EAAG,MAAMA,EAAEK,OAInB,OAAOJ,GAGTzE,OAAOC,eAAeb,EAAS,aAAc,CAC3CmB,OAAO,IA8CTnB,EAAQ+D,WA3CR,SAAoBN,GAClB,IAAIN,EAAaM,EAAMN,WAEnBU,GADWJ,EAAMJ,SACVI,EAAMI,MAEbC,GADUD,EAAKd,QACP,IAmCZ,OAjCA,SAASuG,EAAI/B,EAAMe,EAAQd,GACzB,IAAIb,EAAK/D,EAAIE,EAEb,GAA2B,IAAvByE,EAAKvB,SAASY,KAMlB,IACE,IAAK,IAAI5D,EAAK6C,EAAS0B,EAAKvB,SAAS0B,WAAYxE,EAAKF,EAAGsC,QAASpC,EAAGqC,KAAMrC,EAAKF,EAAGsC,OAAQ,CACzF,IAAIlC,EAAK8B,EAAOhC,EAAG/B,MAAO,GACtB0G,EAAYzE,EAAG,GAKnBkG,EAJYlG,EAAG,GAEPjB,EAASA,EAAS,GAAImG,KAAUxF,EAAK,IAAOK,EAAWqE,IAAUK,EAAW/E,IAEtE0E,EAAQ,IAExB,MAAON,GACPP,EAAM,CACJlB,MAAOyB,GAET,QACA,IACMhE,IAAOA,EAAGqC,OAAS3C,EAAKI,EAAGmE,SAASvE,EAAGvC,KAAK2C,GAChD,QACA,GAAI2D,EAAK,MAAMA,EAAIlB,WAxBvB,CACE,IAAIoB,EAASU,EAAKf,SAClB1C,EAAM0B,KAAKrD,EAASA,EAAS,GAAImG,GAASzB,KA2B9CyC,CAAIzF,EAAKkE,KAAM,GAAI,GACZjE,I,6CCvGM,SAASyF,EAAmBC,GACzC,OCJa,SAA4BA,GACzC,GAAIC,MAAMC,QAAQF,GAAM,CACtB,IAAK,IAAItJ,EAAI,EAAGyJ,EAAO,IAAIF,MAAMD,EAAI/E,QAASvE,EAAIsJ,EAAI/E,OAAQvE,IAC5DyJ,EAAKzJ,GAAKsJ,EAAItJ,GAGhB,OAAOyJ,GDFF,CAAkBH,IEJZ,SAA0BI,GACvC,GAAI3I,OAAOkE,YAAYvE,OAAOgJ,IAAkD,uBAAzChJ,OAAOkB,UAAU+H,SAASxJ,KAAKuJ,GAAgC,OAAOH,MAAMK,KAAKF,GFGvF,CAAgBJ,IGJpC,WACb,MAAM,IAAI1D,UAAU,mDHGqC,G,8JIJ3D,SAASiE,EAAUC,GACjB,IAAItF,EAAM,EACNuF,GAA4B,EAC5BC,GAAoB,EACpBC,OAAiBC,EAErB,IACE,IAAK,IAAkDC,EAA9CC,EAAYN,EAAc/I,OAAOkE,cAAsB8E,GAA6BI,EAAQC,EAAUhF,QAAQC,MAAO0E,GAA4B,EAAM,CAC9J,IAAIM,EAAIF,EAAMlJ,MACduD,GAAO6F,GAET,MAAOC,GACPN,GAAoB,EACpBC,EAAiBK,EACjB,QACA,IACOP,GAAiD,MAApBK,EAAUnD,QAC1CmD,EAAUnD,SAEZ,QACA,GAAI+C,EACF,MAAMC,GAKZ,OAAOH,EAAcS,KAAI,SAAUF,GACjC,OAAOA,EAAI7F,KAIf,IAAIgG,EAAU,SAAiBC,GAC7B,IAAIjG,EAAM,EACNkG,GAA6B,EAC7BC,GAAqB,EACrBC,OAAkBV,EAEtB,IACE,IAAK,IAAqDW,EAAjDC,EAAaL,EAAgB1J,OAAOkE,cAAuByF,GAA8BG,EAASC,EAAW1F,QAAQC,MAAOqF,GAA6B,EAAM,CACtK,IAAI5I,EAAI+I,EAAO5J,MACfuD,GAAO1C,EAAIiJ,KAAKC,KAAKlJ,IAEvB,MAAOwI,GACPK,GAAqB,EACrBC,EAAkBN,EAClB,QACA,IACOI,GAAmD,MAArBI,EAAW7D,QAC5C6D,EAAW7D,SAEb,QACA,GAAI0D,EACF,MAAMC,GAKZ,OAAQpG,GCwEK,I,gBChGR,SAASyG,EAAkB3B,GAChC,IAAI4B,EAAMH,KAAKG,IAAI9E,MAAM2E,KAAM1B,EAAmBC,IAClD,OAAOA,EAAIiB,KAAI,SAAUY,GACvB,OAAOA,EAAID,EAAM,KAIrB,SAAS,EAAI5B,GAGX,IAFA,IAAI9E,EAAM,EAEDxE,EAAI,EAAGsE,EAAMgF,EAAI/E,OAAQvE,EAAIsE,EAAKtE,IAEzCwE,GAAO8E,EAAItJ,GAGb,OAAOwE,EAGF,SAAS4G,EAAY1H,EAAY2H,EAAQC,GAC9C,IACIC,EAAO,EAAI7H,EAAW6G,KAAI,SAAUzJ,GACtC,OAAOA,EAAEuK,OACL3H,EAAWa,OACbiH,EAAO,EAAI9H,EAAW6G,KAAI,SAAUzJ,GACtC,OAAOA,EAAEwK,OACL5H,EAAWa,OAQjB,OAPI,EAAIb,EAAW6G,KAAI,SAAUzJ,GAC/B,OAAQA,EAAEuK,GAAUE,IAASzK,EAAEwK,GAAUE,OACrCT,KAAKU,KAAK,EAAI/H,EAAW6G,KAAI,SAAUzJ,GAC3C,OAAOiK,KAAKW,IAAI5K,EAAEuK,GAAUE,EAAM,OAC9B,EAAI7H,EAAW6G,KAAI,SAAUzJ,GACjC,OAAOiK,KAAKW,IAAI5K,EAAEwK,GAAUE,EAAM,QC1DtC,SAASG,EAAmBC,GAI1B,IAFA,IAAIC,EAAQ,GAEH7L,EAAI,EAAGA,EAAI4L,EAAOrH,OAAQvE,IACjC,IAAK,IAAI8L,EAAI9L,EAAI,EAAG8L,EAAIF,EAAO5L,GAAGuE,OAAQuH,IACxCD,EAAMvG,KAAK,CAAC,CAACtF,EAAG8L,GAAIf,KAAKgB,IAAIH,EAAO5L,GAAG8L,MAI3C,OAAOD,EAGT,SAASG,EAAKC,EAASxK,GACrB,OAAOwK,EAAQxK,KAAOA,EAAIA,EAAIwK,EAAQxK,GAAKuK,EAAKC,EAASA,EAAQxK,IAGnE,SAASyK,EAAMD,EAASE,EAAIC,GAC1B,IAAIC,EAAKL,EAAKC,EAASE,GACnBG,EAAKN,EAAKC,EAASG,GACvBH,EAAQI,GAAMC,EAGdN,EAAKC,EAASE,GACdH,EAAKC,EAASG,GAGhB,SAASG,EAAeN,EAASO,EAAO/K,GACtC,OAAIwK,EAAQxK,KAAOA,EACVA,GAGTwK,EAAQxK,GAAK8K,EAAeN,EAASO,EAAOP,EAAQxK,IACpD+K,EAAM/K,GAAK+K,EAAMP,EAAQxK,IAClBwK,EAAQxK,IAGjB,SAASgL,EAAgBR,EAASO,EAAOL,EAAIC,GAC3C,IAAIC,EAAKE,EAAeN,EAASO,EAAOL,GACpCG,EAAKC,EAAeN,EAASO,EAAOJ,GACpCM,EAAQF,EAAMH,GACdM,EAAQH,EAAMF,GAClBL,EAAQI,GAAMC,EACdE,EAAMH,GAAMG,EAAMF,GAAMI,EAAQC,EAChCJ,EAAeN,EAASO,EAAOL,GAC/BI,EAAeN,EAASO,EAAOJ,GA2UlB,MAhDf,SAAiBQ,GACf,IASIC,EATAjB,EAASgB,EAAKhB,OACdzI,EAAWyJ,EAAKzJ,SAGhB2J,GAFcF,EAAKG,OAECH,EAAKI,cACzBA,OAAqC,IAAtBF,EAA+B,EAAIA,EAClDG,EAAiBL,EAAKM,UAMxBL,OALiC,IAAnBI,GAAoCA,EA1NtD,SAA8BrB,EAAQsB,GACpC,IAAIrB,EAAQF,EAAmBC,GAC/BC,EAAMsB,MAAK,SAAUhC,EAAGiC,GACtB,OAAOA,EAAE,GAAKjC,EAAE,MAElB,IAAIc,EAAUL,EAAOrB,KAAI,SAAUnK,EAAGJ,GACpC,OAAOA,KAELwM,EAAQZ,EAAOrB,KAAI,WACrB,OAAO,KAELG,GAA6B,EAC7BC,GAAqB,EACrBC,OAAkBV,EAEtB,IACE,IAAK,IAA2CW,EAAvCC,EAAae,EAAM9K,OAAOkE,cAAuByF,GAA8BG,EAASC,EAAW1F,QAAQC,MAAOqF,GAA6B,EAAM,CAC5J,IAAI2C,EAAOxC,EAAO5J,MAElB,GAAIsL,EAAeN,EAASO,EAAOa,EAAK,GAAG,MAAQd,EAAeN,EAASO,EAAOa,EAAK,GAAG,IAAK,CAC7F,GAAIb,EAAMa,EAAK,GAAG,IAAMb,EAAMa,EAAK,GAAG,IAAMH,EAC1C,SAGFT,EAAgBR,EAASO,EAAOa,EAAK,GAAG,GAAIA,EAAK,GAAG,IAGtD,IAAK,IAAIC,EAAM,EAAGA,EAAMrB,EAAQ1H,OAAQ+I,IACtCrB,EAAQqB,GAAOf,EAAeN,EAASO,EAAOc,GAKhD,GAAiB,IAFP,IAAIC,IAAItB,GAEVvF,KACN,OAGJ,MAAO4D,GACPK,GAAqB,EACrBC,EAAkBN,EAClB,QACA,IACOI,GAAmD,MAArBI,EAAW7D,QAC5C6D,EAAW7D,SAEb,QACA,GAAI0D,EACF,MAAMC,GAOZ,IAFA,IAAIiC,EAAS,IAAI9G,IAER/F,EAAI,EAAGA,EAAIiM,EAAQ1H,OAAQvE,IAC7B6M,EAAOvE,IAAI2D,EAAQjM,KACtB6M,EAAOtE,IAAI0D,EAAQjM,GAAI,IAGzB6M,EAAOhM,IAAIoL,EAAQjM,IAAIsF,KAAKtF,GAG9B,OAAO6M,EAiKIW,CAAqB5B,EAAQoB,GA/R1C,SAAiBpB,EAAQ6B,GACvB,IAAI5B,EAAQF,EAAmBC,GAC/BC,EAAMsB,MAAK,SAAUhC,EAAGiC,GACtB,OAAOA,EAAE,GAAKjC,EAAE,MAElB,IAAIc,EAAUL,EAAOrB,KAAI,SAAUnK,EAAGJ,GACpC,OAAOA,KAEL+J,GAA4B,EAC5BC,GAAoB,EACpBC,OAAiBC,EAErB,IACE,IAAK,IAA0CC,EAAtCC,EAAYyB,EAAM9K,OAAOkE,cAAsB8E,GAA6BI,EAAQC,EAAUhF,QAAQC,MAAO0E,GAA4B,EAAM,CACtJ,IAAIsD,EAAOlD,EAAMlJ,MAEb+K,EAAKC,EAASoB,EAAK,GAAG,MAAQrB,EAAKC,EAASoB,EAAK,GAAG,KACtDnB,EAAMD,EAASoB,EAAK,GAAG,GAAIA,EAAK,GAAG,IAGrC,IAAK,IAAIlH,EAAK,EAAGA,EAAK8F,EAAQ1H,OAAQ4B,IACpC8F,EAAQ9F,GAAM6F,EAAKC,EAAS9F,GAK9B,GAFU,IAAIoH,IAAItB,GAEVvF,MAAQ+G,EACd,OAGJ,MAAOnD,GACPN,GAAoB,EACpBC,EAAiBK,EACjB,QACA,IACOP,GAAiD,MAApBK,EAAUnD,QAC1CmD,EAAUnD,SAEZ,QACA,GAAI+C,EACF,MAAMC,GAOZ,IAFA,IAAI4C,EAAS,IAAI9G,IAER/F,EAAI,EAAGA,EAAIiM,EAAQ1H,OAAQvE,IAC7B6M,EAAOvE,IAAI2D,EAAQjM,KACtB6M,EAAOtE,IAAI0D,EAAQjM,GAAI,IAGzB6M,EAAOhM,IAAIoL,EAAQjM,IAAIsF,KAAKtF,GAG9B,OAAO6M,EA0OIa,CAAQ9B,EAAQoB,GAG3B,IAAIW,EAAM,GACNC,GAA6B,EAC7BC,GAAqB,EACrBC,OAAkB5D,EAEtB,IACE,IAAK,IAAqD6D,EAAjDC,EAAanB,EAAOlG,SAAS5F,OAAOkE,cAAuB2I,GAA8BG,EAASC,EAAW5I,QAAQC,MAAOuI,GAA6B,EAAM,CACtK,IAAIK,EAAOF,EAAO9M,MAClB0M,EAAIrI,KAAK2I,EAAK1D,KAAI,SAAU2D,GAC1B,OAAO/K,EAAS+K,QAGpB,MAAO5D,GACPuD,GAAqB,EACrBC,EAAkBxD,EAClB,QACA,IACOsD,GAAmD,MAArBI,EAAW/G,QAC5C+G,EAAW/G,SAEb,QACA,GAAI4G,EACF,MAAMC,GAKZ,OAAOH,GC5VF,SAASQ,EAAUzK,EAAY2H,EAAQC,GAe5C,IAdA,IAAI8C,EAAO,IAAIb,IAAI7J,EAAW6G,KAAI,SAAUjK,GAC1C,OAAOA,EAAE+K,OAEPgD,EAAO,IAAId,IAAI7J,EAAW6G,KAAI,SAAUjK,GAC1C,OAAOA,EAAEgL,OAGPgD,EAAWjF,EAAmB+E,GAE9BG,EAAWlF,EAAmBgF,GAE9BG,EAAQ,GACRC,EAAQ,GAEHzO,EAAI,EAAGA,EAAIsO,EAAS/J,OAAQvE,IACnCwO,EAAMF,EAAStO,IAAMA,EAGvB,IAAK,IAAIsN,EAAM,EAAGA,EAAMiB,EAAShK,OAAQ+I,IACvCmB,EAAMF,EAASjB,IAAQA,EAGzB,IAAI1B,EAAS0C,EAAS/D,KAAI,SAAUmE,GAClC,OAAOH,EAAShE,KAAI,SAAUoE,GAC5B,OAAO,QAGP5E,GAA4B,EAC5BC,GAAoB,EACpBC,OAAiBC,EAErB,IACE,IAAK,IAA+CC,EAA3CC,EAAY1G,EAAW3C,OAAOkE,cAAsB8E,GAA6BI,EAAQC,EAAUhF,QAAQC,MAAO0E,GAA4B,EAAM,CAC3J,IAAI3B,EAAS+B,EAAMlJ,MACnB2K,EAAO4C,EAAMpG,EAAOiD,KAAUoD,EAAMrG,EAAOkD,QAE7C,MAAOhB,GACPN,GAAoB,EACpBC,EAAiBK,EACjB,QACA,IACOP,GAAiD,MAApBK,EAAUnD,QAC1CmD,EAAUnD,SAEZ,QACA,GAAI+C,EACF,MAAMC,GAKZ,IAAI2E,EAlFC,WAUL,IATA,IAAIhD,EAASnG,UAAUlB,OAAS,QAAsB2F,IAAjBzE,UAAU,GAAmBA,UAAU,GAAK,CAAC,IAC9EoJ,EAAUjD,EAAOrB,KAAI,SAAUnK,GACjC,OAAO,KAEL0O,EAAUlD,EAAO,GAAGrB,KAAI,SAAUnK,GACpC,OAAO,KAEL2O,EAAW,EAEN/O,EAAI,EAAGA,EAAI4L,EAAOrH,OAAQvE,IACjC,IAAK,IAAI8L,EAAI,EAAGA,EAAIF,EAAO5L,GAAGuE,OAAQuH,IACpC+C,EAAQ7O,IAAM4L,EAAO5L,GAAG8L,GACxBgD,EAAQhD,IAAMF,EAAO5L,GAAG8L,GACxBiD,GAAYnD,EAAO5L,GAAG8L,GAM1B,IAFA,IAAI8C,EAAO,EAEFzI,EAAK,EAAGA,EAAKyF,EAAOrH,OAAQ4B,IACnC,IAAK,IAAI6I,EAAK,EAAGA,EAAKpD,EAAOzF,GAAI5B,OAAQyK,IAAM,CAC7C,IAAIC,EAAWrD,EAAOzF,GAAI6I,GACtBE,EAAWL,EAAQ1I,GAAM2I,EAAQE,GAAMD,EAC3CH,GAAQ7D,KAAKW,IAAIuD,EAAWC,EAAU,GAAKA,EAI/C,OAAON,EAsDIO,CAAWvD,GAEtB,OADQb,KAAKU,KAAKmD,GAAQlL,EAAWa,OAASwG,KAAKG,IAAIoD,EAAS/J,OAAS,EAAGgK,EAAShK,OAAS,KC9EzF,SAAS6K,EAAiBC,EAAgBlM,EAAUO,EAAYD,GAGrE,IAFA,IAAImI,EAAS,GAEJ5L,EAAI,EAAGA,EAAIqP,EAAe9K,OAAQvE,IAAK,CAC9C,IAAIiD,EAAaoM,EAAerP,GAChC4L,EAAOtG,KAAK,IACZ,IAAIe,EAAU,IAAU,CACtB3C,WAAYA,EACZT,WAAYA,EACZE,SAAUA,EACVK,SAAUL,EACVM,SAAUA,GAAY,QAEpBsG,GAA4B,EAC5BC,GAAoB,EACpBC,OAAiBC,EAErB,IAWE,IAVA,IAUkDC,EAV9CmF,EAAQ,WACV,IAAIlL,EAAM+F,EAAMlJ,MAIZsO,EAAK1F,EAAUoB,EAHV5E,EAAQkE,KAAI,SAAUzJ,GAC7B,OAAOA,EAAEsD,QAGPnD,EAAQuJ,EAAQ+E,GACpB3D,EAAO5L,GAAGsF,KAAKrE,IAGRmJ,EAAYjH,EAASpC,OAAOkE,cAAsB8E,GAA6BI,EAAQC,EAAUhF,QAAQC,MAAO0E,GAA4B,EACnJuF,IAEF,MAAOhF,GACPN,GAAoB,EACpBC,EAAiBK,EACjB,QACA,IACOP,GAAiD,MAApBK,EAAUnD,QAC1CmD,EAAUnD,SAEZ,QACA,GAAI+C,EACF,MAAMC,IAMd,OAAO2B,EAEF,SAAS4D,EAAqB9L,EAAYT,EAAYE,EAAUsM,GAOrE,IANA,IAAIC,EAAoBvM,EAASoH,KAAI,SAAUvK,GAC7C,OAAOmD,EAASoH,KAAI,SAAUuB,GAC5B,OAAO,QAIF9L,EAAI,EAAGA,EAAImD,EAASoB,OAAQvE,IAAK,CACxC0P,EAAkB1P,GAAGA,GAAK,EAE1B,IAAK,IAAI8L,EAAI9L,EAAI,EAAG8L,EAAI3I,EAASoB,OAAQuH,IAAK,CAC5C,IAAIhL,EAAIsK,EAAY1H,EAAYP,EAASnD,GAAImD,EAAS2I,IACtD4D,EAAkB5D,GAAG9L,GAAK0P,EAAkB1P,GAAG8L,GAAKhL,GAgBxD,IAZA,IAAI6O,EAAgB,EAAQ,CAC1B/D,OAAQ8D,EACRvM,SAAUA,EACV6J,aAAcjC,KAAK6E,MAAMzM,EAASoB,OAAS,KAGzCsL,EAAuB5M,EAAWsH,KAAI,SAAUjK,GAClD,OAAO2C,EAAWsH,KAAI,SAAUjK,GAC9B,OAAO,QAIF6F,EAAK,EAAGA,EAAKlD,EAAWsB,OAAQ4B,IAAM,CAC7C0J,EAAqB1J,GAAIA,GAAM,EAE/B,IAAK,IAAI6I,EAAK7I,EAAK,EAAG6I,EAAK/L,EAAWsB,OAAQyK,IAC5Ca,EAAqB1J,GAAI6I,GAAMa,EAAqBb,GAAI7I,GAAMgI,EAAUzK,EAAYT,EAAWkD,GAAKlD,EAAW+L,IAInH,IAAIc,EAA2B,IAAIvC,IAC/B7C,GAA6B,EAC7BC,GAAqB,EACrBC,OAAkBV,EAEtB,IACE,IAAK,IAAsDW,EAAlDC,EAAa2E,EAAiB1O,OAAOkE,cAAuByF,GAA8BG,EAASC,EAAW1F,QAAQC,MAAOqF,GAA6B,EAAM,CACvK,IAAIqF,EAAelF,EAAO5J,MACtB+O,GAA6B,EAC7BC,GAAqB,EACrBC,OAAkBhG,EAEtB,IACE,IAAK,IAAqDiG,EAAjDC,EAAaL,EAAa,GAAGhP,OAAOkE,cAAuB+K,GAA8BG,EAASC,EAAWhL,QAAQC,MAAO2K,GAA6B,EAAM,CACtK,IAAIK,EAAMF,EAAOlP,MACjB6O,EAAyBQ,IAAID,IAE/B,MAAO/F,GACP2F,GAAqB,EACrBC,EAAkB5F,EAClB,QACA,IACO0F,GAAmD,MAArBI,EAAWnJ,QAC5CmJ,EAAWnJ,SAEb,QACA,GAAIgJ,EACF,MAAMC,KAKd,MAAO5F,GACPK,GAAqB,EACrBC,EAAkBN,EAClB,QACA,IACOI,GAAmD,MAArBI,EAAW7D,QAC5C6D,EAAW7D,SAEb,QACA,GAAI0D,EACF,MAAMC,GAKZ,IAAI2F,EAAwBlH,EAAmByG,GAE3CU,EAAkB,GAClBC,GAA6B,EAC7BC,GAAqB,EACrBC,OAAkBzG,EAEtB,IA4CE,IA3CA,IA2CwD0G,EA3CpDC,EAAS,WAQX,IAPA,IAAIC,EAAQF,EAAO3P,MACf2K,EAASkF,EAAMvG,KAAI,SAAUwG,GAC/B,OAAOD,EAAMvG,KAAI,SAAUzI,GACzB,OAAO,QAIFwL,EAAM,EAAGA,EAAMwD,EAAMvM,OAAQ+I,IAGpC,IAFA,IAAI0D,EAAY7N,EAAS8N,QAAQH,EAAMxD,IAE9B4D,EAAM,EAAGA,EAAMJ,EAAMvM,OAAQ2M,IAAO,CAC3C,IAAIC,EAAYhO,EAAS8N,QAAQH,EAAMI,IACvCtF,EAAO0B,GAAK4D,GAAOxB,EAAkBsB,GAAWG,GAUpD,IANA,IAAIC,EAAUb,EAAsBhG,KAAI,SAAUjK,GAChD,OAAOiQ,EAAsBhG,KAAI,SAAUjK,GACzC,OAAO,QAIF+Q,EAAM,EAAGA,EAAMd,EAAsBhM,OAAQ8M,IAGpD,IAFA,IAAIC,EAAYrO,EAAWgO,QAAQV,EAAsBc,IAEhDE,EAAM,EAAGA,EAAMhB,EAAsBhM,OAAQgN,IAAO,CAC3D,IAAIC,EAAYvO,EAAWgO,QAAQV,EAAsBgB,IACzDH,EAAQC,GAAKE,GAAO1B,EAAqByB,GAAWE,GAIxDhB,EAAgBlL,KAAK,CACnBrC,WAAYsN,EACZpN,SAAU2N,EACVpB,kBAAmB9D,EACnB6F,2BAA4BL,EAC5BM,cAAetC,EAAiBmB,EAAsBhG,KAAI,SAAU8F,GAClE,MAAO,CAACA,MACNS,EAAOpN,MAINiO,EAAahC,EAAc5O,OAAOkE,cAAuBwL,GAA8BG,EAASe,EAAWvM,QAAQC,MAAOoL,GAA6B,EAC9JI,IAEF,MAAOvG,GACPoG,GAAqB,EACrBC,EAAkBrG,EAClB,QACA,IACOmG,GAAmD,MAArBkB,EAAW1K,QAC5C0K,EAAW1K,SAEb,QACA,GAAIyJ,EACF,MAAMC,GAKZ,OAAOH,EAQF,SAASoB,EAAiBC,EAAgBnO,GAC/C,IAAIT,EAAa4O,EAAe5O,WAC5BE,EAAW0O,EAAe1O,SAC1BuO,EAAgBG,EAAeH,cAC/BD,EAA6BI,EAAeJ,2BAM5CK,EAAc,GAKdnC,EAAgB,EAAQ,CAC1B/D,OAAQiG,EAAenC,kBACvBvM,SAAUA,EACV6J,aAAcjC,KAAK6E,MAAMzM,EAASoB,OAAS,KAGzCqJ,GAA6B,EAC7BC,GAAqB,EACrBC,OAAkB5D,EAEtB,IA0CE,IAzCA,IAyCwD6D,EAzCpDgE,EAAS,WACX,IAAIjB,EAAQ/C,EAAO9M,MACf+Q,EAAelB,EAAMvG,KAAI,SAAUnG,GACrC,OAAOjB,EAAS8N,QAAQ7M,MAEtB6N,EAAehP,EAAWsH,KAAI,SAAU8F,EAAK6B,GAC/C,IAAIC,EAAQ,EACRC,GAA6B,EAC7BC,GAAqB,EACrBC,OAAkBpI,EAEtB,IACE,IAAK,IAAkDqI,EAA9CC,EAAaR,EAAajR,OAAOkE,cAAuBmN,GAA8BG,EAASC,EAAWpN,QAAQC,MAAO+M,GAA6B,EAAM,CACnK,IAAIlE,EAAWqE,EAAOtR,MACtBkR,GAAST,EAAcQ,GAAOhE,IAEhC,MAAO5D,GACP+H,GAAqB,EACrBC,EAAkBhI,EAClB,QACA,IACO8H,GAAmD,MAArBI,EAAWvL,QAC5CuL,EAAWvL,SAEb,QACA,GAAIoL,EACF,MAAMC,GAKZ,OAAOH,KAELM,EAAYxP,EAAWyP,EAAST,IACpCH,EAAYxM,KAAK,CACf3C,KAAM,SACNM,WAAY,CAACwP,GACbtP,SAAU2N,KAIL9C,EAAa2B,EAAc5O,OAAOkE,cAAuB2I,GAA8BG,EAASC,EAAW5I,QAAQC,MAAOuI,GAA6B,EAC9JmE,IAOF,MAAOzH,GACPuD,GAAqB,EACrBC,EAAkBxD,EAClB,QACA,IACOsD,GAAmD,MAArBI,EAAW/G,QAC5C+G,EAAW/G,SAEb,QACA,GAAI4G,EACF,MAAMC,GAaZ,IARA,IAAI6E,EAAkB,EAAQ,CAC5B/G,OAAQ6F,EACRtO,SAAUF,EACV+J,aAAc,EACdE,WAAW,IAET0F,EAAwBxD,EAAiBuD,EAAiBxP,EAAUO,GAE/D1D,EAAI,EAAGA,EAAI2S,EAAgBpO,OAAQvE,IAAK,CAC/C,IAAI6S,EAAY1P,EAASuP,EAASE,EAAsB5S,KACxD8R,EAAYxM,KAAK,CACf3C,KAAM,UACNM,WAAY0P,EAAgB3S,GAC5BmD,SAAU,CAAC0P,KAIf,OAAOf,EAGT,SAASY,EAASpJ,GAChB,IAAItJ,EAAI,EACJsE,EAAMgF,EAAI/E,OACVuO,EAAWC,IACXC,GAAO,EAEX,IAAKhT,EAAI,EAAGA,EAAIsE,EAAKtE,IACfsJ,EAAItJ,GAAK8S,IACXA,EAAWxJ,EAAItJ,GACfgT,EAAMhT,GAIV,OAAOgT,ECrSTC,KAAKC,iBAAiB,UA3BKhO,IACzB,MAAM,WAAExB,EAAU,WAAET,EAAU,SAAEE,EAAQ,UAAEgQ,GAAcjO,EAAE6B,KAC1D,IACE,MAAM0I,EAlBV,SAAsC0D,GACpC,IAAI1D,EAAmB,GACvB,IAAK,IAAI2D,KAAYD,EAAW,CAC9B,IAAIE,EAAe,GACnBD,EAASjQ,SAASW,QAAQM,IACxBiP,EAAajP,EAAI7D,MAAQ6D,EAAInD,QAE/BwO,EAAiBnK,KAAK,CACpB8N,EAASnQ,WACToQ,EACAD,EAAS1D,oBAGb,OAAOD,EAKoB6D,CAA6BH,GAChDI,EAAqB,EAAU/D,qBAAqB9L,EAAYT,EAAYE,EAAUsM,GACtF+D,EAAoB,GAE1B,IAAK,IAAIxT,EAAI,EAAGA,EAAIuT,EAAmBhP,OAAQvE,IAAK,CAClD,MAAMyT,EAAmB,EAAU7B,iBAAiB2B,EAAmBvT,GAAI0D,GAC3E+P,EAAiBtG,KAAK,CAAChC,EAAGiC,IACT,YAAXjC,EAAExI,MAAiC,WAAXyK,EAAEzK,KAA0B,EACjDwI,EAAEhI,SAASoB,OAAS6I,EAAEjK,SAASoB,QAExCiP,EAAkBlO,KAAKmO,GAEzBR,KAAKS,YAAY,CACfC,SAAS,EACT5M,KAAMyM,IAER,MAAOjO,GACP0N,KAAKS,YAAY,CACfC,SAAS,EACTC,QAASrO,OAKqC","file":"86831ec2ff166372dede.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __export(m) {\n  for (var p in m) {\n    if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n  }\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar index_1 = require(\"./core/index\"); // import { JsonRecord } from './types';\n\n\nvar transform_1 = require(\"./utils/transform\");\n\nvar aggregation_1 = require(\"./utils/aggregation\");\n\nvar operatorMap = {\n  'sum': aggregation_1.sum_unsafe,\n  'mean': aggregation_1.mean,\n  'count': aggregation_1.count\n};\n\nfunction copyDataSource(data) {\n  return data.map(function (row) {\n    return __assign({}, row);\n  });\n}\n\nfunction aggregate(props) {\n  var dimensions = props.dimensions,\n      measures = props.measures,\n      asFields = props.asFields,\n      operator = props.operator,\n      dataSource = props.dataSource;\n  var data = [];\n  var cube = createCube({\n    type: 'moment',\n    aggFunc: operatorMap[operator] || aggregation_1.count,\n    dimensions: dimensions,\n    measures: measures,\n    factTable: dataSource\n  });\n  var table = transform_1.tree2Table({\n    dimensions: dimensions,\n    measures: measures,\n    cube: cube\n  });\n  table.forEach(function (row) {\n    asFields.forEach(function (as, i) {\n      row[as] = row[measures[i]];\n    });\n  });\n  return table;\n}\n\nfunction createCube(_a) {\n  var type = _a.type,\n      _b = _a.aggFunc,\n      aggFunc = _b === void 0 ? aggregation_1.count : _b,\n      _c = _a.factTable,\n      factTable = _c === void 0 ? [] : _c,\n      _d = _a.dimensions,\n      dimensions = _d === void 0 ? [] : _d,\n      _e = _a.measures,\n      measures = _e === void 0 ? [] : _e;\n\n  switch (type) {\n    case \"period\":\n      return new index_1.periodCube({\n        aggFunc: aggFunc,\n        factTable: factTable,\n        dimensions: dimensions,\n        measures: measures\n      });\n\n    case \"moment\":\n      return new index_1.momentCube({\n        aggFunc: aggFunc,\n        factTable: factTable,\n        dimensions: dimensions,\n        measures: measures\n      });\n\n    default:\n      return new index_1.momentCube({\n        aggFunc: aggFunc,\n        factTable: factTable,\n        dimensions: dimensions,\n        measures: measures\n      });\n  }\n}\n\nexports.createCube = createCube;\nexports.default = aggregate;\n\n__export(require(\"./utils/aggregation\"));","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.sum_unsafe = function (subset, measures) {\n  var sums = {};\n  measures.forEach(function (mea) {\n    sums[mea] = 0;\n  });\n\n  var _loop_1 = function _loop_1(i, len) {\n    measures.forEach(function (mea) {\n      sums[mea] += subset[i][mea];\n    });\n  };\n\n  for (var i = 0, len = subset.length; i < len; i++) {\n    _loop_1(i, len);\n  }\n\n  return sums;\n};\n\nexports.sum = function (subset, measures) {\n  var sums = {};\n  measures.forEach(function (mea) {\n    sums[mea] = 0;\n  });\n\n  var _loop_2 = function _loop_2(i, len) {\n    measures.forEach(function (mea) {\n      sums[mea] += Number(subset[i][mea]) || 0;\n    });\n  };\n\n  for (var i = 0, len = subset.length; i < len; i++) {\n    _loop_2(i, len);\n  }\n\n  return sums;\n};\n\nexports.count = function (subset, MEASURES) {\n  var cnts = {};\n  MEASURES.forEach(function (mea) {\n    cnts[mea] = 0;\n  });\n\n  for (var i = 0, len = subset.length; i < len; i++) {\n    MEASURES.forEach(function (mea) {\n      cnts[mea]++;\n    });\n  }\n\n  return cnts;\n};\n\nexports.mean = function (subset, measures) {\n  var sums = {};\n  measures.forEach(function (mea) {\n    sums[mea] = 0;\n  });\n\n  var _loop_3 = function _loop_3(i, len) {\n    measures.forEach(function (mea) {\n      sums[mea] += Number(subset[i][mea]) || 0;\n    });\n  };\n\n  for (var i = 0, len = subset.length; i < len; i++) {\n    _loop_3(i, len);\n  }\n\n  measures.forEach(function (mea) {\n    sums[mea] /= subset.length;\n  });\n  return sums;\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar periodCube_1 = require(\"./periodCube\");\n\nexports.periodCube = periodCube_1.default;\n\nvar momentCube_1 = require(\"./momentCube\");\n\nexports.momentCube = momentCube_1.default;","\"use strict\";\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Node =\n/** @class */\nfunction () {\n  function Node(aggFunc) {\n    this.children = new Map();\n    this._rawData = [];\n    this.aggFunc = aggFunc;\n    this.cache = false;\n  }\n\n  Node.prototype.push = function () {\n    var _a;\n\n    var params = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      params[_i] = arguments[_i];\n    }\n\n    (_a = this._rawData).push.apply(_a, __spread(params));\n  };\n\n  Node.prototype.aggData = function (measures) {\n    if (measures === void 0) {\n      measures = [];\n    }\n\n    if (!this.cache) {\n      this._aggData = this.aggFunc(this.rawData, measures);\n      this.cache = true;\n    }\n\n    return this._aggData;\n  };\n\n  Node.prototype.clearCache = function () {\n    this.cache = false;\n  };\n\n  Object.defineProperty(Node.prototype, \"rawData\", {\n    get: function get() {\n      var e_1, _a;\n\n      if (!this.cache) {\n        if (this.children.size !== 0) {\n          var children = this.children.values();\n          var rawData = [];\n\n          try {\n            for (var children_1 = __values(children), children_1_1 = children_1.next(); !children_1_1.done; children_1_1 = children_1.next()) {\n              var child = children_1_1.value;\n              var i = void 0;\n              var data = child.rawData;\n              var len = data.length;\n\n              for (i = 0; i < len; i++) {\n                rawData.push(data[i]);\n              }\n            }\n          } catch (e_1_1) {\n            e_1 = {\n              error: e_1_1\n            };\n          } finally {\n            try {\n              if (children_1_1 && !children_1_1.done && (_a = children_1.return)) _a.call(children_1);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n          }\n\n          this._rawData = rawData;\n        }\n\n        this.cache = true;\n      }\n\n      return this._rawData;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Node.prototype.getNode = function (dimensions) {\n    var search = function search(node, level) {\n      var e_2, _a;\n\n      if (level === dimensions.length) {\n        return node;\n      }\n\n      var children = node.children.entries();\n\n      try {\n        for (var children_2 = __values(children), children_2_1 = children_2.next(); !children_2_1.done; children_2_1 = children_2.next()) {\n          var _b = __read(children_2_1.value, 2),\n              childName = _b[0],\n              child = _b[1];\n\n          if (childName === dimensions[level]) {\n            return search(child, level + 1);\n          }\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (children_2_1 && !children_2_1.done && (_a = children_2.return)) _a.call(children_2);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n\n      return null;\n    };\n\n    return search(this, 0);\n  };\n\n  return Node;\n}();\n\nvar periodCube =\n/** @class */\nfunction () {\n  function periodCube(props) {\n    this.aggFunc = props.aggFunc;\n    this.factTable = props.factTable;\n    this.dimensions = props.dimensions;\n    this.measures = props.measures;\n  }\n\n  periodCube.prototype.get = function (dimensions) {\n    var _a = this,\n        tree = _a.tree,\n        aggFunc = _a.aggFunc,\n        measures = _a.measures;\n\n    var search = function search(node, level) {\n      var e_3, _a;\n\n      if (level === dimensions.length) {\n        return node.aggData(measures);\n      }\n\n      var children = node.children.entries();\n\n      try {\n        for (var children_3 = __values(children), children_3_1 = children_3.next(); !children_3_1.done; children_3_1 = children_3.next()) {\n          var _b = __read(children_3_1.value, 2),\n              childName = _b[0],\n              child = _b[1];\n\n          if (childName === dimensions[level]) {\n            return search(child, level + 1);\n          }\n        }\n      } catch (e_3_1) {\n        e_3 = {\n          error: e_3_1\n        };\n      } finally {\n        try {\n          if (children_3_1 && !children_3_1.done && (_a = children_3.return)) _a.call(children_3);\n        } finally {\n          if (e_3) throw e_3.error;\n        }\n      }\n\n      return false;\n    };\n\n    return search(tree, 0);\n  };\n\n  periodCube.prototype.getNode = function (dimensions) {\n    var tree = this.tree;\n    return tree.getNode(dimensions);\n  };\n\n  periodCube.prototype.buildTree = function () {\n    var tree = new Node(this.aggFunc);\n    var len = this.factTable.length,\n        i;\n\n    for (i = 0; i < len; i++) {\n      this.insertNode(this.factTable[i], tree, 0);\n    }\n\n    this.tree = tree;\n    return tree;\n  };\n\n  periodCube.prototype.insertNode = function (record, node, level) {\n    node.push(record);\n    node.cache = false;\n\n    if (level < this.dimensions.length) {\n      var member = record[this.dimensions[level]];\n\n      if (!node.children.has(member)) {\n        node.children.set(member, new Node(this.aggFunc));\n      }\n\n      this.insertNode(record, node.children.get(member), level + 1);\n    }\n  };\n\n  periodCube.prototype.aggTree = function (node) {\n    var e_4, _a;\n\n    if (node === void 0) {\n      node = this.tree;\n    }\n\n    var children = node.children.values();\n\n    try {\n      for (var children_4 = __values(children), children_4_1 = children_4.next(); !children_4_1.done; children_4_1 = children_4.next()) {\n        var child = children_4_1.value;\n        this.aggTree(child);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (children_4_1 && !children_4_1.done && (_a = children_4.return)) _a.call(children_4);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    node.aggData(this.measures);\n    return node;\n  };\n\n  periodCube.prototype.aggNode = function (node) {\n    var e_5, _a;\n\n    if (node === void 0) {\n      node = this.tree;\n    }\n\n    var children = node.children.values();\n\n    try {\n      for (var children_5 = __values(children), children_5_1 = children_5.next(); !children_5_1.done; children_5_1 = children_5.next()) {\n        var child = children_5_1.value;\n        this.aggTree(child);\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (children_5_1 && !children_5_1.done && (_a = children_5.return)) _a.call(children_5);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    node.aggData(this.measures);\n    return node;\n  };\n\n  return periodCube;\n}();\n\nexports.default = periodCube;","\"use strict\";\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Node =\n/** @class */\nfunction () {\n  function Node() {\n    this.children = new Map();\n    this.rawData = [];\n  }\n\n  Node.prototype.push = function () {\n    var _a;\n\n    var params = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      params[_i] = arguments[_i];\n    }\n\n    (_a = this.rawData).push.apply(_a, __spread(params));\n  };\n\n  Node.prototype.aggData = function (aggFunc, measures) {\n    if (measures === void 0) {\n      measures = [];\n    }\n\n    this._aggData = aggFunc(this.rawData, measures);\n    return this._aggData;\n  };\n\n  Node.prototype.getNode = function (dimensions) {\n    var search = function search(node, level) {\n      var e_1, _a;\n\n      if (level === dimensions.length) {\n        return node;\n      }\n\n      var children = node.children.entries();\n\n      try {\n        for (var children_1 = __values(children), children_1_1 = children_1.next(); !children_1_1.done; children_1_1 = children_1.next()) {\n          var _b = __read(children_1_1.value, 2),\n              childName = _b[0],\n              child = _b[1];\n\n          if (childName === dimensions[level]) {\n            return search(child, level + 1);\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (children_1_1 && !children_1_1.done && (_a = children_1.return)) _a.call(children_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return null;\n    };\n\n    return search(this, 0);\n  };\n\n  return Node;\n}();\n\nexports.Node = Node;\n\nvar momentCube =\n/** @class */\nfunction () {\n  function momentCube(props) {\n    this.aggFunc = props.aggFunc;\n    this.factTable = props.factTable;\n    this.dimensions = props.dimensions;\n    this.measures = props.measures;\n    this.buildTree();\n    this.aggTree();\n  }\n\n  momentCube.prototype.get = function (dimensions) {\n    var _a = this,\n        tree = _a.tree,\n        aggFunc = _a.aggFunc,\n        measures = _a.measures;\n\n    var search = function search(node, level) {\n      var e_2, _a;\n\n      if (level === dimensions.length) {\n        return node.aggData(aggFunc, measures);\n      }\n\n      var children = node.children.entries();\n\n      try {\n        for (var children_2 = __values(children), children_2_1 = children_2.next(); !children_2_1.done; children_2_1 = children_2.next()) {\n          var _b = __read(children_2_1.value, 2),\n              childName = _b[0],\n              child = _b[1];\n\n          if (childName === dimensions[level]) {\n            return search(child, level + 1);\n          }\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (children_2_1 && !children_2_1.done && (_a = children_2.return)) _a.call(children_2);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n\n      return false;\n    };\n\n    return search(tree, 0);\n  };\n\n  momentCube.prototype.getNode = function (dimensions) {\n    var tree = this.tree;\n    return tree.getNode(dimensions);\n  };\n\n  momentCube.prototype.setData = function (props) {\n    var _a = props.aggFunc,\n        aggFunc = _a === void 0 ? this.aggFunc : _a,\n        _b = props.factTable,\n        factTable = _b === void 0 ? this.factTable : _b,\n        _c = props.dimensions,\n        dimensions = _c === void 0 ? this.dimensions : _c,\n        _d = props.measures,\n        measures = _d === void 0 ? this.measures : _d;\n\n    if (dimensions !== this.dimensions || factTable !== this.factTable) {\n      this.dimensions = dimensions;\n      this.factTable = factTable;\n      this.measures = measures;\n      this.aggFunc = aggFunc;\n      this.buildTree();\n      this.aggTree();\n    } else if (measures !== this.measures || aggFunc !== this.aggFunc) {\n      this.measures = measures;\n      this.aggFunc = aggFunc;\n      this.aggTree();\n    }\n  };\n\n  momentCube.prototype.buildTree = function () {\n    var tree = new Node();\n    var len = this.factTable.length,\n        i;\n\n    for (i = 0; i < len; i++) {\n      this.insertNode(this.factTable[i], tree, 0);\n    }\n\n    this.tree = tree;\n    return tree;\n  };\n\n  momentCube.prototype.insertNode = function (record, node, level) {\n    if (level === this.dimensions.length) {\n      node.push(record);\n    } else {\n      var member = record[this.dimensions[level]];\n\n      if (!node.children.has(member)) {\n        node.children.set(member, new Node());\n      }\n\n      this.insertNode(record, node.children.get(member), level + 1);\n    }\n  };\n\n  momentCube.prototype.aggTree = function (node) {\n    var e_3, _a;\n\n    if (node === void 0) {\n      node = this.tree;\n    }\n\n    if (node.children.size > 0) {\n      node.rawData = [];\n      var children = node.children.values();\n\n      try {\n        for (var children_3 = __values(children), children_3_1 = children_3.next(); !children_3_1.done; children_3_1 = children_3.next()) {\n          var child = children_3_1.value;\n          var i = void 0;\n          var data = this.aggTree(child).rawData;\n          var len = data.length;\n\n          for (i = 0; i < len; i++) {\n            node.rawData.push(data[i]);\n          }\n        }\n      } catch (e_3_1) {\n        e_3 = {\n          error: e_3_1\n        };\n      } finally {\n        try {\n          if (children_3_1 && !children_3_1.done && (_a = children_3.return)) _a.call(children_3);\n        } finally {\n          if (e_3) throw e_3.error;\n        }\n      }\n    }\n\n    node.aggData(this.aggFunc, this.measures);\n    return node;\n  };\n\n  return momentCube;\n}();\n\nexports.default = momentCube;","\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction tree2Table(props) {\n  var dimensions = props.dimensions,\n      measures = props.measures,\n      cube = props.cube;\n  var aggFunc = cube.aggFunc;\n  var table = [];\n\n  function dfs(node, record, level) {\n    var e_1, _a, _b;\n\n    if (node.children.size === 0) {\n      var values = node._aggData;\n      table.push(__assign(__assign({}, record), values));\n      return;\n    }\n\n    try {\n      for (var _c = __values(node.children.entries()), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var _e = __read(_d.value, 2),\n            childName = _e[0],\n            child = _e[1];\n\n        var r = __assign(__assign({}, record), (_b = {}, _b[dimensions[level]] = childName, _b));\n\n        dfs(child, r, level + 1);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  }\n\n  dfs(cube.tree, {}, 0);\n  return table;\n}\n\nexports.tree2Table = tree2Table;","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}","export default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}","export default function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}","function normalize(frequencyList) {\n  var sum = 0;\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = frequencyList[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var f = _step.value;\n      sum += f;\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return frequencyList.map(function (f) {\n    return f / sum;\n  });\n}\n\nvar entropy = function entropy(probabilityList) {\n  var sum = 0;\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = probabilityList[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var p = _step2.value;\n      sum += p * Math.log2(p);\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  return -sum;\n};\n\nvar gini = function gini(probabilityList) {\n  var sum = 0;\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    for (var _iterator3 = probabilityList[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      var p = _step3.value;\n      sum += p * (1 - p);\n    }\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  return sum;\n};\n\nexport { normalize, entropy, gini };","import _defineProperty from \"/Users/chenhao/Documents/GitHub/Rath/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { // isFieldCategory,\n// isFieldContinous,\nmemberCount } from './utils';\n\nfunction getVisualElements() {\n  return {\n    position: 2,\n    color: 1,\n    size: 1,\n    shape: 1,\n    opacity: 1,\n    facets: 2,\n    page: 1,\n    filter: 1,\n    highFacets: 1000\n  };\n}\n\nvar geomTypes = {\n  interval: [0, 20],\n  line: [21, Infinity],\n  area: [21, Infinity],\n  point: [0, 1000],\n  path: [0, 100],\n  density: [1001, Infinity]\n};\n\nfunction findBestField(type, fieldRankList) {\n  for (var i = fieldRankList.length - 1; i >= 0; i--) {\n    if (fieldRankList[i].type === type && !fieldRankList[i].choosen) {\n      return fieldRankList[i];\n    }\n  }\n\n  return false;\n}\n/**\n *\n * @param dimFields ranked dimension by entropy. asc\n * todo: not clear enough implementation for using asc and desc\n */\n\n\nfunction aestheticMapping(dimFields) {\n  var spec = {};\n  var visualElements = getVisualElements();\n  var fieldRankList = dimFields.map(function (field) {\n    return _objectSpread({}, field, {\n      choosen: false\n    });\n  });\n  var priority = [['quantitative', ['position', 'size', 'color', 'highFacets', 'opacity', 'page', 'filter']], ['temporal', ['position', 'page', 'filter']], ['ordinal', ['position', 'color', 'opacity', 'facets', 'size', 'page', 'filter', 'highFacets']], ['nominal', ['position', 'color', 'facets', 'shape', 'page', 'filter', 'hightFacets']]];\n  var fieldLeft = fieldRankList.length;\n\n  for (var typeIndex = 0; typeIndex < priority.length && fieldLeft > 0; typeIndex++) {\n    var type = priority[typeIndex][0];\n    var channelList = priority[typeIndex][1];\n\n    for (var i = 0; i < channelList.length && fieldLeft > 0; i++) {\n      var channel = channelList[i];\n      var field = void 0;\n\n      while (visualElements[channel] > 0 && (field = findBestField(type, fieldRankList))) {\n        if (typeof spec[channel] === 'undefined') {\n          spec[channel] = [];\n        }\n\n        spec[channel].push(field.name);\n        visualElements[channel]--;\n        fieldLeft--;\n        field.choosen = true;\n      }\n    }\n  }\n\n  return spec;\n} // todo:\n// don't use dimScores: FieldImpurity.\n// it's a structure with redundency design.\n\n\nfunction specification(dimScores, aggData, dimensions, measures) {\n  var rankedFields = dimScores.sort(function (a, b) {\n    return a[1] - b[1];\n  }).map(function (dim) {\n    return dim[3];\n  });\n  var spec = aestheticMapping(rankedFields); // todo: design a better rule for choosing geom type.\n\n  if (spec.position.length === 2) {\n    if (dimensions.includes(spec.position[0]) && measures.includes(spec.position[1]) || dimensions.includes(spec.position[1]) && measures.includes(spec.position[0])) {\n      var dimIndex = dimensions.includes(spec.position[0]) ? 0 : 1;\n      var dim = spec.position[dimIndex];\n      var mea = spec.position[(dimIndex + 1) % 2];\n      spec.position = [dim, mea];\n      var dimMembers = memberCount(aggData, dim);\n      spec.geomType = ['interval', 'line', 'area'].filter(function (geom) {\n        return dimMembers.length >= geomTypes[geom][0] && dimMembers.length <= geomTypes[geom][1];\n      });\n      var x = dimScores.find(function (dim) {\n        return dim[0] === spec.position[0];\n      })[3];\n      var y = dimScores.find(function (dim) {\n        return dim[0] === spec.position[1];\n      })[3];\n\n      if (x.type === 'nominal' || y.type === 'nominal') {\n        spec.geomType = ['interval'];\n      }\n    } else {\n      // ['point', 'path', 'heatmap']\n      spec.geomType = ['point', 'density'].filter(function (geom) {\n        return aggData.length >= geomTypes[geom][0] && aggData.length <= geomTypes[geom][1];\n      });\n    }\n  }\n\n  return {\n    schema: spec,\n    aggData: aggData\n  };\n}\n\nexport default specification;","import _toConsumableArray from \"/Users/chenhao/Documents/GitHub/Rath/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n// import { aggregate } from '../utils';\nimport aggregate from 'cube-core';\nimport { entropy, normalize } from '../impurityMeasure'; // insights like outlier and trend both request high impurity of dimension.\n\nvar maxVisualChannel = 8;\n\nfunction getCombination(elements) {\n  var start = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  var end = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : elements.length;\n  var ans = [];\n\n  var combine = function combine(step, set, size) {\n    if (set.length === size) {\n      ans.push(_toConsumableArray(set));\n      return;\n    }\n\n    if (step >= elements.length) {\n      return;\n    }\n\n    combine(step + 1, [].concat(_toConsumableArray(set), [elements[step]]), size);\n    combine(step + 1, set, size);\n  };\n\n  for (var i = start; i <= Math.min(end, maxVisualChannel); i++) {\n    combine(0, [], i);\n  }\n\n  return ans;\n}\n\nexport function linearMapPositive(arr) {\n  var min = Math.min.apply(Math, _toConsumableArray(arr));\n  return arr.map(function (a) {\n    return a - min + 1;\n  });\n}\n\nfunction sum(arr) {\n  var sum = 0;\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    // if (typeof dataSource[i][field])\n    sum += arr[i];\n  }\n\n  return sum;\n}\n\nexport function correlation(dataSource, fieldX, fieldY) {\n  var r = 0;\n  var xBar = sum(dataSource.map(function (r) {\n    return r[fieldX];\n  })) / dataSource.length;\n  var yBar = sum(dataSource.map(function (r) {\n    return r[fieldY];\n  })) / dataSource.length;\n  r = sum(dataSource.map(function (r) {\n    return (r[fieldX] - xBar) * (r[fieldY] - yBar);\n  })) / Math.sqrt(sum(dataSource.map(function (r) {\n    return Math.pow(r[fieldX] - xBar, 2);\n  })) * sum(dataSource.map(function (r) {\n    return Math.pow(r[fieldY] - yBar, 2);\n  })));\n  return r;\n}\n\nfunction analysisDimensions(dataSource, dimensions, measures) {\n  var operator = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'sum';\n  var impurityList = [];\n  var dimSet = getCombination(dimensions);\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = dimSet[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var dset = _step.value;\n      var impurity = {};\n      var aggData = aggregate({\n        dataSource: dataSource,\n        dimensions: dset,\n        measures: measures,\n        asFields: measures,\n        operator: operator || 'sum' //: operator as \n\n      }); // let fList = aggData.map(r => r)\n\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        var _loop = function _loop() {\n          var mea = _step2.value;\n          // fl = frequency list, pL = probability list\n          var fL = aggData.map(function (r) {\n            return r[mea];\n          });\n          var pL = normalize(linearMapPositive(fL));\n          var value = entropy(pL);\n          impurity[mea] = value;\n        };\n\n        for (var _iterator2 = measures[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          _loop();\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      var correlationMatrix = measures.map(function (i) {\n        return measures.map(function (j) {\n          return 0;\n        });\n      });\n\n      for (var i = 0; i < measures.length; i++) {\n        correlationMatrix[i][i] = 1;\n\n        for (var j = i + 1; j < measures.length; j++) {\n          var r = correlation(aggData, measures[i], measures[j]);\n          correlationMatrix[j][i] = correlationMatrix[i][j] = r;\n        }\n      }\n\n      impurityList.push([dset, impurity, correlationMatrix]);\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return impurityList;\n}\n\nexport { analysisDimensions, getCombination };","import _toConsumableArray from \"/Users/chenhao/Documents/GitHub/Rath/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\n/**\n *\n * @param matrix adjmatrix\n */\nfunction turnAdjMatrix2List(matrix) {\n  // only for the special matrix here(corelational matrix)\n  var edges = [];\n\n  for (var i = 0; i < matrix.length; i++) {\n    for (var j = i + 1; j < matrix[i].length; j++) {\n      edges.push([[i, j], Math.abs(matrix[i][j])]);\n    }\n  }\n\n  return edges;\n}\n\nfunction find(parents, n) {\n  return parents[n] === n ? n : parents[n] = find(parents, parents[n]);\n}\n\nfunction union(parents, n1, n2) {\n  var p1 = find(parents, n1);\n  var p2 = find(parents, n2);\n  parents[p1] = p2; // I'm too tired. this is just a tmp lazy solution.... will be fixed later.\n  // may check and prove whether it's necessary.\n\n  find(parents, n1);\n  find(parents, n2);\n}\n\nfunction findWithEffect(parents, sizes, n) {\n  if (parents[n] === n) {\n    return n;\n  }\n\n  parents[n] = findWithEffect(parents, sizes, parents[n]);\n  sizes[n] = sizes[parents[n]];\n  return parents[n];\n}\n\nfunction unionWithEffect(parents, sizes, n1, n2) {\n  var p1 = findWithEffect(parents, sizes, n1);\n  var p2 = findWithEffect(parents, sizes, n2);\n  var size1 = sizes[p1];\n  var size2 = sizes[p2];\n  parents[p1] = p2;\n  sizes[p1] = sizes[p2] = size1 + size2;\n  findWithEffect(parents, sizes, n1);\n  findWithEffect(parents, sizes, n2);\n}\n/**\n * maxiumn spanning tree\n * @param matrix adjmatrix\n * @param groupNumber number of group generated by clustering\n */\n\n\nfunction kruskal(matrix, groupNumber) {\n  var edges = turnAdjMatrix2List(matrix);\n  edges.sort(function (a, b) {\n    return b[1] - a[1];\n  });\n  var parents = matrix.map(function (m, i) {\n    return i;\n  });\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = edges[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var edge = _step.value;\n\n      if (find(parents, edge[0][0]) !== find(parents, edge[0][1])) {\n        union(parents, edge[0][0], edge[0][1]);\n      }\n\n      for (var _i = 0; _i < parents.length; _i++) {\n        parents[_i] = find(parents, _i);\n      }\n\n      var set = new Set(parents);\n\n      if (set.size <= groupNumber) {\n        break;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  var groups = new Map();\n\n  for (var i = 0; i < parents.length; i++) {\n    if (!groups.has(parents[i])) {\n      groups.set(parents[i], []);\n    }\n\n    groups.get(parents[i]).push(i);\n  }\n\n  return groups;\n}\n/**\n *\n * @param matrix\n * @param limitSize max size of each group\n */\n\n\nfunction kruskalWithLimitSize(matrix, limitSize) {\n  var edges = turnAdjMatrix2List(matrix);\n  edges.sort(function (a, b) {\n    return b[1] - a[1];\n  });\n  var parents = matrix.map(function (m, i) {\n    return i;\n  });\n  var sizes = matrix.map(function () {\n    return 1;\n  });\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = edges[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var edge = _step2.value;\n\n      if (findWithEffect(parents, sizes, edge[0][0]) !== findWithEffect(parents, sizes, edge[0][1])) {\n        if (sizes[edge[0][0]] + sizes[edge[0][1]] > limitSize) {\n          continue;\n        }\n\n        unionWithEffect(parents, sizes, edge[0][0], edge[0][1]);\n      }\n\n      for (var _i2 = 0; _i2 < parents.length; _i2++) {\n        parents[_i2] = findWithEffect(parents, sizes, _i2);\n      }\n\n      var set = new Set(parents);\n\n      if (set.size === 1) {\n        break;\n      }\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  var groups = new Map();\n\n  for (var i = 0; i < parents.length; i++) {\n    if (!groups.has(parents[i])) {\n      groups.set(parents[i], []);\n    }\n\n    groups.get(parents[i]).push(i);\n  }\n\n  return groups;\n}\n\nexport function kruskalMSTWithLimitSize(matrix) {\n  var limitSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 4;\n  var edges = turnAdjMatrix2List(matrix);\n  edges.sort(function (a, b) {\n    return b[1] - a[1];\n  });\n  var edgesInMST = [];\n  var parents = matrix.map(function (m, i) {\n    return i;\n  });\n  var cloneParents = matrix.map(function (m, i) {\n    return i;\n  });\n  var sizes = matrix.map(function () {\n    return 1;\n  });\n  var inCutEdge = false;\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    for (var _iterator3 = edges[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      var edge = _step3.value;\n\n      if (findWithEffect(parents, sizes, edge[0][0]) !== findWithEffect(parents, sizes, edge[0][1])) {\n        if (sizes[edge[0][0]] + sizes[edge[0][1]] > limitSize) {\n          if (find(cloneParents, edge[0][0]) !== find(cloneParents, edge[0][1])) {\n            edgesInMST.push([edge[0], edge[1], true]);\n            union(cloneParents, edge[0][0], edge[0][1]);\n          }\n\n          continue;\n        }\n\n        unionWithEffect(parents, sizes, edge[0][0], edge[0][1]); // fuck typescript\n        // edgesInMST.push([...edge, inCutEdge]);\n\n        edgesInMST.push([edge[0], edge[1], false]);\n      }\n\n      for (var i = 0; i < parents.length; i++) {\n        parents[i] = findWithEffect(parents, sizes, i);\n        cloneParents[i] = find(cloneParents, i);\n      }\n\n      var set = new Set(parents);\n\n      if (set.size === 1) {\n        break;\n      }\n    }\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  return {\n    edgesInMST: edgesInMST,\n    groups: parents\n  };\n}\n/**\n *\n * @param matrix\n * @param groupNumber number of group generated by clustering\n */\n\nexport function kruskalMST(matrix) {\n  var groupNumber = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 4;\n  var edges = turnAdjMatrix2List(matrix);\n  edges.sort(function (a, b) {\n    return b[1] - a[1];\n  });\n  var edgesInMST = [];\n  var parents = matrix.map(function (m, i) {\n    return i;\n  });\n\n  var groups = _toConsumableArray(parents);\n\n  var inCutEdge = false;\n  var _iteratorNormalCompletion4 = true;\n  var _didIteratorError4 = false;\n  var _iteratorError4 = undefined;\n\n  try {\n    for (var _iterator4 = edges[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n      var edge = _step4.value;\n\n      if (find(parents, edge[0][0]) !== find(parents, edge[0][1])) {\n        union(parents, edge[0][0], edge[0][1]); // fuck typescript\n        // edgesInMST.push([...edge, inCutEdge]);\n\n        edgesInMST.push([edge[0], edge[1], inCutEdge]);\n      }\n\n      for (var i = 0; i < parents.length; i++) {\n        parents[i] = find(parents, i);\n      }\n\n      var set = new Set(parents); // TODO:\n      // + use kruskalMST instead of kruskal.\n\n      if (set.size <= groupNumber) {\n        inCutEdge = true;\n      } else {\n        groups = _toConsumableArray(parents);\n      }\n\n      if (set.size === 1) {\n        break;\n      }\n    }\n  } catch (err) {\n    _didIteratorError4 = true;\n    _iteratorError4 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n        _iterator4.return();\n      }\n    } finally {\n      if (_didIteratorError4) {\n        throw _iteratorError4;\n      }\n    }\n  }\n\n  return {\n    edgesInMST: edgesInMST,\n    groups: groups\n  };\n}\n\nfunction cluster(_ref) {\n  var matrix = _ref.matrix,\n      measures = _ref.measures,\n      _ref$method = _ref.method,\n      method = _ref$method === void 0 ? 'kruskal' : _ref$method,\n      _ref$groupMaxSize = _ref.groupMaxSize,\n      groupMaxSize = _ref$groupMaxSize === void 0 ? 4 : _ref$groupMaxSize,\n      _ref$limitSize = _ref.limitSize,\n      limitSize = _ref$limitSize === void 0 ? false : _ref$limitSize;\n  // const groups = kruskal({ matrix, groupMaxSize });\n  var groups;\n\n  if (limitSize) {\n    groups = kruskalWithLimitSize(matrix, groupMaxSize);\n  } else {\n    groups = kruskal(matrix, groupMaxSize);\n  }\n\n  var ans = [];\n  var _iteratorNormalCompletion5 = true;\n  var _didIteratorError5 = false;\n  var _iteratorError5 = undefined;\n\n  try {\n    for (var _iterator5 = groups.values()[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n      var meas = _step5.value;\n      ans.push(meas.map(function (meaIndex) {\n        return measures[meaIndex];\n      }));\n    }\n  } catch (err) {\n    _didIteratorError5 = true;\n    _iteratorError5 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n        _iterator5.return();\n      }\n    } finally {\n      if (_didIteratorError5) {\n        throw _iteratorError5;\n      }\n    }\n  }\n\n  return ans;\n}\n\nexport default cluster;","import _toConsumableArray from \"/Users/chenhao/Documents/GitHub/Rath/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nexport function chiSquared() {\n  var matrix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [[]];\n  var rowSums = matrix.map(function (m) {\n    return 0;\n  });\n  var colSums = matrix[0].map(function (m) {\n    return 0;\n  });\n  var totalSum = 0;\n\n  for (var i = 0; i < matrix.length; i++) {\n    for (var j = 0; j < matrix[i].length; j++) {\n      rowSums[i] += matrix[i][j];\n      colSums[j] += matrix[i][j];\n      totalSum += matrix[i][j];\n    }\n  }\n\n  var chis = 0;\n\n  for (var _i = 0; _i < matrix.length; _i++) {\n    for (var _j = 0; _j < matrix[_i].length; _j++) {\n      var observed = matrix[_i][_j];\n      var expected = rowSums[_i] * colSums[_j] / totalSum;\n      chis += Math.pow(observed - expected, 2) / expected;\n    }\n  }\n\n  return chis;\n}\nexport function crammersV(dataSource, fieldX, fieldY) {\n  var xSet = new Set(dataSource.map(function (d) {\n    return d[fieldX];\n  }));\n  var ySet = new Set(dataSource.map(function (d) {\n    return d[fieldY];\n  }));\n\n  var xMembers = _toConsumableArray(xSet);\n\n  var yMembers = _toConsumableArray(ySet);\n\n  var xDict = {};\n  var yDict = {};\n\n  for (var i = 0; i < xMembers.length; i++) {\n    xDict[xMembers[i]] = i;\n  }\n\n  for (var _i2 = 0; _i2 < yMembers.length; _i2++) {\n    yDict[yMembers[_i2]] = _i2;\n  }\n\n  var matrix = xMembers.map(function (x) {\n    return yMembers.map(function (y) {\n      return 0;\n    });\n  });\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = dataSource[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var record = _step.value;\n      matrix[xDict[record[fieldX]]][yDict[record[fieldY]]]++;\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  var chis = chiSquared(matrix);\n  var V = Math.sqrt(chis / (dataSource.length * Math.min(xMembers.length - 1, yMembers.length - 1)));\n  return V;\n}","import _toConsumableArray from \"/Users/chenhao/Documents/GitHub/Rath/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { correlation, linearMapPositive } from \"../insights/impurity\";\nimport cluster from \"../insights/cluster\";\nimport aggregate from 'cube-core';\nimport { normalize, entropy } from \"../impurityMeasure\";\nimport { crammersV } from './utils';\nexport function getEntropyMatrix(dimensionsList, measures, dataSource, operator) {\n  var matrix = [];\n\n  for (var i = 0; i < dimensionsList.length; i++) {\n    var dimensions = dimensionsList[i];\n    matrix.push([]);\n    var aggData = aggregate({\n      dataSource: dataSource,\n      dimensions: dimensions,\n      measures: measures,\n      asFields: measures,\n      operator: operator || 'sum'\n    });\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      var _loop = function _loop() {\n        var mea = _step.value;\n        var fL = aggData.map(function (r) {\n          return r[mea];\n        });\n        var pL = normalize(linearMapPositive(fL));\n        var value = entropy(pL);\n        matrix[i].push(value);\n      };\n\n      for (var _iterator = measures[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        _loop();\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n  }\n\n  return matrix;\n}\nexport function getDashBoardSubspace(dataSource, dimensions, measures, fieldFeatureList) {\n  var correlationMatrix = measures.map(function (i) {\n    return measures.map(function (j) {\n      return 0;\n    });\n  });\n\n  for (var i = 0; i < measures.length; i++) {\n    correlationMatrix[i][i] = 1;\n\n    for (var j = i + 1; j < measures.length; j++) {\n      var r = correlation(dataSource, measures[i], measures[j]);\n      correlationMatrix[j][i] = correlationMatrix[i][j] = r;\n    }\n  }\n\n  var measureGroups = cluster({\n    matrix: correlationMatrix,\n    measures: measures,\n    groupMaxSize: Math.round(measures.length / 6) // todo: make a config: max 6 measures in a dashboard\n\n  });\n  var dimCorrelationMatrix = dimensions.map(function (d) {\n    return dimensions.map(function (d) {\n      return 0;\n    });\n  });\n\n  for (var _i = 0; _i < dimensions.length; _i++) {\n    dimCorrelationMatrix[_i][_i] = 1;\n\n    for (var _j = _i + 1; _j < dimensions.length; _j++) {\n      dimCorrelationMatrix[_i][_j] = dimCorrelationMatrix[_j][_i] = crammersV(dataSource, dimensions[_i], dimensions[_j]);\n    }\n  }\n\n  var dimensionsInDashBoardSet = new Set();\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = fieldFeatureList[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var fieldFeature = _step2.value;\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = fieldFeature[0][Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var dim = _step4.value;\n          dimensionsInDashBoardSet.add(dim);\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  var dimensionsInDashBoard = _toConsumableArray(dimensionsInDashBoardSet);\n\n  var dashBoardSpaces = [];\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    var _loop2 = function _loop2() {\n      var group = _step3.value;\n      var matrix = group.map(function (g) {\n        return group.map(function (p) {\n          return 0;\n        });\n      });\n\n      for (var _i2 = 0; _i2 < group.length; _i2++) {\n        var mea1Index = measures.indexOf(group[_i2]);\n\n        for (var _j2 = 0; _j2 < group.length; _j2++) {\n          var mea2Index = measures.indexOf(group[_j2]);\n          matrix[_i2][_j2] = correlationMatrix[mea1Index][mea2Index];\n        }\n      }\n\n      var dMatrix = dimensionsInDashBoard.map(function (d) {\n        return dimensionsInDashBoard.map(function (d) {\n          return 0;\n        });\n      });\n\n      for (var _i3 = 0; _i3 < dimensionsInDashBoard.length; _i3++) {\n        var dim1Index = dimensions.indexOf(dimensionsInDashBoard[_i3]);\n\n        for (var _j3 = 0; _j3 < dimensionsInDashBoard.length; _j3++) {\n          var dim2Index = dimensions.indexOf(dimensionsInDashBoard[_j3]);\n          dMatrix[_i3][_j3] = dimCorrelationMatrix[dim1Index][dim2Index];\n        }\n      }\n\n      dashBoardSpaces.push({\n        dimensions: dimensionsInDashBoard,\n        measures: group,\n        correlationMatrix: matrix,\n        dimensionCorrelationMatrix: dMatrix,\n        entropyMatrix: getEntropyMatrix(dimensionsInDashBoard.map(function (dim) {\n          return [dim];\n        }), group, dataSource)\n      });\n    };\n\n    for (var _iterator3 = measureGroups[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      _loop2();\n    }\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  return dashBoardSpaces;\n}\n/**\n * handle how to combine dim and mea to produce a chart view in dashboard\n * @param dashBoardSpace\n *\n */\n\nexport function getDashBoardView(dashBoardSpace, dataSource) {\n  var dimensions = dashBoardSpace.dimensions,\n      measures = dashBoardSpace.measures,\n      entropyMatrix = dashBoardSpace.entropyMatrix,\n      dimensionCorrelationMatrix = dashBoardSpace.dimensionCorrelationMatrix;\n  /**\n   * 1. get correlation view\n   * 2. get impact view\n   */\n\n  var visViewList = [];\n  /**\n   * correlation view\n   */\n\n  var measureGroups = cluster({\n    matrix: dashBoardSpace.correlationMatrix,\n    measures: measures,\n    groupMaxSize: Math.round(measures.length / 3) // todo: make a config: max 3 measures in a chart\n\n  });\n  var _iteratorNormalCompletion5 = true;\n  var _didIteratorError5 = false;\n  var _iteratorError5 = undefined;\n\n  try {\n    var _loop3 = function _loop3() {\n      var group = _step5.value;\n      var meaIndexList = group.map(function (mea) {\n        return measures.indexOf(mea);\n      });\n      var dimScoreList = dimensions.map(function (dim, index) {\n        var score = 0;\n        var _iteratorNormalCompletion6 = true;\n        var _didIteratorError6 = false;\n        var _iteratorError6 = undefined;\n\n        try {\n          for (var _iterator6 = meaIndexList[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n            var meaIndex = _step6.value;\n            score += entropyMatrix[index][meaIndex];\n          }\n        } catch (err) {\n          _didIteratorError6 = true;\n          _iteratorError6 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion6 && _iterator6.return != null) {\n              _iterator6.return();\n            }\n          } finally {\n            if (_didIteratorError6) {\n              throw _iteratorError6;\n            }\n          }\n        }\n\n        return score;\n      });\n      var dimInView = dimensions[minIndex(dimScoreList)];\n      visViewList.push({\n        type: 'target',\n        dimensions: [dimInView],\n        measures: group\n      });\n    };\n\n    for (var _iterator5 = measureGroups[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n      _loop3();\n    }\n    /**\n     * impact views\n     * todo: protentional repeat view or very similiar view\n     */\n\n  } catch (err) {\n    _didIteratorError5 = true;\n    _iteratorError5 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n        _iterator5.return();\n      }\n    } finally {\n      if (_didIteratorError5) {\n        throw _iteratorError5;\n      }\n    }\n  }\n\n  var dimensionGroups = cluster({\n    matrix: dimensionCorrelationMatrix,\n    measures: dimensions,\n    groupMaxSize: 2,\n    limitSize: true\n  });\n  var dimGroupEntropyMatrix = getEntropyMatrix(dimensionGroups, measures, dataSource);\n\n  for (var i = 0; i < dimensionGroups.length; i++) {\n    var meaInView = measures[minIndex(dimGroupEntropyMatrix[i])];\n    visViewList.push({\n      type: 'feature',\n      dimensions: dimensionGroups[i],\n      measures: [meaInView]\n    });\n  }\n\n  return visViewList;\n}\n\nfunction minIndex(arr) {\n  var i = 0;\n  var len = arr.length;\n  var maxValue = Infinity;\n  var pos = -1;\n\n  for (i = 0; i < len; i++) {\n    if (arr[i] < maxValue) {\n      maxValue = arr[i];\n      pos = i;\n    }\n  }\n\n  return pos;\n}","/* eslint no-restricted-globals: 0 */\nimport { DashBoard } from 'visual-insights';\n\nfunction transSubspaces2FieldsFeature(subspaces) {\n  let fieldFeatureList = [];\n  for (let subspace of subspaces) {\n    let measureScore = {};\n    subspace.measures.forEach(mea => {\n      measureScore[mea.name] = mea.value;\n    })\n    fieldFeatureList.push([\n      subspace.dimensions,\n      measureScore,\n      subspace.correlationMatrix\n    ])\n  }\n  return fieldFeatureList;\n}\nconst generateDashBoard = (e) => {\n  const { dataSource, dimensions, measures, subspaces } = e.data;\n  try {\n    const fieldFeatureList = transSubspaces2FieldsFeature(subspaces);\n    const dashBoardSubspaces = DashBoard.getDashBoardSubspace(dataSource, dimensions, measures, fieldFeatureList);\n    const dashBoardViewList = [];\n\n    for (let i = 0; i < dashBoardSubspaces.length; i++) {\n      const viewsInDashBoard = DashBoard.getDashBoardView(dashBoardSubspaces[i], dataSource);\n      viewsInDashBoard.sort((a, b) => {\n        if (a.type === 'feature' && b.type === 'target') return 1;\n        return a.measures.length - b.measures.length; \n      })\n      dashBoardViewList.push(viewsInDashBoard);\n    }\n    self.postMessage({\n      success: true,\n      data: dashBoardViewList\n    })\n  } catch (error) {\n    self.postMessage({\n      success: false,\n      message: error\n    })\n  }\n}\n\nself.addEventListener('message', generateDashBoard, false);"],"sourceRoot":""}