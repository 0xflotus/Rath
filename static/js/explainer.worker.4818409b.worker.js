!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./",n(n.s=10)}([function(e,t,n){e.exports=n(9)},function(e,t,n){"use strict";this&&this.__assign;Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(8),a=n(3),o={sum:a.sum_unsafe,mean:a.mean,count:a.count};function u(e){var t=e.type,n=e.aggFunc,i=void 0===n?a.count:n,o=e.factTable,u=void 0===o?[]:o,s=e.dimensions,c=void 0===s?[]:s,f=e.measures,h=void 0===f?[]:f;switch(t){case"period":return new r.periodCube({aggFunc:i,factTable:u,dimensions:c,measures:h});case"moment":default:return new r.momentCube({aggFunc:i,factTable:u,dimensions:c,measures:h})}}t.createCube=u,t.default=function(e){var t=e.dimensions,n=e.measures,r=e.asFields,s=e.operator,c=e.dataSource,f=u({type:"moment",aggFunc:o[s]||a.count,dimensions:t,measures:n,factTable:c}),h=i.tree2Table({dimensions:t,measures:n,cube:f});return h.forEach((function(e){r.forEach((function(t,r){e[t]=e[n[r]]}))})),h},function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(3))},function(e,t,n){!function(e){"use strict";function t(e){if(0===e.length)return 0;for(var t,n=e[0],r=0,i=1;i<e.length;i++)t=n+e[i],Math.abs(n)>=Math.abs(e[i])?r+=n-t+e[i]:r+=e[i]-t+n,n=t;return n+r}function n(e){if(0===e.length)throw new Error("mean requires at least one data point");return t(e)/e.length}function r(e,t){var r,i,a=n(e),o=0;if(2===t)for(i=0;i<e.length;i++)o+=(r=e[i]-a)*r;else for(i=0;i<e.length;i++)o+=Math.pow(e[i]-a,t);return o}function i(e){if(0===e.length)throw new Error("variance requires at least one data point");return r(e,2)/e.length}function a(e){if(1===e.length)return 0;var t=i(e);return Math.sqrt(t)}function o(e){if(0===e.length)throw new Error("mode requires at least one data point");if(1===e.length)return e[0];for(var t=e[0],n=NaN,r=0,i=1,a=1;a<e.length+1;a++)e[a]!==t?(i>r&&(r=i,n=t),i=1,t=e[a]):i++;return n}function u(e){return e.slice().sort((function(e,t){return e-t}))}function s(e){if(0===e.length)throw new Error("min requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return t}function c(e){if(0===e.length)throw new Error("max requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return t}function f(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function h(e,t){var n=e.length*t;if(0===e.length)throw new Error("quantile requires at least one data point.");if(t<0||t>1)throw new Error("quantiles must be between 0 and 1");return 1===t?e[e.length-1]:0===t?e[0]:n%1!=0?e[Math.ceil(n)-1]:e.length%2==0?(e[n-1]+e[n])/2:e[n]}function l(e,t,n,r){for(n=n||0,r=r||e.length-1;r>n;){if(r-n>600){var i=r-n+1,a=t-n+1,o=Math.log(i),u=.5*Math.exp(2*o/3),s=.5*Math.sqrt(o*u*(i-u)/i);a-i/2<0&&(s*=-1),l(e,t,Math.max(n,Math.floor(t-a*u/i+s)),Math.min(r,Math.floor(t+(i-a)*u/i+s)))}var c=e[t],f=n,h=r;for(v(e,n,t),e[r]>c&&v(e,n,r);f<h;){for(v(e,f,h),f++,h--;e[f]<c;)f++;for(;e[h]>c;)h--}e[n]===c?v(e,n,h):v(e,++h,r),h<=t&&(n=h+1),t<=h&&(r=h-1)}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function d(e,t){var n=e.slice();if(Array.isArray(t)){!function(e,t){for(var n=[0],r=0;r<t.length;r++)n.push(g(e.length,t[r]));n.push(e.length-1),n.sort(m);for(var i=[0,n.length-1];i.length;){var a=Math.ceil(i.pop()),o=Math.floor(i.pop());if(!(a-o<=1)){var u=Math.floor((o+a)/2);p(e,n[u],Math.floor(n[o]),Math.ceil(n[a])),i.push(o,u,u,a)}}}(n,t);for(var r=[],i=0;i<t.length;i++)r[i]=h(n,t[i]);return r}return p(n,g(n.length,t),0,n.length-1),h(n,t)}function p(e,t,n,r){t%1==0?l(e,t,n,r):(l(e,t=Math.floor(t),n,r),l(e,t+1,t+1,r))}function m(e,t){return e-t}function g(e,t){var n=e*t;return 1===t?e-1:0===t?0:n%1!=0?Math.ceil(n)-1:e%2==0?n-.5:n}function y(e,t){if(t<e[0])return 0;if(t>e[e.length-1])return 1;var n=function(e,t){for(var n=0,r=0,i=e.length;r<i;)t<=e[n=r+i>>>1]?i=n:r=-~n;return r}(e,t);if(e[n]!==t)return n/e.length;n++;var r=function(e,t){for(var n=0,r=0,i=e.length;r<i;)t>=e[n=r+i>>>1]?r=-~n:i=n;return r}(e,t);if(r===n)return n/e.length;var i=r-n+1;return i*(r+n)/2/i/e.length}function b(e){var t=d(e,.75),n=d(e,.25);if("number"==typeof t&&"number"==typeof n)return t-n}function w(e){return+d(e,.5)}function M(e){for(var t=w(e),n=[],r=0;r<e.length;r++)n.push(Math.abs(e[r]-t));return w(n)}function S(e,t){t=t||Math.random;for(var n,r,i=e.length;i>0;)r=Math.floor(t()*i--),n=e[i],e[i]=e[r],e[r]=n;return e}function E(e,t){return S(e.slice(),t)}function k(e,t,n){return E(e,n).slice(0,t)}function x(e,t){for(var n=[],r=0;r<e;r++){for(var i=[],a=0;a<t;a++)i.push(0);n.push(i)}return n}function _(e){for(var t,n=0,r=0;r<e.length;r++)0!==r&&e[r]===t||(t=e[r],n++);return n}function D(e,t,n,r){var i;if(e>0){var a=(n[t]-n[e-1])/(t-e+1);i=r[t]-r[e-1]-(t-e+1)*a*a}else i=r[t]-n[t]*n[t]/(t+1);return i<0?0:i}function O(e,t,n,r,i,a,o){if(!(e>t)){var u=Math.floor((e+t)/2);r[n][u]=r[n-1][u-1],i[n][u]=u;var s=n;e>n&&(s=Math.max(s,i[n][e-1]||0)),s=Math.max(s,i[n-1][u]||0);var c,f,h,l=u-1;t<r[0].length-1&&(l=Math.min(l,i[n][t+1]||0));for(var v=l;v>=s&&!((c=D(v,u,a,o))+r[n-1][s-1]>=r[n][u]);--v)(f=D(s,u,a,o)+r[n-1][s-1])<r[n][u]&&(r[n][u]=f,i[n][u]=s),s++,(h=c+r[n-1][v-1])<r[n][u]&&(r[n][u]=h,i[n][u]=v);O(e,u-1,n,r,i,a,o),O(u+1,t,n,r,i,a,o)}}function T(e,t){if(e.length!==t.length)throw new Error("sampleCovariance requires samples with equal lengths");if(e.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var r=n(e),i=n(t),a=0,o=0;o<e.length;o++)a+=(e[o]-r)*(t[o]-i);return a/(e.length-1)}function N(e){if(e.length<2)throw new Error("sampleVariance requires at least two data points");return r(e,2)/(e.length-1)}function z(e){var t=N(e);return Math.sqrt(t)}function I(e,t,n,r){return(e*t+n*r)/(t+r)}function j(e){if(0===e.length)throw new Error("meanSimple requires at least one data point");return f(e)/e.length}function C(e){if(0===e.length)throw new Error("rootMeanSquare requires at least one data point");for(var t=0,n=0;n<e.length;n++)t+=Math.pow(e[n],2);return Math.sqrt(t/e.length)}var F=function(){this.totalCount=0,this.data={}};F.prototype.train=function(e,t){for(var n in this.data[t]||(this.data[t]={}),e){var r=e[n];void 0===this.data[t][n]&&(this.data[t][n]={}),void 0===this.data[t][n][r]&&(this.data[t][n][r]=0),this.data[t][n][r]++}this.totalCount++},F.prototype.score=function(e){var t,n={};for(var r in e){var i=e[r];for(t in this.data)n[t]={},this.data[t][r]?n[t][r+"_"+i]=(this.data[t][r][i]||0)/this.totalCount:n[t][r+"_"+i]=0}var a={};for(t in n)for(var o in a[t]=0,n[t])a[t]+=n[t][o];return a};var P=function(){this.weights=[],this.bias=0};P.prototype.predict=function(e){if(e.length!==this.weights.length)return null;for(var t=0,n=0;n<this.weights.length;n++)t+=this.weights[n]*e[n];return(t+=this.bias)>0?1:0},P.prototype.train=function(e,t){if(0!==t&&1!==t)return null;e.length!==this.weights.length&&(this.weights=e,this.bias=1);var n=this.predict(e);if("number"==typeof n&&n!==t){for(var r=t-n,i=0;i<this.weights.length;i++)this.weights[i]+=r*e[i];this.bias+=r}return this};var q=1e-4;function L(e){if(e<0)throw new Error("factorial requires a non-negative value");if(Math.floor(e)!==e)throw new Error("factorial requires an integer input");for(var t=1,n=2;n<=e;n++)t*=n;return t}var G=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],A=Math.log(Math.sqrt(2*Math.PI)),R={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}},V=Math.sqrt(2*Math.PI),K={gaussian:function(e){return Math.exp(-.5*e*e)/V}},H={nrd:function(e){var t=z(e),n=b(e);return"number"==typeof n&&(t=Math.min(t,n/1.34)),1.06*t*Math.pow(e.length,-.2)}};function U(e,t,n){var r,i;if(void 0===t)r=K.gaussian;else if("string"==typeof t){if(!K[t])throw new Error('Unknown kernel "'+t+'"');r=K[t]}else r=t;if(void 0===n)i=H.nrd(e);else if("string"==typeof n){if(!H[n])throw new Error('Unknown bandwidth method "'+n+'"');i=H[n](e)}else i=n;return function(t){var n=0,a=0;for(n=0;n<e.length;n++)a+=r((t-e[n])/i);return a/i/e.length}}var W=Math.sqrt(2*Math.PI);function X(e){for(var t=e,n=e,r=1;r<15;r++)t+=n*=e*e/(2*r+1);return Math.round(1e4*(.5+t/W*Math.exp(-e*e/2)))/1e4}for(var B=[],Y=0;Y<=3.09;Y+=.01)B.push(X(Y));function $(e){var t=1/(1+.5*Math.abs(e)),n=t*Math.exp(-e*e+((((((((.17087277*t-.82215223)*t+1.48851587)*t-1.13520398)*t+.27886807)*t-.18628806)*t+.09678418)*t+.37409196)*t+1.00002368)*t-1.26551223);return e>=0?1-n:n-1}function J(e){var t=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),n=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*t)+Math.log(1-e*e)/2,2)-Math.log(1-e*e)/t)-(2/(Math.PI*t)+Math.log(1-e*e)/2));return e>=0?n:-n}function Q(e){if("number"==typeof e)return e<0?-1:0===e?0:1;throw new TypeError("not a number")}function Z(e,t){for(var n=0,r=0;r<e.length;r++){var i=e[r]-t[r];n+=i*i}return Math.sqrt(n)}function ee(e,t){return e.map((function(e){for(var n=Number.MAX_VALUE,r=-1,i=0;i<t.length;i++){var a=Z(e,t[i]);a<n&&(n=a,r=i)}return r}))}function te(e,t,n){for(var r=e[0].length,i=x(n,r),a=Array(n).fill(0),o=e.length,u=0;u<o;u++){for(var s=e[u],c=t[u],f=i[c],h=0;h<r;h++)f[h]+=s[h];a[c]+=1}for(var l=0;l<n;l++){if(0===a[l])throw new Error("Centroid "+l+" has no friends");for(var v=i[l],d=0;d<r;d++)v[d]/=a[l]}return i}function ne(e,t){for(var n=0,r=0;r<e.length;r++)n+=Z(e[r],t[r]);return n}function re(e,t){if(e.length!==t.length)throw new Error("must have exactly as many labels as points");for(var n=function(e){for(var t=1+c(e),n=Array(t),r=0;r<e.length;r++){var i=e[r];void 0===n[i]&&(n[i]=[]),n[i].push(r)}return n}(t),r=function(e){for(var t=e.length,n=x(t,t),r=0;r<t;r++)for(var i=0;i<r;i++)n[r][i]=Z(e[r],e[i]),n[i][r]=n[r][i];return n}(e),i=[],a=0;a<e.length;a++){var o=0;if(n[t[a]].length>1){var u=ae(a,n[t[a]],r),s=ie(a,t,n,r);o=(s-u)/Math.max(u,s)}i.push(o)}return i}function ie(e,t,n,r){for(var i=t[e],a=Number.MAX_VALUE,o=0;o<n.length;o++)if(o!==i){var u=ae(e,n[o],r);u<a&&(a=u)}return a}function ae(e,t,n){for(var r=0,i=0;i<t.length;i++)r+=n[e][t[i]];return r/t.length}function oe(e,t){return 0===e&&0===t?0:Math.abs((e-t)/t)}e.BayesianClassifier=F,e.PerceptronModel=P,e.addToMean=function(e,t,n){return e+(n-e)/(t+1)},e.approxEqual=function(e,t,n){return void 0===n&&(n=q),oe(e,t)<=n},e.average=n,e.averageSimple=j,e.bayesian=F,e.bernoulliDistribution=function(e){if(e<0||e>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-e,e]},e.binomialDistribution=function(e,t){if(!(t<0||t>1||e<=0||e%1!=0)){var n=0,r=0,i=[],a=1;do{i[n]=a*Math.pow(t,n)*Math.pow(1-t,e-n),r+=i[n],a=a*(e-++n+1)/n}while(r<.9999);return i}},e.bisect=function(e,t,n,r,i){if("function"!=typeof e)throw new TypeError("func must be a function");for(var a=0;a<r;a++){var o=(t+n)/2;if(0===e(o)||Math.abs((n-t)/2)<i)return o;Q(e(o))===Q(e(t))?t=o:n=o}throw new Error("maximum number of iterations exceeded")},e.chiSquaredDistributionTable=R,e.chiSquaredGoodnessOfFit=function(e,t,r){for(var i=0,a=t(n(e)),o=[],u=[],s=0;s<e.length;s++)void 0===o[e[s]]&&(o[e[s]]=0),o[e[s]]++;for(var c=0;c<o.length;c++)void 0===o[c]&&(o[c]=0);for(var f in a)f in o&&(u[+f]=a[f]*e.length);for(var h=u.length-1;h>=0;h--)u[h]<3&&(u[h-1]+=u[h],u.pop(),o[h-1]+=o[h],o.pop());for(var l=0;l<o.length;l++)i+=Math.pow(o[l]-u[l],2)/u[l];var v=o.length-1-1;return R[v][r]<i},e.chunk=function(e,t){var n=[];if(t<1)throw new Error("chunk size must be a positive number");if(Math.floor(t)!==t)throw new Error("chunk size must be an integer");for(var r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n},e.ckmeans=function(e,t){if(t>e.length)throw new Error("cannot generate more classes than there are data values");var n=u(e);if(1===_(n))return[n];var r=x(t,n.length),i=x(t,n.length);!function(e,t,n){for(var r=t[0].length,i=e[Math.floor(r/2)],a=[],o=[],u=0,s=void 0;u<r;++u)s=e[u]-i,0===u?(a.push(s),o.push(s*s)):(a.push(a[u-1]+s),o.push(o[u-1]+s*s)),t[0][u]=D(0,u,a,o),n[0][u]=0;for(var c=1;c<t.length;++c)O(c<t.length-1?c:r-1,r-1,c,t,n,a,o)}(n,r,i);for(var a=[],o=i[0].length-1,s=i.length-1;s>=0;s--){var c=i[s][o];a[s]=n.slice(c,o+1),s>0&&(o=c-1)}return a},e.combinations=function e(t,n){var r,i,a,o,u=[];for(r=0;r<t.length;r++)if(1===n)u.push([t[r]]);else for(a=e(t.slice(r+1,t.length),n-1),i=0;i<a.length;i++)(o=a[i]).unshift(t[r]),u.push(o);return u},e.combinationsReplacement=function e(t,n){for(var r=[],i=0;i<t.length;i++)if(1===n)r.push([t[i]]);else for(var a=e(t.slice(i,t.length),n-1),o=0;o<a.length;o++)r.push([t[i]].concat(a[o]));return r},e.combineMeans=I,e.combineVariances=function(e,t,n,r,i,a){var o=I(t,n,i,a);return(n*(e+Math.pow(t-o,2))+a*(r+Math.pow(i-o,2)))/(n+a)},e.cumulativeStdNormalProbability=function(e){var t=Math.abs(e),n=Math.min(Math.round(100*t),B.length-1);return e>=0?B[n]:+(1-B[n]).toFixed(4)},e.epsilon=q,e.equalIntervalBreaks=function(e,t){if(e.length<2)return e;for(var n=s(e),r=c(e),i=[n],a=(r-n)/t,o=1;o<t;o++)i.push(i[0]+a*o);return i.push(r),i},e.erf=$,e.errorFunction=$,e.extent=function(e){if(0===e.length)throw new Error("extent requires at least one data point");for(var t=e[0],n=e[0],r=1;r<e.length;r++)e[r]>n&&(n=e[r]),e[r]<t&&(t=e[r]);return[t,n]},e.extentSorted=function(e){return[e[0],e[e.length-1]]},e.factorial=L,e.gamma=function e(t){if(Number.isInteger(t))return t<=0?NaN:L(t-1);if(--t<0)return Math.PI/(Math.sin(Math.PI*-t)*e(-t));var n=t+1/4;return Math.pow(t/Math.E,t)*Math.sqrt(2*Math.PI*(t+1/6))*(1+1/144/Math.pow(n,2)-1/12960/Math.pow(n,3)-257/207360/Math.pow(n,4)-52/2612736/Math.pow(n,5)+5741173/9405849600/Math.pow(n,6)+37529/18811699200/Math.pow(n,7))},e.gammaln=function(e){if(e<=0)return 1/0;e--;for(var t=G[0],n=1;n<15;n++)t+=G[n]/(e+n);var r=5.2421875+e;return A+Math.log(t)-r+(e+.5)*Math.log(r)},e.geometricMean=function(e){if(0===e.length)throw new Error("geometricMean requires at least one data point");for(var t=1,n=0;n<e.length;n++){if(e[n]<=0)throw new Error("geometricMean requires only positive numbers as input");t*=e[n]}return Math.pow(t,1/e.length)},e.harmonicMean=function(e){if(0===e.length)throw new Error("harmonicMean requires at least one data point");for(var t=0,n=0;n<e.length;n++){if(e[n]<=0)throw new Error("harmonicMean requires only positive numbers as input");t+=1/e[n]}return e.length/t},e.interquartileRange=b,e.inverseErrorFunction=J,e.iqr=b,e.kMeansCluster=function(e,t,n){void 0===n&&(n=Math.random);for(var r=null,i=k(e,t,n),a=null,o=Number.MAX_VALUE;0!==o;)r=i,o=ne(i=te(e,a=ee(e,i),t),r);return{labels:a,centroids:i}},e.kde=U,e.kernelDensityEstimation=U,e.linearRegression=function(e){var t,n,r=e.length;if(1===r)t=0,n=e[0][1];else{for(var i,a,o,u=0,s=0,c=0,f=0,h=0;h<r;h++)u+=a=(i=e[h])[0],s+=o=i[1],c+=a*a,f+=a*o;n=s/r-(t=(r*f-u*s)/(r*c-u*u))*u/r}return{m:t,b:n}},e.linearRegressionLine=function(e){return function(t){return e.b+e.m*t}},e.mad=M,e.max=c,e.maxSorted=function(e){return e[e.length-1]},e.mean=n,e.meanSimple=j,e.median=w,e.medianAbsoluteDeviation=M,e.medianSorted=function(e){return h(e,.5)},e.min=s,e.minSorted=function(e){return e[0]},e.mode=function(e){return o(u(e))},e.modeFast=function(e){for(var t,n=new Map,r=0,i=0;i<e.length;i++){var a=n.get(e[i]);void 0===a?a=1:a++,a>r&&(t=e[i],r=a),n.set(e[i],a)}if(0===r)throw new Error("mode requires at last one data point");return t},e.modeSorted=o,e.numericSort=u,e.perceptron=P,e.permutationTest=function(e,t,r,i,a){if(void 0===i&&(i=1e4),void 0===r&&(r="two_side"),"two_side"!==r&&"greater"!==r&&"less"!==r)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'");for(var o=n(e)-n(t),u=new Array(i),s=e.concat(t),c=Math.floor(s.length/2),f=0;f<i;f++){S(s,a);var h=s.slice(0,c),l=s.slice(c,s.length),v=n(h)-n(l);u[f]=v}var d=0;if("two_side"===r)for(var p=0;p<=i;p++)Math.abs(u[p])>=Math.abs(o)&&(d+=1);else if("greater"===r)for(var m=0;m<=i;m++)u[m]>=o&&(d+=1);else for(var g=0;g<=i;g++)u[g]<=o&&(d+=1);return d/i},e.permutationsHeap=function(e){for(var t=new Array(e.length),n=[e.slice()],r=0;r<e.length;r++)t[r]=0;for(var i=0;i<e.length;)if(t[i]<i){var a=0;i%2!=0&&(a=t[i]);var o=e[a];e[a]=e[i],e[i]=o,n.push(e.slice()),t[i]++,i=0}else t[i]=0,i++;return n},e.poissonDistribution=function(e){if(!(e<=0)){var t=0,n=0,r=[],i=1;do{r[t]=Math.exp(-e)*Math.pow(e,t)/i,n+=r[t],i*=++t}while(n<.9999);return r}},e.probit=function(e){return 0===e?e=q:e>=1&&(e=.9999),Math.sqrt(2)*J(2*e-1)},e.product=function(e){for(var t=1,n=0;n<e.length;n++)t*=e[n];return t},e.quantile=d,e.quantileRank=function(e,t){return y(u(e),t)},e.quantileRankSorted=y,e.quantileSorted=h,e.quickselect=l,e.rSquared=function(e,t){if(e.length<2)return 1;for(var n=0,r=0;r<e.length;r++)n+=e[r][1];for(var i=n/e.length,a=0,o=0;o<e.length;o++)a+=Math.pow(i-e[o][1],2);for(var u=0,s=0;s<e.length;s++)u+=Math.pow(e[s][1]-t(e[s][0]),2);return 1-u/a},e.relativeError=oe,e.rms=C,e.rootMeanSquare=C,e.sample=k,e.sampleCorrelation=function(e,t){return T(e,t)/z(e)/z(t)},e.sampleCovariance=T,e.sampleKurtosis=function(e){var t=e.length;if(t<4)throw new Error("sampleKurtosis requires at least four data points");for(var r,i=n(e),a=0,o=0,u=0;u<t;u++)a+=(r=e[u]-i)*r,o+=r*r*r*r;return(t-1)/((t-2)*(t-3))*(t*(t+1)*o/(a*a)-3*(t-1))},e.sampleSkewness=function(e){if(e.length<3)throw new Error("sampleSkewness requires at least three data points");for(var t,r=n(e),i=0,a=0,o=0;o<e.length;o++)i+=(t=e[o]-r)*t,a+=t*t*t;var u=e.length-1,s=Math.sqrt(i/u),c=e.length;return c*a/((c-1)*(c-2)*Math.pow(s,3))},e.sampleStandardDeviation=z,e.sampleVariance=N,e.sampleWithReplacement=function(e,t,n){if(0===e.length)return[];n=n||Math.random;for(var r=e.length,i=[],a=0;a<t;a++){var o=Math.floor(n()*r);i.push(e[o])}return i},e.shuffle=E,e.shuffleInPlace=S,e.sign=Q,e.silhouette=re,e.silhouetteMetric=function(e,t){return c(re(e,t))},e.standardDeviation=a,e.standardNormalTable=B,e.subtractFromMean=function(e,t,n){return(e*t-n)/(t-1)},e.sum=t,e.sumNthPowerDeviations=r,e.sumSimple=f,e.tTest=function(e,t){return(n(e)-t)/(a(e)/Math.sqrt(e.length))},e.tTestTwoSample=function(e,t,r){var i=e.length,a=t.length;if(!i||!a)return null;r||(r=0);var o=n(e),u=n(t),s=N(e),c=N(t);if("number"==typeof o&&"number"==typeof u&&"number"==typeof s&&"number"==typeof c){var f=((i-1)*s+(a-1)*c)/(i+a-2);return(o-u-r)/Math.sqrt(f*(1/i+1/a))}},e.uniqueCountSorted=_,e.variance=i,e.zScore=function(e,t,n){return(e-t)/n},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sum_unsafe=function(e,t){var n={};t.forEach((function(e){n[e]=0}));for(var r=function(r,i){t.forEach((function(t){n[t]+=e[r][t]}))},i=0,a=e.length;i<a;i++)r(i);return n},t.sum=function(e,t){var n={};t.forEach((function(e){n[e]=0}));for(var r=function(r,i){t.forEach((function(t){n[t]+=Number(e[r][t])||0}))},i=0,a=e.length;i<a;i++)r(i);return n},t.count=function(e,t){var n={};t.forEach((function(e){n[e]=0}));for(var r=0,i=e.length;r<i;r++)t.forEach((function(e){n[e]++}));return n},t.mean=function(e,t){var n={};t.forEach((function(e){n[e]=0}));for(var r=function(r,i){t.forEach((function(t){n[t]+=Number(e[r][t])||0}))},i=0,a=e.length;i<a;i++)r(i);return t.forEach((function(t){n[t]/=e.length})),n}},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.periodCube=r.default;var i=n(7);t.momentCube=i.default},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.children=new Map,this._rawData=[],this.aggFunc=e,this.cache=!1}return e.prototype.push=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this._rawData).push.apply(e,i(t))},e.prototype.aggData=function(e){return void 0===e&&(e=[]),this.cache||(this._aggData=this.aggFunc(this.rawData,e),this.cache=!0),this._aggData},e.prototype.clearCache=function(){this.cache=!1},Object.defineProperty(e.prototype,"rawData",{get:function(){var e,t;if(!this.cache){if(0!==this.children.size){var n=this.children.values(),r=[];try{for(var i=a(n),o=i.next();!o.done;o=i.next()){var u=o.value,s=void 0,c=u.rawData,f=c.length;for(s=0;s<f;s++)r.push(c[s])}}catch(h){e={error:h}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this._rawData=r}this.cache=!0}return this._rawData},enumerable:!0,configurable:!0}),e.prototype.getNode=function(e){return function t(n,i){var o,u;if(i===e.length)return n;var s=n.children.entries();try{for(var c=a(s),f=c.next();!f.done;f=c.next()){var h=r(f.value,2),l=h[0],v=h[1];if(l===e[i])return t(v,i+1)}}catch(d){o={error:d}}finally{try{f&&!f.done&&(u=c.return)&&u.call(c)}finally{if(o)throw o.error}}return null}(this,0)},e}(),u=function(){function e(e){this.aggFunc=e.aggFunc,this.factTable=e.factTable,this.dimensions=e.dimensions,this.measures=e.measures}return e.prototype.get=function(e){var t=this,n=t.tree,i=(t.aggFunc,t.measures);return function t(n,o){var u,s;if(o===e.length)return n.aggData(i);var c=n.children.entries();try{for(var f=a(c),h=f.next();!h.done;h=f.next()){var l=r(h.value,2),v=l[0],d=l[1];if(v===e[o])return t(d,o+1)}}catch(p){u={error:p}}finally{try{h&&!h.done&&(s=f.return)&&s.call(f)}finally{if(u)throw u.error}}return!1}(n,0)},e.prototype.getNode=function(e){return this.tree.getNode(e)},e.prototype.buildTree=function(){var e,t=new o(this.aggFunc),n=this.factTable.length;for(e=0;e<n;e++)this.insertNode(this.factTable[e],t,0);return this.tree=t,t},e.prototype.insertNode=function(e,t,n){if(t.push(e),t.cache=!1,n<this.dimensions.length){var r=e[this.dimensions[n]];t.children.has(r)||t.children.set(r,new o(this.aggFunc)),this.insertNode(e,t.children.get(r),n+1)}},e.prototype.aggTree=function(e){var t,n;void 0===e&&(e=this.tree);var r=e.children.values();try{for(var i=a(r),o=i.next();!o.done;o=i.next()){var u=o.value;this.aggTree(u)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return e.aggData(this.measures),e},e.prototype.aggNode=function(e){var t,n;void 0===e&&(e=this.tree);var r=e.children.values();try{for(var i=a(r),o=i.next();!o.done;o=i.next()){var u=o.value;this.aggTree(u)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return e.aggData(this.measures),e},e}();t.default=u},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.children=new Map,this.rawData=[]}return e.prototype.push=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.rawData).push.apply(e,i(t))},e.prototype.aggData=function(e,t){return void 0===t&&(t=[]),this._aggData=e(this.rawData,t),this._aggData},e.prototype.getNode=function(e){return function t(n,i){var o,u;if(i===e.length)return n;var s=n.children.entries();try{for(var c=a(s),f=c.next();!f.done;f=c.next()){var h=r(f.value,2),l=h[0],v=h[1];if(l===e[i])return t(v,i+1)}}catch(d){o={error:d}}finally{try{f&&!f.done&&(u=c.return)&&u.call(c)}finally{if(o)throw o.error}}return null}(this,0)},e}();t.Node=o;var u=function(){function e(e){this.aggFunc=e.aggFunc,this.factTable=e.factTable,this.dimensions=e.dimensions,this.measures=e.measures,this.buildTree(),this.aggTree()}return e.prototype.get=function(e){var t=this,n=t.tree,i=t.aggFunc,o=t.measures;return function t(n,u){var s,c;if(u===e.length)return n.aggData(i,o);var f=n.children.entries();try{for(var h=a(f),l=h.next();!l.done;l=h.next()){var v=r(l.value,2),d=v[0],p=v[1];if(d===e[u])return t(p,u+1)}}catch(m){s={error:m}}finally{try{l&&!l.done&&(c=h.return)&&c.call(h)}finally{if(s)throw s.error}}return!1}(n,0)},e.prototype.getNode=function(e){return this.tree.getNode(e)},e.prototype.setData=function(e){var t=e.aggFunc,n=void 0===t?this.aggFunc:t,r=e.factTable,i=void 0===r?this.factTable:r,a=e.dimensions,o=void 0===a?this.dimensions:a,u=e.measures,s=void 0===u?this.measures:u;o!==this.dimensions||i!==this.factTable?(this.dimensions=o,this.factTable=i,this.measures=s,this.aggFunc=n,this.buildTree(),this.aggTree()):s===this.measures&&n===this.aggFunc||(this.measures=s,this.aggFunc=n,this.aggTree())},e.prototype.buildTree=function(){var e,t=new o,n=this.factTable.length;for(e=0;e<n;e++)this.insertNode(this.factTable[e],t,0);return this.tree=t,t},e.prototype.insertNode=function(e,t,n){if(n===this.dimensions.length)t.push(e);else{var r=e[this.dimensions[n]];t.children.has(r)||t.children.set(r,new o),this.insertNode(e,t.children.get(r),n+1)}},e.prototype.aggTree=function(e){var t,n;if(void 0===e&&(e=this.tree),e.children.size>0){e.rawData=[];var r=e.children.values();try{for(var i=a(r),o=i.next();!o.done;o=i.next()){var u=o.value,s=void 0,c=this.aggTree(u).rawData,f=c.length;for(s=0;s<f;s++)e.rawData.push(c[s])}}catch(h){t={error:h}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}return e.aggData(this.aggFunc,this.measures),e},e}();t.default=u},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.tree2Table=function(e){var t=e.dimensions,n=(e.measures,e.cube),o=(n.aggFunc,[]);return function e(n,u,s){var c,f,h;if(0!==n.children.size)try{for(var l=i(n.children.entries()),v=l.next();!v.done;v=l.next()){var d=a(v.value,2),p=d[0];e(d[1],r(r({},u),((h={})[t[s]]=p,h)),s+1)}}catch(g){c={error:g}}finally{try{v&&!v.done&&(f=l.return)&&f.call(l)}finally{if(c)throw c.error}}else{var m=n._aggData;o.push(r(r({},u),m))}}(n.tree,{},0),o}},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(z){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),o=new O(r||[]);return a._invoke=function(e,t,n){var r=h;return function(i,a){if(r===v)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw a;return N()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=x(o,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var s=f(e,t,n);if("normal"===s.type){if(r=n.done?d:l,s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=d,n.method="throw",n.arg=s.arg)}}}(e,n,o),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(z){return{type:"throw",arg:z}}}e.wrap=c;var h="suspendedStart",l="suspendedYield",v="executing",d="completed",p={};function m(){}function g(){}function y(){}var b={};b[a]=function(){return this};var w=Object.getPrototypeOf,M=w&&w(w(T([])));M&&M!==n&&r.call(M,a)&&(b=M);var S=y.prototype=m.prototype=Object.create(b);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(i,a,o,u){var s=f(e[i],e,a);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"===typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,u)}),(function(e){n("throw",e,o,u)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,u)}))}u(s.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function x(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=f(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function T(e){if(e){var n=e[a];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:N}}function N(){return{value:t,done:!0}}return g.prototype=S.constructor=y,y.constructor=g,g.displayName=s(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},E(k.prototype),k.prototype[o]=function(){return this},e.AsyncIterator=k,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new k(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(S),s(S,u,"Generator"),S[a]=function(){return this},S.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],u=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;D(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"kruskal",(function(){return R})),n.d(r,"kruskalWithFullMST",(function(){return A}));var i={};n.r(i),n.d(i,"getDimCorrelationMatrix",(function(){return Q})),n.d(i,"getMeaCorrelationMatrix",(function(){return Z})),n.d(i,"getDimClusterGroups",(function(){return ee})),n.d(i,"getDimSetsBasedOnClusterGroups",(function(){return te})),n.d(i,"getMeaSetsBasedOnClusterGroups",(function(){return ne})),n.d(i,"subspaceSearching",(function(){return re})),n.d(i,"getRelatedVertices",(function(){return ie}));var a={};n.r(a),n.d(a,"insightExtraction",(function(){return ce})),n.d(a,"subspaceSearching",(function(){return se})),n.d(a,"getVisSpaces",(function(){return _e})),n.d(a,"IntentionWorkerCollection",(function(){return Ee})),n.d(a,"DefaultIWorker",(function(){return ye})),n.d(a,"getIntentionSpaces",(function(){return ke})),n.d(a,"Subspace",(function(){return i})),n.d(a,"VIEngine",(function(){return He}));n(4);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){if(e){if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(s){i=!0,a=s}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){var n={},r={},i={};t.forEach((function(e){n[e]=-1/0,r[e]=1/0,i[e]=0})),e.forEach((function(e){t.forEach((function(t){n[t]=Math.max(e[t],n[t]),r[t]=Math.min(e[t],r[t])}))}));var a=[];return e.forEach((function(e){var n=l({},e);t.forEach((function(e){i[e]+=Math.abs(n[e])})),a.push(n)})),a.forEach((function(e){t.forEach((function(t){e[t]/=i[t]}))})),{normalizedData:a,maxMeasures:n,minMeasures:r,totalMeasures:i}}function d(e,t,n,r){var i,a=v(e,r),o=a.normalizedData,u=(a.maxMeasures,a.minMeasures,a.totalMeasures),f=1/0,h="",l=c(t);try{for(l.s();!(i=l.n()).done;){var d,p=s(i.value,2),m=p[0],g=p[1],y=0,b=c(o);try{var w=function(){var e=d.value,t=g.find((function(t){return n.every((function(n){return e[n]===t[n]}))}));t?r.forEach((function(n){var r="number"!==typeof t[n]||isNaN(t[n])?0:t[n];r/=u[n],y+=Math.abs(e[n]-r)})):r.forEach((function(t){y+=Math.abs(e[t])}))};for(b.s();!(d=b.n()).done;)w()}catch(M){b.e(M)}finally{b.f()}y<f&&(f=y,h=m)}}catch(M){l.e(M)}finally{l.f()}return{majorKey:h,majorSum:f/=2*r.length}}function p(e,t,n,r){var i,a=v(e,r),o=a.normalizedData,u=(a.maxMeasures,a.minMeasures,a.totalMeasures,-1/0),f="",h=c(t);try{for(h.s();!(i=h.n()).done;){var l,d=s(i.value,2),p=d[0],m=v(d[1],r).normalizedData,g=0,y=c(o);try{var b=function(){var e=l.value,t=m.find((function(t){return n.every((function(n){return e[n]===t[n]}))}));t?r.forEach((function(n){var r="number"!==typeof t[n]||isNaN(t[n])?0:t[n];g+=Math.abs(e[n]-r)})):r.forEach((function(t){g+=Math.abs(e[t])}))};for(y.s();!(l=y.n()).done;)b()}catch(w){y.e(w)}finally{y.f()}g>u&&(u=g,f=p)}}catch(w){h.e(w)}finally{h.f()}return{outlierKey:f,outlierSum:u/=2*r.length}}function m(e,t){return e.filter((function(e){return t.every((function(t){return"continuous"===t.type?e[t.key]>=t.range[0]&&e[t.key]<=t.range[1]:t.range.has(e[t.key])}))}))}function g(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}var M=function(e,t,n){for(var r=new Set,i=new Set,a=new Map,o=e.length,u=0;u<o;u++){var f=e[u];r.add(f[t]),i.add(f[n]),a.has(f[t])||a.set(f[t],new Map);var h=a.get(f[t]);h.has(f[n])||h.set(f[n],0),h.set(f[n],h.get(f[n])+1)}var l=function(e,t,n){if("undefined"===typeof e||"undefined"===typeof t||"undefined"===typeof n)return 0;var r,i=new Map,a=new Map,o=0,u=c(t);try{for(u.s();!(r=u.n()).done;){var f=r.value;i.set(f,0)}}catch(C){u.e(C)}finally{u.f()}var h,l=c(n);try{for(l.s();!(h=l.n()).done;){var v=h.value;a.set(v,0)}}catch(C){l.e(C)}finally{l.f()}var d,p=c(e);try{for(p.s();!(d=p.n()).done;){var m,g=s(d.value,2),y=g[0],b=c(g[1]);try{for(b.s();!(m=b.n()).done;){var w=s(m.value,2),M=w[0],S=w[1];i.set(y,i.get(y)+S),a.set(M,a.get(M)+S),o+=S}}catch(C){b.e(C)}finally{b.f()}}}catch(C){p.e(C)}finally{p.f()}var E,k=0,x=c(e);try{for(x.s();!(E=x.n()).done;){var _,D=s(E.value,2),O=D[0],T=c(D[1]);try{for(T.s();!(_=T.n()).done;){var N=s(_.value,2),z=N[0],I=N[1],j=i.get(O)*a.get(z)/o;k+=Math.pow(I-j,2)/j}}catch(C){T.e(C)}finally{T.f()}}}catch(C){x.e(C)}finally{x.f()}return k}(a,r,i);return Math.sqrt(l/(e.length*Math.min(r.size-1,i.size-1)))},S=function(e,t,n){var r=E(e.map((function(e){return e[t]})))/e.length,i=E(e.map((function(e){return e[n]})))/e.length;return E(e.map((function(e){return(e[t]-r)*(e[n]-i)})))/Math.sqrt(E(e.map((function(e){return Math.pow(e[t]-r,2)})))*E(e.map((function(e){return Math.pow(e[n]-i,2)}))))};function E(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n];return t}function k(e){var t=Math.min.apply(Math,g(e));return e.map((function(e){return e-t+1}))}function x(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,r=[],i=function t(n,i,a){i.length!==a?n>=e.length||(t(n+1,[].concat(g(i),[e[n]]),a),t(n+1,i,a)):r.push(g(i))},a=t;a<=n;a++)i(0,[],a);return r}function _(e){var t,n=0,r=c(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i}}catch(a){r.e(a)}finally{r.f()}return e.map((function(e){return e/n}))}var D=function(e){var t,n=0,r=c(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i*Math.log2(i)}}catch(a){r.e(a)}finally{r.f()}return-n},O=function(){function e(t,n,r){y(this,e),this.dataSource=t,this.X=n,this.Y=r,this.normalizedDataSource=t}return w(e,[{key:"normalizeDimensions",value:function(e){var t=this;return this.normalizedDataSource=[],this.valueSets=[],e.forEach((function(){t.valueSets.push(new Map)})),this.dataSource.forEach((function(n){e.forEach((function(e,r){var i=(n[e]||"others").toString();t.valueSets[r].has(i)||t.valueSets[r].set(i,t.valueSets[r].size)}))})),this.dataSource.forEach((function(n){var r=t.normalizeRecord(n,e);t.normalizedDataSource.push(r)})),this.normalizedDataSource}},{key:"normalizeRecord",value:function(e,t){var n=this,r={};return Object.keys(e).forEach((function(t){r[t]=e[t]})),t.forEach((function(t,i){var a=(e[t]||"others").toString();r[t]=n.valueSets[i].get(a)})),r}},{key:"mean",value:function(){var e=this,t=0,n=0;return 0===this.normalizedDataSource.length||(this.normalizedDataSource.forEach((function(r,i){t+=r[e.X],n+=r[e.Y]})),t/=this.normalizedDataSource.length,n/=this.normalizedDataSource.length),[t,n]}},{key:"getRegressionEquation",value:function(){var e=this;if(0===this.normalizedDataSource.length)return[0,0];var t,n=s(this.mean(),2),r=n[0],i=n[1],a=0,o=0;return this.normalizedDataSource.forEach((function(t){a+=(t[e.X]-r)*(t[e.Y]-i),o+=Math.pow(t[e.X]-r,2)})),[i-r*(t=a/o),t]}},{key:"r_squared",value:function(){var e=this,t=s(this.mean(),2)[1],n=s(this.getRegressionEquation(),2),r=n[0],i=n[1],a=0,o=0;return this.normalizedDataSource.forEach((function(n){var u=n[e.X],s=n[e.Y],c=u*i+r;a+=Math.pow(c-t,2),o+=Math.pow(s-t,2)})),a/o}},{key:"cumulativeLogisticDistribution",value:function(e){return 1/(1+Math.pow(Math.E,-(e-.2)/2))}},{key:"pValue",value:function(){var e=s(this.getRegressionEquation(),2)[1],t=this.cumulativeLogisticDistribution(Math.abs(e));return t>.5?2*(1-t):2*t}},{key:"significance",value:function(){return this.r_squared()*(1-this.pValue())}}]),e}(),T=n(2),N="_join_",z={sum:T.sum,max:T.max,mean:T.mean,min:T.min,count:function(e){return e.length}};function I(e){return z[e]||T.sum}var j=.3,C=.5;function F(e){for(var t=[],n=0;n<e.length;n++)for(var r=n+1;r<e[n].length;r++)t.push([[n,r],Math.abs(e[n][r])]);return t}function P(e,t){return e[t]===t?t:e[t]=P(e,e[t])}function q(e,t,n){var r=P(e,t),i=P(e,n);e[r]=i,P(e,t),P(e,n)}function L(e,t,n){return e[n]===n?n:(e[n]=L(e,t,e[n]),t[n]=t[e[n]],e[n])}function G(e,t,n,r){var i=L(e,t,n),a=L(e,t,r),o=t[i],u=t[a];e[i]=a,t[i]=t[a]=o+u,L(e,t,n),L(e,t,r)}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=F(e);r.sort((function(e,t){return t[1]-e[1]}));var i,a=[],o=e.map((function(e,t){return t})),u=g(o),s=!1,f=c(r);try{for(f.s();!(i=f.n()).done;){var h=i.value;P(o,h[0][0])!==P(o,h[0][1])&&(q(o,h[0][0],h[0][1]),a.push([h[0],h[1],s]));for(var l=0;l<o.length;l++)o[l]=P(o,l);var v=new Set(o);if(v.size<=t||h[1]<n?s=!0:u=g(o),1===v.size)break}}catch(d){f.e(d)}finally{f.f()}return{edgesInMST:a,groups:u}}var R=function(e){var t,n=e.matrix,r=e.measures,i=(e.method,e.groupMaxSize),a=void 0===i?4:i,o=e.limitSize,u=void 0!==o&&o,s=e.threshold,f=void 0===s?0:s;t=u?function(e,t){var n=F(e);n.sort((function(e,t){return t[1]-e[1]}));var r,i=e.map((function(e,t){return t})),a=e.map((function(){return 1})),o=c(n);try{for(o.s();!(r=o.n()).done;){var u=r.value;if(L(i,a,u[0][0])!==L(i,a,u[0][1])){if(a[u[0][0]]+a[u[0][1]]>t)continue;G(i,a,u[0][0],u[0][1])}for(var s=0;s<i.length;s++)i[s]=L(i,a,s);if(1===new Set(i).size)break}}catch(l){o.e(l)}finally{o.f()}for(var f=new Map,h=0;h<i.length;h++)f.has(i[h])||f.set(i[h],[]),f.get(i[h]).push(h);return f}(n,a):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=F(e);r.sort((function(e,t){return t[1]-e[1]}));var i,a=e.map((function(e,t){return t})),o=c(r);try{for(o.s();!(i=o.n()).done;){var u=i.value;P(a,u[0][0])!==P(a,u[0][1])&&q(a,u[0][0],u[0][1]);for(var s=0;s<a.length;s++)a[s]=P(a,s);if(new Set(a).size<=t||u[1]<n)break}}catch(l){o.e(l)}finally{o.f()}for(var f=new Map,h=0;h<a.length;h++)f.has(a[h])||f.set(a[h],[]),f.get(a[h]).push(h);return f}(n,a,f);var h,l=[],v=c(t.values());try{for(v.s();!(h=v.n()).done;){var d=h.value;l.push(d.map((function(e){return r[e]})))}}catch(p){v.e(p)}finally{v.f()}return l};function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e){return(U="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){return!t||"object"!==U(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function X(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H(e);if(t){var i=H(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return W(this,n)}}var B=function(e){K(n,e);var t=X(n);function n(e){var r;y(this,n),r=t.call(this,e);var i=e.K;return r.K=i,r.normalize(),r}return w(n,[{key:"getNeighbors",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];n.length!==t.length&&t.forEach((function(e){n.push(1)}));for(var r=[],i=[],a=[],o=[],u=new Set(this.dimensions),s=0;s<t.length;s++)u.has(t[s])?(r.push(t[s]),a.push(n[s])):(i.push(t[s]),o.push(n[s]));var c=[];this.normalizedDataSource.forEach((function(t,n){var u=0;i.forEach((function(n,r){u+=Math.pow((t[n]-e[n])*o[r],2)})),r.forEach((function(n,r){t[n]!==e[n]&&(u+=Math.pow(a[r],2))})),c.push({dis:u,index:n})})),c.sort((function(e,t){return e.dis-t.dis}));for(var f=[],h=Math.min(this.K,c.length),l=0;l<h;l++)f.push(this.normalizedDataSource[c[l].index]);return f}},{key:"getTargetValue",value:function(e,t){var n=this,r=[];return e.forEach((function(e){var i=new Map;t.forEach((function(t){i.has(t[e])||i.set(t[e],0),i.set(t[e],i.get(t[e])+1)}));var a,o=0,u=0,s=c(i);try{for(s.s();!(a=s.n()).done;){var f=a.value;f[1]>o&&(o=f[1],u=f[0])}}catch(l){s.e(l)}finally{s.f()}var h=n.dimensions.indexOf(e);h>-1?r.push(n.valueParser[h][u]):r.push(u)})),r}}]),n}(function(){function e(t){y(this,e);var n=t.dataSource,r=t.dimensions,i=t.measures;this.dataSource=n,this.dimensions=r,this.measures=i}return w(e,[{key:"normalize",value:function(){var e=this;return this.normalizedDataSource=[],this.valueSets=[],this.valueParser=[],this.ranges=[],this.dimensions.forEach((function(t){e.valueSets.push(new Map),e.valueParser.push([])})),this.measures.forEach((function(){e.ranges.push([1/0,-1/0])})),this.dataSource.forEach((function(t){e.dimensions.forEach((function(n,r){var i=(t[n]||"others").toString();e.valueSets[r].has(i)||(e.valueSets[r].set(i,e.valueSets[r].size),e.valueParser[r].push(i))})),e.measures.forEach((function(n,r){var i=t[n];"number"===typeof i&&(e.ranges[r][0]=Math.min(e.ranges[r][0],i),e.ranges[r][1]=Math.max(e.ranges[r][1],i))}))})),this.dataSource.forEach((function(t){var n=e.normalizeRecord(t);e.normalizedDataSource.push(n)})),this.normalizedDataSource}},{key:"normalizeRecord",value:function(e){var t=this,n={};return this.measures.forEach((function(r,i){n[r]=(e[r]-t.ranges[i][0])/(t.ranges[i][1]-t.ranges[i][0])})),this.dimensions.forEach((function(r,i){var a=(e[r]||"others").toString();n[r]=t.valueSets[i].get(a)})),n}}]),e}());function Y(e,t){for(var n=function(e,t){if(0===e)return[];for(var n=2147483647,r=[t],i=1;i<e;i++)r.push((1103515245*r[i-1]+12345)%n);return r.map((function(e){return e/n}))}(t,2147483647*Math.random()),r=[],i=0;i<t;i++){var a=Math.floor(n[i]*t)%t;r.push(e[a])}return r}var $=8,J={IsolationForest:function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:256;y(this,e),this.dimensions=t,this.measures=n,this.dataSource=r,r.length<a?(this.treeNumber=Math.max(1,Math.ceil(a/50)),this.sampleSize=Math.max(2,Math.floor(r.length/2))):(this.treeNumber=i,this.sampleSize=a),this.limitHeight=Math.ceil(Math.log2(this.sampleSize)),this.iForest=[],this.normalizeDimensions()}return w(e,[{key:"normalizeDimensions",value:function(){var e=this;return this.normalizedDataSource=[],this.valueSets=[],this.ranges=[],this.dimensions.forEach((function(){e.valueSets.push(new Map)})),this.measures.forEach((function(){e.ranges.push([1/0,-1/0])})),this.dataSource.forEach((function(t){e.dimensions.forEach((function(n,r){var i=(t[n]||"others").toString();e.valueSets[r].has(i)||e.valueSets[r].set(i,e.valueSets[r].size)})),e.measures.forEach((function(n,r){var i=t[n];"number"===typeof i&&(e.ranges[r][0]=Math.min(e.ranges[r][0],i),e.ranges[r][1]=Math.max(e.ranges[r][1],i))}))})),this.dataSource.forEach((function(t){var n=e.normalizeRecord(t);e.normalizedDataSource.push(n)})),this.normalizedDataSource}},{key:"normalizeRecord",value:function(e){var t=this,n={};return this.measures.forEach((function(t){n[t]=e[t]})),this.dimensions.forEach((function(r,i){var a=(e[r]||"others").toString();n[r]=t.valueSets[i].get(a)})),n}},{key:"buildIsolationTree",value:function(e,t){if(t>=this.limitHeight||e.length<=1)return null;var n=Math.random(),r=this.measures[0]||this.dimensions[0],i=this.dimensions.length,a=this.measures.length,o=0;if(n>=i/(i+a)){var u=Math.floor(Math.random()*a)%a;r=this.measures[u],o=this.ranges[u][0]+(this.ranges[u][1]-this.ranges[u][0])*Math.random()}else{var s=Math.floor(Math.random()*i)%i;r=this.dimensions[s],o=Math.floor(this.valueSets[s].size*Math.random())%this.valueSets[s].size}var f,h=[],l=[],v=c(e);try{for(v.s();!(f=v.n()).done;){var d=f.value;d[r]<o?h.push(d):l.push(d)}}catch(m){v.e(m)}finally{v.f()}var p={field:r,value:o,size:e.length};return p.left=this.buildIsolationTree(h,t+1),p.right=this.buildIsolationTree(l,t+1),p}},{key:"AFS",value:function(e){return e>2?2*(Math.log(e-1)+.5772156649)-2*(e-1)/e:2===e?1:0}},{key:"getPathLength",value:function(e,t,n,r){return null===t?n+this.AFS(r):e[t.field]<t.value?this.getPathLength(e,t.left,n+1,t.size):this.getPathLength(e,t.right,n+1,t.size)}},{key:"buildIsolationForest",value:function(){this.iForest=[];for(var e=0;e<this.treeNumber;e++){var t=Y(this.normalizedDataSource,this.sampleSize),n=this.buildIsolationTree(t,0);this.iForest.push(n)}return this.iForest}},{key:"estimateOutierScore",value:function(){var e=this;return this.recordScoreList=[],this.normalizedDataSource.forEach((function(t){var n,r=0;e.iForest.forEach((function(n){r+=e.getPathLength(t,n,0,e.sampleSize)})),r/=e.iForest.length,n=Math.pow(2,-r/e.AFS(e.sampleSize)),e.recordScoreList.push(n)})),this.recordScoreList}}]),e}()};function Q(e,t){for(var n=t.map((function(e){return t.map((function(e){return 0}))})),r=0;r<t.length;r++){n[r][r]=1;for(var i=r+1;i<t.length;i++)n[r][i]=n[i][r]=M(e,t[r],t[i])}return n}function Z(e,t){for(var n=t.map((function(e){return t.map((function(e){return 0}))})),r=0;r<t.length;r++){n[r][r]=1;for(var i=r+1;i<t.length;i++){var a=S(e,t[r],t[i]);n[i][r]=n[r][i]=a}}return n}function ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j,i=arguments.length>3?arguments[3]:void 0,a=4,o=Q(e,t),u=r.kruskal({matrix:o,measures:t,groupMaxSize:i||Math.round(t.length/a),threshold:n});return u}function te(e,t,n,r){var i,a=[],o=c(ee(e,t,n));try{for(o.s();!(i=o.n()).done;){var u=x(i.value,1,r||$);a.push.apply(a,g(u))}}catch(s){o.e(s)}finally{o.f()}return a}function ne(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,a=3,o=Z(e,t),u=r.kruskal({matrix:o,measures:t,groupMaxSize:i||Math.round(t.length/a),threshold:n||C});return u}function re(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n?te(e,t):x(t)}function ie(e,t,n,r){for(var i=t.map((function(e){return n.includes(e)})),a=[],o=[],u=0;u<e.length;u++)if(i[u])for(var s=0;s<e[u].length;s++)i[s]||a.push([e[u][s],[u,s]]);a.sort((function(e,t){return t[0]-e[0]}));for(var c=0;c<a.length;c++){var f=a[c][1][1];i[f]||(i[f]=!0,o.push({field:t[f],corValue:a[c][0]}))}return o.slice(0,r||o.length)}var ae=n(1),oe=n.n(ae);function ue(e,t){var n,i=[],a=function(e,t){for(var n=t.map((function(e){return t.map((function(e){return 0}))})),r=0;r<t.length;r++){n[r][r]=1;for(var i=r+1;i<t.length;i++)n[r][i]=n[i][r]=M(e,t[r],t[i])}return n}(e,t),o=c(r.kruskal({matrix:a,measures:t,groupMaxSize:Math.round(t.length/4),threshold:j}));try{for(o.s();!(n=o.n()).done;){var u=x(n.value,1,$);i.push.apply(i,g(u))}}catch(s){o.e(s)}finally{o.f()}return i}function se(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n?ue(e,t):x(t)}function ce(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sum",a=[],o=se(e,t,!0),u=c(o);try{for(u.s();!(r=u.n()).done;){var s,f=r.value,h={},l=oe()({dataSource:e,dimensions:f,measures:n,asFields:n,operator:i||"sum"}),v=c(n);try{var d=function(){var e=s.value,t=_(k(l.map((function(t){return t[e]})))),n=D(t);h[e]=n};for(v.s();!(s=v.n()).done;)d()}catch(b){v.e(b)}finally{v.f()}for(var p=n.map((function(e){return n.map((function(e){return 0}))})),m=0;m<n.length;m++){p[m][m]=1;for(var g=m+1;g<n.length;g++){var y=S(l,n[m],n[g]);p[g][m]=p[m][g]=y}}a.push([f,h,p])}}catch(b){u.e(b)}finally{u.f()}return a}var fe=n(0),he=n.n(fe);function le(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function ve(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){le(a,r,i,o,u,"next",e)}function u(e){le(a,r,i,o,u,"throw",e)}o(void 0)}))}}var de=function(e){K(n,e);var t=X(n);function n(){return y(this,n),t.apply(this,arguments)}return w(n,[{key:"getTargetValuePercent",value:function(e,t,n){var r=[];return e.forEach((function(e,i){var a=0;n.forEach((function(n){n[e]===t[e]&&a++})),r.push(a/n.length)})),r}},{key:"getSignificance",value:function(e,t){var n=this,r=0;return this.normalizedDataSource.forEach((function(i){var a=n.getNeighbors(i,e),o=n.getTargetValuePercent(t,i,a),u=0;o.forEach((function(e){u+=e})),u/=o.length,r+=u})),r/=this.normalizedDataSource.length}}]),n}(B),pe="=;=";function me(e,t){var n,r=[],i=c(e);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,u=c(t);try{for(u.s();!(a=u.n()).done;){var s=a.value;r.push({dimensions:o,measures:s})}}catch(f){u.e(f)}finally{u.f()}}}catch(f){i.e(f)}finally{i.f()}return r}function ge(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$,r=[],i=c(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=x(a,1,n);r.push.apply(r,g(o))}}catch(u){i.e(u)}finally{i.f()}return r}var ye,be=function(){var e=ve(he.a.mark((function e(t,n,r){var i,a,o,u,s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0,a=0,o=c(r);try{for(s=function(){var e=u.value,n=t.map((function(t){return t[e]})),r=_(k(n)),o=D(r);i+=o,a+=o/Math.log2(n.length)},o.s();!(u=o.n()).done;)s()}catch(f){o.e(f)}finally{o.f()}return i/=r.length,a=1-(a/=r.length),e.abrupt("return",{dimensions:n,measures:r,type:"default_general",score:i,impurity:i,significance:a,order:"asc"});case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),we=function(){var e=ve(he.a.mark((function e(t,n,r){var i,a,o,u,s,c;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for((i=new J.IsolationForest([],r,t)).buildIsolationForest(),a=i.estimateOutierScore(),o=0,u=0,s=0;s<a.length;s++)a[s]>u&&(u=a[s],o=s);return c={},n.concat(r).forEach((function(e){c[e]=t[o][e]})),e.abrupt("return",{dimensions:n,measures:r,score:u,significance:u,order:"desc",description:c});case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Me=function(){var e=ve(he.a.mark((function e(t,n,r){var i,a,o,u,s,f;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1===n.length){e.next=2;break}return e.abrupt("return",null);case 2:(i=g(t)).sort((function(e,t){return e[n[0]]>t[n[0]]?1:e[n[0]]===t[n[0]]?0:e[n[0]]<t[n[0]]?-1:void 0})),a=0,o=c(r);try{for(o.s();!(u=o.n()).done;)s=u.value,(f=new O(i,n[0],s)).normalizeDimensions(n),a+=f.significance()}catch(h){o.e(h)}finally{o.f()}return a/=r.length,e.abrupt("return",{dimensions:n,measures:r,score:a,significance:a,order:"desc"});case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Se=function(){var e=ve(he.a.mark((function e(t,n,r){var i,a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length<2)){e.next=2;break}return e.abrupt("return",null);case 2:return 0,a=new de({dataSource:t,dimensions:n,measures:r,K:8}),i=a.getSignificance(r.concat(n.slice(0,-1)),n.slice(-1)),e.abrupt("return",{dimensions:n,measures:r,score:i,significance:i,order:"desc"});case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();!function(e){e.outlier="default_outlier",e.cluster="default_group",e.trend="default_trend"}(ye||(ye={}));var Ee=function(){function e(){y(this,e),this.workers=new Map}return w(e,[{key:"register",value:function(e,t){if(this.workers.has(e))throw new Error("There has been a worker named: ".concat(e," already."));this.workers.set(e,[!0,t])}},{key:"enable",value:function(e,t){if(!this.workers.has(e))throw new Error('Intention Worker "'.concat(e,'" does not exist.'));var n=this.workers.get(e);n[0]=t,this.workers.set(e,n)}},{key:"each",value:function(e){var t,n=c(this.workers);try{for(n.s();!(t=n.n()).done;){var r=s(t.value,2),i=r[0],a=r[1];a[0]&&e(a[1],i)}}catch(o){n.e(o)}finally{n.f()}}}],[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{withDefaultIWorkers:!0},n=t.withDefaultIWorkers,r=void 0===n||n;for(var i in e.colletion||(e.colletion=new e,r&&(e.colletion.register(ye.outlier,we),e.colletion.register(ye.cluster,Se),e.colletion.register(ye.trend,Me))),ye)e.colletion.enable(ye[i],r);return e.colletion}}]),e}();function ke(e,t,n){return xe.apply(this,arguments)}function xe(){return(xe=ve(he.a.mark((function e(t,n,r){var i,a,o,u;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],a=c(n),e.prev=2,u=he.a.mark((function e(){var n,a,u,s,c,f;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.value,a=n.dimensions,u=n.measures,s=a.join(pe),!t.has(s)){e.next=9;break}return c=t.get(s),e.next=7,be(c,a,u);case 7:f=e.sent,r.each(function(){var e=ve(he.a.mark((function e(t,n){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(c,a,u);case 3:null!==(r=e.sent)&&(r.type=n,r.impurity=f.impurity,i.push(r)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("worker failed",{dimensions:a,measures:u,aggData:c},e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}());case 9:case"end":return e.stop()}}),e)})),a.s();case 5:if((o=a.n()).done){e.next=9;break}return e.delegateYield(u(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),a.e(e.t1);case 14:return e.prev=14,a.f(),e.finish(14);case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})))).apply(this,arguments)}function _e(e){return De.apply(this,arguments)}function De(){return(De=ve(he.a.mark((function e(t){var n,r,i,a,o,u,s,f,h,l,v,d,p,m,g,y,b,w,M,S,E,k,x,_,D,O,T;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.dataSource,r=t.dimensions,i=t.measures,a=t.collection,o=t.dimension_correlation_threshold,u=void 0===o?j:o,s=t.measure_correlation_threshold,f=void 0===s?C:s,h=t.max_dimension_num_in_view,l=void 0===h?3:h,v=t.max_measure_num_in_view,d=void 0===v?3:v,p=ee(n,r,u),m=ge(p,l),g=ne(n,i,f),y=ge(g,d),b=me(m,y),w=new Map,M=(new Date).getTime(),S=c(m);try{for(S.s();!(E=S.n()).done;)k=E.value,x=k.join(pe),_=oe()({dataSource:n,dimensions:k,measures:i,asFields:i,operator:"sum"}),w.set(x,_)}catch(N){S.e(N)}finally{S.f()}return D=(new Date).getTime(),console.log("cube cost",D-M),w.set("*",n),O=a||Ee.init(),e.next=18,ke(w,b,O);case 18:return T=e.sent,e.abrupt("return",T);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t){return function(e,t){return e.every((function(e){return Number(e[t])>=1800&&Number(e[t])<=2200||!isNaN(Date.parse(e[t]))&&"string"===typeof e[t]&&/^[0-9]{0,4}[-/][0-9]{0,2}([-/][0-9]{0,2}$)?/.test(e[t])||"undefined"===typeof e[t]||null===e[t]}))}(e,t)?"temporal":function(e,t){return e.every((function(e){return"number"===typeof e[t]||"undefined"===typeof e[t]||null===e[t]}))}(e,t)?"quantitative":(function(e,t){e.every((function(e){return"string"===typeof e[t]||"undefined"===typeof e[t]||null===e[t]}))}(e,t),"nominal")}var Te={boolean:function(e){return"true"===e||"false"===e||!0===e||!1===e},integer:function(e){return Te.number(e)&&(e=+e)===~~e},number:function(e){return!isNaN(+e)},date:function(e){return!isNaN(Date.parse(e))}};function Ne(e,t){var n,r=[],i=new Map,a=c(e);try{var o=function(){var e=n.value,a=new Map;t.forEach((function(t){a.has(t[e])||a.set(t[e],0),a.set(t[e],a.get(t[e])+1)}));var o=function(e){var t,n,r=["boolean","integer","number","date"],i=c(e);try{for(i.s();!(t=i.n()).done;){for(var a=t.value,o=0;o<r.length;++o)null==(n=a)||n!==n||Te[r[o]](a)||(r.splice(o,1),o-=1);if(0===r.length)return"string"}}catch(u){i.e(u)}finally{i.f()}return r[0]}(g(a.keys())),u=Oe(t,e),s="dimension";"integer"!==o&&"number"!==o||(s="measure");var f={key:e,analyticType:s,semanticType:u,dataType:o,domain:a};r.push(f),i.set(f.key,f)};for(a.s();!(n=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}return{fields:r,dictonary:i}}var ze,Ie=function(){function e(t,n,r){y(this,e),this.DIMENSION_CORRELATION_THRESHOLD=j,this.MEASURE_CORRELATION_THRESHOLD=C,this.dimensions=n,this.measures=r,this.computeDGraph(t),this.computeMGraph(t)}return w(e,[{key:"computeGraph",value:function(e,t,n){for(var r=t.map((function(e){return t.map((function(){return 0}))})),i=0;i<t.length;i++){r[i][i]=1;for(var a=i+1;a<t.length;a++)r[i][a]=r[a][i]=n(e,t[i],t[a])}return r}},{key:"computeDGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return this.DG=this.computeGraph(e,this.dimensions,t),this.DG}},{key:"computeMGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;return this.MG=this.computeGraph(e,this.measures,t),this.MG}},{key:"clusterDGraph",value:function(e,t){var n=this.dimensions,r=this.DIMENSION_CORRELATION_THRESHOLD;return this.DClusters=ee(e,n,t||r),this.DClusters}},{key:"clusterMGraph",value:function(e,t){var n=this.measures,r=this.MEASURE_CORRELATION_THRESHOLD;return this.MClusters=ne(e,n,t||r),this.MClusters}}]),e}(),je=["max","min","sum","mean","count"],Ce=function(){function e(t){y(this,e);var n=t.dimensions,r=t.measures,i=t.ops,a=void 0===i?je:i;this.dimensions=n,this.measures=r,this.ops=a,this.state=[]}return w(e,[{key:"setData",value:function(e){return this.state=function(e){var t,n=e.dataSource,r=e.dimensions,i=e.measures,a=e.ops,o=new Map,u=c(n);try{var f=function(){var e=t.value,n=r.map((function(t){return e[t]})).join(N);o.has(n)||o.set(n,[]),o.get(n).push(e)};for(u.s();!(t=u.n()).done;)f()}catch(p){u.e(p)}finally{u.f()}var h,l=[],v=c(o);try{var d=function(){var e=s(h.value,2),t=e[0],n=e[1],o={};i.forEach((function(e,t){o[e]={},a.forEach((function(t){var r=I(t);o[e][t]=r(n.map((function(t){return t[e]})))}))}));var u=t.split(N);r.forEach((function(e,t){o[e]=u[t]})),l.push(o)};for(v.s();!(h=v.n()).done;)d()}catch(p){v.e(p)}finally{v.f()}return l}({dimensions:this.dimensions,measures:this.measures,ops:this.ops,dataSource:e}),this.state}},{key:"computeFromCuboid",value:function(e){var t=this.ops,n=this.measures,r=this.dimensions;return this.state=function(e){var t,n=e.dataSource,r=e.dimensions,i=e.measures,a=e.ops,o=new Map,u=c(n);try{var f=function(){var e=t.value,n=r.map((function(t){return e[t]})).join(N);o.has(n)||o.set(n,[]),o.get(n).push(e)};for(u.s();!(t=u.n()).done;)f()}catch(p){u.e(p)}finally{u.f()}var h,l=[],v=c(o);try{var d=function(){var e=s(h.value,2),t=e[0],n=e[1],o={};i.forEach((function(e,t){o[e]={},a.filter((function(e){return!["sum","count","mean"].includes(e)})).forEach((function(t){var r=I(t);o[e][t]=r(n.map((function(n){return n[e][t]})))})),o[e].sum=I("sum")(n.map((function(t){return t[e].sum}))),o[e].count=I("sum")(n.map((function(t){return t[e].count}))),o[e].mean=o[e].sum/o[e].count}));var u=t.split(N);r.forEach((function(e,t){o[e]=u[t]})),l.push(o)};for(v.s();!(h=v.n()).done;)d()}catch(p){v.e(p)}finally{v.f()}return l}({dimensions:r,measures:n,ops:t,dataSource:e.getRawState()}),this.state}},{key:"getState",value:function(e,t){var n,r=[],i=this.state,a=this.dimensions,o=c(i);try{for(o.s();!(n=o.n()).done;){var u,s=n.value,f={},h=c(a);try{for(h.s();!(u=h.n()).done;){var l=u.value;f[l]=s[l]}}catch(m){h.e(m)}finally{h.f()}for(var v=0;v<e.length;v++){var d=e[v],p=t[v];f[d]=s[d][p]}r.push(f)}}catch(m){o.e(m)}finally{o.f()}return r}},{key:"getRawState",value:function(){return this.state}},{key:"size",get:function(){return this.state.length}}]),e}(),Fe="_join_",Pe=["max","min","sum","mean","count"],qe=function(){function e(t){var n=this;y(this,e);var r=t.dimensions,i=t.measures,a=t.dataSource,o=t.ops,u=void 0===o?Pe:o;this.dimensions=r,this.measures=i,this.dataSource=a,this.ops=u,this.dimOrder=new Map,r.forEach((function(e,t){n.dimOrder.set(e,t)})),this.cuboids=new Map}return w(e,[{key:"sortDimension",value:function(e){var t=this,n=g(e);return n.sort((function(e,n){return t.dimOrder.get(e)-t.dimOrder.get(n)})),n}},{key:"getCuboid",value:function(e){var t=this.sortDimension(e),n=t.join(Fe);if(this.cuboids.has(n))return this.cuboids.get(n);var r,i=new Set(e),a=[],o=[],u=c(this.dimensions);try{for(u.s();!(r=u.n()).done;){var s=r.value;if(!i.has(s)){var f=this.sortDimension([].concat(g(t),[s])).join(Fe);this.cuboids.has(f)?a.push(f):o.push(f)}}}catch(w){u.e(w)}finally{u.f()}var h=1/0,l=this.dimensions.join(Fe);if(a.length>0){var v,d=c(a);try{for(d.s();!(v=d.n()).done;){var p=v.value,m=this.cuboids.get(p);m.size<h&&(h=m.size,l=p)}}catch(w){d.e(w)}finally{d.f()}}else o.length>0&&(l=o[0]);var y=this.getCuboid(l.split(Fe)),b=new Ce({dimensions:e,measures:this.measures,ops:this.ops});return b.computeFromCuboid(y),this.cuboids.set(n,b),b}},{key:"buildBaseCuboid",value:function(){var e=new Ce({dimensions:this.dimensions,measures:this.measures,ops:this.ops});return e.setData(this.dataSource),this.cuboids.set(this.dimensions.join(Fe),e),e}},{key:"baseCuboid",get:function(){var e=this.dimensions.join(Fe);return this.cuboids.has(e)?this.cuboids.get(e):this.buildBaseCuboid()}}]),e}(),Le=function(){var e=ve(he.a.mark((function e(t,n,r){var i,a,o,u,s,c;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for((i=new J.IsolationForest([],r,t)).buildIsolationForest(),a=i.estimateOutierScore(),o=0,u=0,s=0;s<a.length;s++)a[s]>u&&(u=a[s],o=s);return c={},n.concat(r).forEach((function(e){c[e]=t[o][e]})),e.abrupt("return",{dimensions:n,measures:r,significance:u,description:c});case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Ge=function(){var e=ve(he.a.mark((function e(t,n,r){var i,a,o,u,s,f;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1===n.length){e.next=2;break}return e.abrupt("return",null);case 2:(i=g(t)).sort((function(e,t){return e[n[0]]>t[n[0]]?1:e[n[0]]===t[n[0]]?0:-1})),a=0,o=c(r);try{for(o.s();!(u=o.n()).done;)s=u.value,(f=new O(i,n[0],s)).normalizeDimensions(n),a+=f.significance()}catch(h){o.e(h)}finally{o.f()}return a/=r.length,e.abrupt("return",{dimensions:n,measures:r,significance:a});case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();!function(e){e.outlier="default_outlier",e.trend="default_trend"}(ze||(ze={}));var Ae=function(){function e(){y(this,e),this.workers=new Map}return w(e,[{key:"register",value:function(e,t){if(this.workers.has(e))throw new Error("There has been a worker named: ".concat(e," already."));this.workers.set(e,[!0,t])}},{key:"enable",value:function(e,t){if(!this.workers.has(e))throw new Error('Intention Worker "'.concat(e,'" does not exist.'));var n=this.workers.get(e);n[0]=t,this.workers.set(e,n)}},{key:"each",value:function(e){var t,n=c(this.workers);try{for(n.s();!(t=n.n()).done;){var r=s(t.value,2),i=r[0],a=r[1];a[0]&&e(a[1],i)}}catch(o){n.e(o)}finally{n.f()}}}],[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{withDefaultIWorkers:!0},n=t.withDefaultIWorkers,r=void 0===n||n;return e.colletion||(e.colletion=new e,r&&(e.colletion.register(ze.outlier,Le),e.colletion.register(ze.trend,Ge))),Object.values(ze).forEach((function(t){e.colletion.enable(t,r)})),e.colletion}}]),e}(),Re={interval:[0,10],line:[11,1/0],area:[11,1/0],point:[0,1e3],path:[0,100],density:[1001,1/0]};function Ve(e,t){for(var n=t.length-1;n>=0;n--)if(t[n].semanticType===e&&!t[n].choosen)return t[n];return!1}function Ke(e,t){var n=function(e){for(var t={},n={position:2,color:1,size:1,shape:1,opacity:1,facets:2,page:1,filter:1,highFacets:1e3},r=e.map((function(e){return l(l({},e),{},{choosen:!1})})),i=[["quantitative",["position","size","color","highFacets","opacity","page","filter"]],["temporal",["position","page","filter"]],["ordinal",["position","color","opacity","facets","size","page","filter","highFacets"]],["nominal",["position","color","facets","shape","page","filter","hightFacets"]]],a=r.length,o=0;o<i.length&&a>0;o++)for(var u=i[o][0],s=i[o][1],c=0;c<s.length&&a>0;c++)for(var f=s[c],h=void 0;n[f]>0&&(h=Ve(u,r));)"undefined"===typeof t[f]&&(t[f]=[]),t[f].push(h.key),n[f]--,a--,h.choosen=!0;return t}(e.sort((function(e,t){return e.impurity-t.impurity}))),r=new Set(e.filter((function(e){return"dimension"===e.analyticType})).map((function(e){return e.key}))),i=new Set(e.filter((function(e){return"measure"===e.analyticType})).map((function(e){return e.key})));if(n.position&&2===n.position.length)if(r.has(n.position[0])&&i.has(n.position[1])||r.has(n.position[1])&&i.has(n.position[0])){var a=r.has(n.position[0])?0:1,o=n.position[a],u=n.position[(a+1)%2];n.position=[o,u];var s=e.find((function(e){return e.key===o})),c=s?s.domain.size:0;n.geomType=["interval","line","area"].filter((function(e){return c>=Re[e][0]&&c<=Re[e][1]})),"nominal"===s.semanticType&&(n.geomType=["interval"])}else n.geomType=["point","density"].filter((function(e){return t.length>=Re[e][0]&&t.length<=Re[e][1]}));return{schema:n,dataView:t}}var He=function(){function e(){y(this,e),this.DIMENSION_NUM_IN_VIEW={MAX:3,MIN:1},this.MEASURE_NUM_IN_VIEW={MAX:3,MIN:1},this.cube=null,this.aggregators=["max","min","sum","mean","count"],this.workerCollection=Ae.init()}return w(e,[{key:"setDataSource",value:function(e){return this.dataSource=e,this}},{key:"setDimensions",value:function(e){return this._dimensions=e,this._fields.forEach((function(t){"dimension"!==t.analyticType&&e.includes(t.key)&&(t.analyticType="dimension")})),this}},{key:"setMeasures",value:function(e){return this._measures=e,this._fields.forEach((function(t){"measure"!==t.analyticType&&e.includes(t.key)&&(t.analyticType="measure")})),this}},{key:"setFieldKeys",value:function(e){return this._fieldKeys=e,this}},{key:"buildfieldsSummary",value:function(){var e=this,t=Ne(this._fieldKeys,this.dataSource),n=t.fields,r=t.dictonary;return this.dimensions&&this.measures&&n.forEach((function(t){e.dimensions.includes(t.key)?t.analyticType="dimension":t.analyticType="measure"})),this.fields=n,this.fieldDictonary=r,this}},{key:"buildGraph",value:function(){return this.dataGraph=new Ie(this.dataSource,this.dimensions,this.measures),this}},{key:"buildCube",value:function(){var e=this.measures,t=this.dataSource,n=this.dataGraph,r=this.dimensions,i=this.aggregators,a=new qe({dimensions:r,measures:e,dataSource:t,ops:i});return a.buildBaseCuboid(),n.DClusters.forEach((function(e){a.getCuboid(e)})),this.cube=a,this}},{key:"clusterFields",value:function(){return this.dataGraph.clusterDGraph(this.dataSource),this.dataGraph.clusterMGraph(this.dataSource),this}},{key:"buildSubspaces",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.DIMENSION_NUM_IN_VIEW,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.MEASURE_NUM_IN_VIEW,i=this.dataGraph.DClusters,a=this.dataGraph.MClusters,o=e.getCombinationFromClusterGroups(a,r),u=[],s=c(i);try{for(s.s();!(t=s.n()).done;){var f,h=t.value,l=x(h,n.MIN,n.MAX),v=c(l);try{for(v.s();!(f=v.n()).done;){var d,p=f.value,m=c(o);try{for(m.s();!(d=m.n()).done;){var g=d.value;u.push({dimensions:p,measures:g})}}catch(y){m.e(y)}finally{m.f()}}}catch(y){v.e(y)}finally{v.f()}}}catch(y){s.e(y)}finally{s.f()}return this.subSpaces=u,this}},{key:"insightExtraction",value:function(){var t=ve(he.a.mark((function t(){var n,r,i,a,o,u,s=this,f=arguments;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=f.length>0&&void 0!==f[0]?f[0]:this.subSpaces,r=this,i=[],a=c(n),t.prev=4,u=he.a.mark((function t(){var n,a,u,c,f,h,l,v;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.value,a=n.dimensions,u=n.measures,c=r.cube,f=c.getCuboid(a),h=f.getState(u,u.map((function(){return"sum"}))),l=e.getSpaceImpurity(h,a,u),v=[],s.workerCollection.each((function(e,t){var n=function(){var e=ve(he.a.mark((function e(t,n){var o;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(h,a,u,r.fieldDictonary,r);case 3:null!==(o=e.sent)&&(o.type=n,o.impurity=l,i.push(o)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("worker failed",{dimensions:a,measures:u,aggData:h},e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}();v.push(n(e,t))})),t.next=10,Promise.all(v);case 10:case"end":return t.stop()}}),t)})),a.s();case 7:if((o=a.n()).done){t.next=11;break}return t.delegateYield(u(),"t0",9);case 9:t.next=7;break;case 11:t.next=16;break;case 13:t.prev=13,t.t1=t.catch(4),a.e(t.t1);case 16:return t.prev=16,a.f(),t.finish(16);case 19:return r.insightSpaces=i,t.abrupt("return",i);case 21:case"end":return t.stop()}}),t,this,[[4,13,16,19]])})));return function(){return t.apply(this,arguments)}}()},{key:"setInsightScores",value:function(){return this.insightSpaces.forEach((function(e){e.score=e.impurity/e.significance})),this}},{key:"getFieldInfoInVis",value:function(e){var t=[],n=this.cube,r=this.fieldDictonary,i=e.dimensions,a=e.measures;i.forEach((function(e){var i=n.getCuboid([e]).getState(a,a.map((function(){return"sum"}))),o=0;a.forEach((function(e){var t=_(k(i.map((function(t){return t[e]})))),n=D(t);o+=n})),t.push(l(l({},r.get(e)),{},{impurity:o}))}));var o=n.getCuboid(i).getState(a,a.map((function(){return"sum"})));return a.forEach((function(e){var n=_(k(o.map((function(t){return t[e]})))),i=D(n);t.push(l(l({},r.get(e)),{},{impurity:i}))})),t}},{key:"specification",value:function(e){var t=e.dimensions,n=e.measures;return Ke(this.getFieldInfoInVis(e),this.cube.getCuboid(t).getState(n,n.map((function(){return"sum"}))))}},{key:"fields",get:function(){return this._fields},set:function(e){this._fields=e,this._dimensions=e.filter((function(e){return"dimension"===e.analyticType})).map((function(e){return e.key})),this._measures=e.filter((function(e){return"measure"===e.analyticType})).map((function(e){return e.key}))}},{key:"dimensions",get:function(){return this._dimensions}},{key:"measures",get:function(){return this._measures}}],[{key:"getCombinationFromClusterGroups",value:function(e,t){var n,r=[],i=c(e);try{for(i.s();!(n=i.n()).done;){var a=x(n.value,t.MIN,t.MAX);r.push.apply(r,g(a))}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getSpaceImpurity",value:function(e,t,n){var r,i=0,a=c(n);try{var o=function(){var t=r.value,n=_(k(e.map((function(e){return e[t]})))),a=D(n);i+=a};for(a.s();!(r=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}return i/=n.length}}]),e}();function Ue(e,t,n,r){var i={},a={};n.forEach((function(e){i[e]=0,a[e]=0})),t.forEach((function(e){n.forEach((function(t){i[t]+=Math.abs(e[t])}))})),e.forEach((function(e){n.forEach((function(t){a[t]+=Math.abs(e[t])}))}));var o=[];t.forEach((function(e){var t=l({},e);n.forEach((function(e){t[e]/=i[e]})),o.push(t)}));var u=[];return e.forEach((function(e){var t=l({},e);n.forEach((function(e){t[e]/=r?i[e]:a[e]})),u.push(t)})),{normalizedData:u,normalizedParentData:o}}function We(e,t,n,r){var i,a=0,o=t.map((function(){return!1})),u=c(e);try{var s=function(){var e=i.value,u=t.findIndex((function(t,r){return!o[r]&&n.every((function(n){return t[n]===e[n]}))}));if(u>-1){o[u]=!0;var s,f=t[u],h=c(r);try{for(h.s();!(s=h.n()).done;){var l=s.value;a=Math.max(a,Math.max(f[l],e[l])/Math.min(f[l],e[l])),console.log("score",a)}}catch(m){h.e(m)}finally{h.f()}}else{var v,d=c(r);try{for(d.s();!(v=d.n()).done;){var p=v.value;a=Math.max(a,e[p])}}catch(m){d.e(m)}finally{d.f()}}};for(u.s();!(i=u.n()).done;)s()}catch(d){u.e(d)}finally{u.f()}for(var f=0;f<t.length;f++)if(!o[f]){o[f]=!0;var h,l=c(r);try{for(l.s();!(h=l.n()).done;){var v=h.value;a=Math.max(a,t[f][v])}}catch(d){l.e(d)}finally{l.f()}}return a}function Xe(e,t){var n=new Map;t.forEach((function(e){n.set(e,0)})),e.forEach((function(e){t.forEach((function(t){n.set(t,n.get(t)+Math.abs(e[t]))}))}));var r=[];return e.forEach((function(e){var i=l({},e);t.forEach((function(e){i[e]/=n.get(e)})),r.push(i)})),r}function Be(e,t,n,r){var i,a=0,o=c(e);try{for(o.s();!(i=o.n()).done;){var u=i.value;0!==u[n]&&0!==u[r]&&(a+=Math.max(u[n],u[r])/Math.min(u[n],u[r]))}}catch(s){o.e(s)}finally{o.f()}return a}var Ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];y(this,e),this.dataSource=void 0,this.dimensions=void 0,this.measures=void 0,this.engine=void 0,this.defaultAggs=["min","max","sum","count","mean"],this.engine=new a.VIEngine,this.dataSource=t,this.dimensions=[],this.measures=[];var n=[];t.length>0&&(n=Object.keys(t[0])),this.engine.setDataSource(t).setFieldKeys(n).buildfieldsSummary()}return w(e,[{key:"setDimensions",value:function(e){return this.dimensions=e,this.engine.setDimensions(e),this}},{key:"setMeasures",value:function(e){return this.measures=e,this.engine.setMeasures(e),this}},{key:"preAnalysis",value:function(){return console.log("start"),this.engine.buildGraph(),this.engine.dataGraph.DIMENSION_CORRELATION_THRESHOLD=.6,this.engine.dataGraph.MEASURE_CORRELATION_THRESHOLD=.8,console.log("graph finish"),this.engine.clusterFields(),console.log("cluster finish"),this.engine.buildSubspaces({MAX:2,MIN:1},{MAX:2,MIN:1}),console.log("subspaces finsh. start build-cube"),this.engine.buildCube(),console.log("cube finish"),this}},{key:"explain",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.3;this.explainConditionalValue(e,t,n);var i=0===t.length||0===e.length;console.log({selectAll:i});var a=i?[]:this.explainBySelection(e,t,n,10),o=i?[]:this.explainByCorMeasures(e,t,n,10),u=this.explainByChildren([],t,n,10),s=[];return a.forEach((function(r){s.push({dimensions:t,extendDs:r.dimensions,measures:n,extendMs:[],score:r.score,type:"selection_dim_distribution",description:r,predicates:e})})),o.forEach((function(r){s.push({dimensions:t,extendDs:[],extendMs:r.measures,measures:n,score:r.score,type:"selection_mea_distribution",description:r,predicates:e})})),u.majorList.forEach((function(r){s.push({dimensions:t,extendDs:r.dimensions,measures:n,extendMs:[],score:r.score,type:"children_major_factor",description:r,predicates:e})})),u.outlierList.forEach((function(r){s.push({dimensions:t,extendDs:r.dimensions,measures:n,extendMs:[],score:r.score,type:"children_outlier",description:r,predicates:e})})),s.filter((function(e){return e.score>=r}))}},{key:"explainConditionalValue",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=this.getGeneralizeKNN("dimension",t,i,0),o=c(a);try{for(o.s();!(r=o.n()).done;){var u=r.value,s=this.explainValue(e,[].concat(g(t),[u]),n);console.log(u,n,s)}}catch(f){o.e(f)}finally{o.f()}}},{key:"explainValue",value:function(e,t,n){var r,i=n.map((function(e){return e.key})),a=n.map((function(e){return e.op})),o=this.engine.cube.getCuboid(t).getState(i,a),u=m(o,e),s=[],f=c(i);try{var h=function(){var e=r.value,t=o.map((function(t){return t[e]}));t.sort((function(e,t){return e-t}));var n=u.map((function(t){return t[e]})),i=t[Math.floor(.15*t.length)],a=t[Math.min(Math.ceil(.85*t.length),t.length-1)];n.some((function(e){return e>=a}))?s.push(1):n.some((function(e){return e<=i}))?s.push(-1):s.push(0)};for(f.s();!(r=f.n()).done;)h()}catch(l){f.e(l)}finally{f.f()}return s}},{key:"explainByChildren",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,i=this.engine.cube.getCuboid(t),a=n.map((function(e){return e.key})),o=n.map((function(e){return e.op})),u=m(i.getState(a,o),e),s=this.getGeneralizeKNN("dimension",t,r,0);console.log("knn",s);var f,h=[],l=[],v=c(s);try{for(v.s();!(f=v.n()).done;){var y,b=f.value,w=this.engine.cube.getCuboid([].concat(g(t),[b])),M=m(w.getState(a,o),e),S=new Map,E=c(M);try{for(E.s();!(y=E.n()).done;){var k,x=y.value;S.has(x[b])||S.set(x[b],[]),null===(k=S.get(x[b]))||void 0===k||k.push(x)}}catch(I){E.e(I)}finally{E.f()}var _=d(u,S,t,a),D=_.majorKey,O=_.majorSum;h.push({key:D,score:O,dimensions:[b],measures:n});var T=p(u,S,t,a),N=T.outlierKey,z=T.outlierSum;l.push({key:N,score:z,dimensions:[b],measures:n})}}catch(I){v.e(I)}finally{v.f()}return h.sort((function(e,t){return e.score-t.score})),l.sort((function(e,t){return t.score-e.score})),{majorList:h,outlierList:l}}},{key:"explainBySelection",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,a=n.map((function(e){return e.key})),o=n.map((function(e){return e.op})),u=this.getGeneralizeKNN("dimension",t,i,0),s=[],f=c(u);try{for(f.s();!(r=f.n()).done;){var h=r.value,l=this.engine.cube.getCuboid([h]),v=this.engine.cube.getCuboid([].concat(g(t),[h])),d=l.getState(a,o),p=m(v.getState(a,o),e),y=Ue(p,d,a,!1),b=We(y.normalizedData,y.normalizedParentData,[h],a);s.push({dimensions:[h],measures:n,score:b})}}catch(w){f.e(w)}finally{f.f()}return s.sort((function(e,t){return t.score-e.score})),s}},{key:"explainByCorMeasures",value:function(e,t,n){var r,i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,o=n.map((function(e){return e.key})),u=n.map((function(e){return e.op})),s=this.getGeneralizeKNN("measure",o,a),h=[].concat(g(o),g(s)),v=[],d=this.engine.cube.getCuboid(t),p=c(this.defaultAggs);try{var m=function(){var a,o=r.value,p=s.map((function(){return o})),m=Xe(d.getState(h,[].concat(g(u),g(p))),h),y=c(h);try{var b=function(){var r=a.value,u=n.find((function(e){return e.key===r}));if(u&&u.op===o)return"continue";for(var s=i.explainValue(e,t,[{key:r,op:o}]),h=[],p=0;p<s.length;p++)0!==s[p]&&h.push({key:r,op:o,score:s[p]});if(0===h.length)return"continue";if(u){var g,y=Xe(d.getState([r],[o]),[r]),b=m.map((function(e,t){return l(l({},e),{},f({},"__".concat(r),y[t][r]))})),w=0,M=1,S=c(n);try{for(S.s();!(g=S.n()).done;){var E=Be(b,0,g.value.key,"__".concat(r))/2;w=Math.max(w,E),M=Math.min(M,E)}}catch(N){S.e(N)}finally{S.f()}v.push({dimensions:t,score:Math.max(1-M,w),measures:[{key:r,op:o}],max:w,min:M,intMeasures:h})}else{var k,x=0,_=1,D=c(n);try{for(D.s();!(k=D.n()).done;){var O=k.value,T=Be(m,0,O.key,r)/2;x=Math.max(x,T),_=Math.min(_,T)}}catch(N){D.e(N)}finally{D.f()}v.push({dimensions:t,score:Math.max(1-_,x),measures:[{key:r,op:o}],max:x,min:_,intMeasures:h})}};for(y.s();!(a=y.n()).done;)b()}catch(w){y.e(w)}finally{y.f()}};for(p.s();!(r=p.n()).done;)m()}catch(y){p.e(y)}finally{p.f()}return v.sort((function(e,t){return t.score-e.score})),v}},{key:"getGeneralizeKNN",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return 0===t.length?this.getCenterFields(e,n):this.getKNN(e,t,n,r)}},{key:"getKNN",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o="dimension"===e?this.engine.dataGraph.DG:this.engine.dataGraph.MG,u="dimension"===e?this.engine.dataGraph.dimensions:this.engine.dataGraph.measures,s=t.map((function(e){return u.indexOf(e)})),f=[],h=c(s);try{for(h.s();!(n=h.n()).done;)for(var l=n.value,v=0;v<o[l].length;v++)s.includes(v)||function(){var e=Math.abs(o[l][v]),t=u[v],n=r.engine.fields.find((function(e){return e.key===t}));e>=a&&f.push({dis:e,index:v,imp:(null===n||void 0===n?void 0:n.domain.size)||1/0})}()}catch(d){h.e(d)}finally{h.f()}return f.sort((function(e,t){return t.dis/t.imp-e.dis/e.imp})),f.slice(0,i).map((function(e){return u[e.index]}))}},{key:"getCenterFields",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n="dimension"===e?this.engine.dataGraph.DG:this.engine.dataGraph.MG,r="dimension"===e?this.engine.dataGraph.dimensions:this.engine.dataGraph.measures,i=n.map((function(e,t){return{field:r[t],score:e.reduce((function(e,t){return e+Math.abs(t)}),0)}}));return i.sort((function(e,t){return t.score-e.score})),i.map((function(e){return e.field})).slice(0,t)}},{key:"getVisSpec",value:function(e){var t=this.engine;return e.map((function(e){var n,r=e.measures.map((function(e){return e.key})),i=e.extendMs.map((function(e){return e.key}));n="children_major_factor"===e.type||"children_outlier"===e.type?{dimensions:[].concat(g(e.extendDs),g(e.dimensions)),measures:i.length>0?i:r,significance:e.score,score:e.score,description:e.description}:{dimensions:e.extendDs.length>0?e.extendDs:e.dimensions,measures:i.length>0?i:r,significance:e.score,score:e.score,description:e.description};var a=[].concat(g(e.measures),g(e.extendMs));return{schema:t.specification(n).schema,dataView:t.cube.getCuboid([].concat(g(e.dimensions),g(e.extendDs))).getState(a.map((function(e){return e.key})),a.map((function(e){return e.op})))}}))}}]),e}();const $e={de:null};function Je(e){const{filters:t={},currentSpace:n}=e,r=function(e,t,n){var r=[];return t.forEach((function(t){r.push({type:"discrete",range:new Set(e[t]),key:t})})),r}(t,n.dimensions),i=$e.de,a=i.explain(r,n.dimensions,n.measures),o=i.getVisSpec(a),u=i.explainValue(r,n.dimensions,n.measures),s=[];for(let c=0;c<u.length;c++)0!==u[c]&&s.push({...n.measures[c],score:u[c]});return{explainations:a,visSpaces:o,valueExp:s,fieldsWithSemanticType:i.engine.fields.map((e=>({key:e.key,type:e.semanticType})))}}self.addEventListener("message",(function(e){const{type:t,data:n}=e.data;console.log(t,n);let r=!1;try{switch(t){case"getExplaination":r=Je(n);break;case"preAnalysis":r=function(e){const{dimensions:t,measures:n,dataSource:r}=e,i=new Ye(r);return i.setDimensions(t).setMeasures(n).preAnalysis(),$e.de=i,!0}(n);break;default:throw new Error(`type ${t} is not supported.`)}self.postMessage(r)}catch(i){console.log(i),self.postMessage(!1)}}),!1)}]);
//# sourceMappingURL=explainer.worker.4818409b.worker.js.map