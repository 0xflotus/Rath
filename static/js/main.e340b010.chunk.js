(self.webpackJsonpfrontend=self.webpackJsonpfrontend||[]).push([[0],{139:function(e,t,n){},146:function(e,t,n){e.exports=function(){return new Worker(n.p+"7d30fd3bf3047d027de2.worker.js")}},147:function(e,t,n){e.exports=function(){return new Worker(n.p+"6ebf17f13dfdd6fd3bd9.worker.js")}},148:function(e,t,n){e.exports=function(){return new Worker(n.p+"cb14984d24fb28d152f6.worker.js")}},149:function(e,t,n){e.exports=function(){return new Worker(n.p+"54f2ee6df56e4927ebe1.worker.js")}},150:function(e,t,n){e.exports=function(){return new Worker(n.p+"a052c681f648b70eb30e.worker.js")}},151:function(e,t,n){e.exports=function(){return new Worker(n.p+"bc74de91d580f3ba8252.worker.js")}},153:function(e,t){e.exports="data:image/png;base64,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"},154:function(e,t,n){e.exports=n.p+"static/media/rath-glasses.4a15bb11.png"},185:function(e,t,n){e.exports=n(307)},189:function(e,t,n){},191:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){},290:function(e,t){},291:function(e,t){},292:function(e,t){},293:function(e,t){},307:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"csvLoader",(function(){return X})),n.d(a,"jsonLoader",(function(){return W}));var r={};n.r(r),n.d(r,"transNumber",(function(){return V}));var i={};n.r(i),n.d(i,"kruskal",(function(){return Ge})),n.d(i,"kruskalWithFullMST",(function(){return ze}));var o={};n.r(o),n.d(o,"reservoirSampling",(function(){return Le})),n.d(o,"uniformSampling",(function(){return Re}));var c={};n.r(c),n.d(c,"simpleClean",(function(){return He})),n.d(c,"dropNull",(function(){return Ye})),n.d(c,"useMode",(function(){return Je})),n.d(c,"dropNullColumn",(function(){return Ue}));var s=n(0),u=n.n(s),l=n(28),d=n.n(l),f=(n(189),n(9)),m=n(2),p=n(70),g=n(7),v=n.n(g),h=n(24),y=n(146),b=n.n(y),x=n(147),E=n.n(x),A=n(148),S=n.n(A),w=n(149),k=n.n(w),O=n(150),j=n.n(O),C=n(151),N=n.n(C),M="//lobay.moe:8443";function B(e,t){return new Promise((function(n,a){e.postMessage(t),e.onmessage=function(e){n(e.data)},e.onerror=function(e){a({success:!1,message:e.error})}}))}function I(e,t,n){var a,r,i,o,c;return v.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(a=[],!n){s.next=21;break}return s.prev=2,s.next=5,v.a.awrap(fetch(M+"/api/service/fieldsSummary",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataSource:e,fields:t})}));case 5:return r=s.sent,s.next=8,v.a.awrap(r.json());case 8:if(!0!==(i=s.sent).success){s.next=13;break}a=i.data,s.next=14;break;case 13:throw new Error("[fields summary failed]"+i.message);case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(2),console.error(s.t0);case 19:s.next=31;break;case 21:return o=new k.a,s.next=24,v.a.awrap(B(o,{dataSource:e,fields:t}));case 24:if(!0!==(c=s.sent).success){s.next=29;break}a=c.data,s.next=30;break;case 29:throw new Error("[fields summary failed]"+c.message);case 30:o.terminate();case 31:return s.abrupt("return",a);case 32:case"end":return s.stop()}}),null,null,[[2,16]])}function D(e,t,n){var a,r,i,o,c;return v.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(a={groupedData:[],newFields:[],fields:[]},!n){s.next=21;break}return s.prev=2,s.next=5,v.a.awrap(fetch(M+"/api/service/groupFields",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataSource:e,fields:t})}));case 5:return r=s.sent,s.next=8,v.a.awrap(r.json());case 8:if(!0!==(i=s.sent).success){s.next=13;break}a=i.data,s.next=14;break;case 13:throw new Error("[group fields failed]"+i.message);case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(2),console.error(s.t0);case 19:s.next=31;break;case 21:return o=new j.a,s.next=24,v.a.awrap(B(o,{dataSource:e,fields:t}));case 24:if(!0!==(c=s.sent).success){s.next=29;break}a=c.data,s.next=30;break;case 29:throw new Error("[group fields failed]"+c.message);case 30:o.terminate();case 31:return s.abrupt("return",a);case 32:case"end":return s.stop()}}),null,null,[[2,16]])}function P(e,t,n,a,r){var i,o,c,s,u;return v.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(i=[],!r){l.next=21;break}return l.prev=2,l.next=5,v.a.awrap(fetch(M+"/api/service/combineFields",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataSource:e,dimensions:t,measures:n,operator:a})}));case 5:return o=l.sent,l.next=8,v.a.awrap(o.json());case 8:if(!0!==(c=l.sent).success){l.next=13;break}i=c.data,l.next=14;break;case 13:throw new Error("[combine fields failed]"+c.message);case 14:l.next=19;break;case 16:l.prev=16,l.t0=l.catch(2),console.error(l.t0);case 19:l.next=31;break;case 21:return s=new S.a,l.next=24,v.a.awrap(B(s,{dataSource:e,dimensions:t,measures:n,operator:a}));case 24:if(!0!==(u=l.sent).success){l.next=29;break}i=u.data,l.next=30;break;case 29:throw new Error("[combine fields failed]"+u.message);case 30:s.terminate();case 31:return l.abrupt("return",i);case 32:case"end":return l.stop()}}),null,null,[[2,16]])}function Q(e,t,n){var a,r,i,o,c;return v.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(a=[],!n){s.next=21;break}return s.prev=2,s.next=5,v.a.awrap(fetch(M+"/api/service/clusterMeasures",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({maxGroupNumber:e,spaces:t})}));case 5:return r=s.sent,s.next=8,v.a.awrap(r.json());case 8:if(!0!==(i=s.sent).success){s.next=13;break}a=i.data.map((function(e,t){return Object(h.a)({},e,{index:t})})),s.next=14;break;case 13:throw new Error("[cluster measures]"+i.message);case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(2),console.error(s.t0);case 19:s.next=31;break;case 21:return o=new E.a,s.next=24,v.a.awrap(B(o,{maxGroupNumber:e,spaces:t}));case 24:if(!0!==(c=s.sent).success){s.next=29;break}a=c.data.map((function(e,t){return Object(h.a)({},e,{index:t})})),s.next=30;break;case 29:throw new Error("[cluster measures]"+c.message);case 30:o.terminate();case 31:return s.abrupt("return",a);case 32:case"end":return s.stop()}}),null,null,[[2,16]])}function T(e,t,n,a,r){var i,o,c,s,u;return v.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(i=[],!r){l.next=21;break}return l.prev=2,l.next=5,v.a.awrap(fetch(M+"/api/service/generateDashBoard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataSource:e,dimensions:t,measures:n,subspaces:a})}));case 5:return o=l.sent,l.next=8,v.a.awrap(o.json());case 8:if(!(c=l.sent).success){l.next=13;break}i=c.data,l.next=14;break;case 13:throw new Error("[generateDashBoard]"+c.message);case 14:l.next=19;break;case 16:l.prev=16,l.t0=l.catch(2),console.error(l.t0);case 19:l.next=31;break;case 21:return s=new b.a,l.next=24,v.a.awrap(B(s,{dataSource:e,dimensions:t,measures:n,subspaces:a}));case 24:if(!(u=l.sent).success){l.next=29;break}i=u.data,l.next=30;break;case 29:throw new Error("[generateDashBoard]"+u.message);case 30:s.terminate();case 31:return l.abrupt("return",i);case 32:case"end":return l.stop()}}),null,null,[[2,16]])}var F=function(e,t,n){var a,r,i,o,c,s,u,l,d,f,m,p,g,h,y;return v.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:return a=n.dataSource,r=n.fields,i=e(),o=r.filter((function(e){return"dimension"===e.type})).map((function(e){return e.name})),c=r.filter((function(e){return"measure"===e.type})).map((function(e){return e.name})),b.prev=4,b.next=7,v.a.awrap(I(a,r.map((function(e){return e.name})),i.useServer));case 7:return s=b.sent,u=s?s.filter((function(e){return o.includes(e.fieldName)})).map((function(e){return{name:e.fieldName,type:e.type}})):[],b.next=11,v.a.awrap(D(a,u,i.useServer));case 11:return l=b.sent,f=(d=l||{groupedData:a,newFields:u}).groupedData,m=d.newFields,p=r.map((function(e){var t=m.find((function(t){return t.name===e.name+"(group)"}));return{name:t?t.name:e.name,type:e.type}})),g=p.filter((function(e){return"dimension"===e.type})).map((function(e){return e.name})),b.next=17,v.a.awrap(I(f,m,i.useServer));case 17:return h=b.sent,t((function(e){e.cookedDataSource=f,e.summary={origin:s||[],grouped:h||[]},e.loading.univariateSummary=!1})),y=(h||[]).concat(s||[]),b.abrupt("return",{groupedData:f,summary:y,newDimensions:g,measures:c});case 23:b.prev=23,b.t0=b.catch(4),t((function(e){e.loading.univariateSummary=!1}));case 26:case"end":return b.stop()}}),null,null,[[4,23]])},z=function(e,t,n){var a,r,i,o,c,s,u,l,d;return v.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:return a=n.groupedData,r=n.summary,i=n.dimensions,o=n.measures,c=n.operator,s=e(),t((function(e){e.loading.subspaceSearching=!0})),u=[],(u=i.map((function(e){var t=r.find((function(t){return t.fieldName===e}));return{name:e,entropy:t?t.entropy:1/0}}))).sort((function(e,t){return e.entropy-t.entropy})),t((function(e){e.cookedDimensions=u.map((function(e){return e.name})),e.cookedMeasures=o})),l=u.map((function(e){return e.name})).slice(0,Math.round(u.length*s.topK.dimensionSize)),f.prev=8,f.next=11,v.a.awrap(P(a,l,o,c,s.useServer));case 11:(d=f.sent)&&t((function(e){e.subspaceList=d})),t((function(e){e.loading.subspaceSearching=!1})),f.next=19;break;case 16:f.prev=16,f.t0=f.catch(8),t((function(e){e.loading.subspaceSearching=!1}));case 19:case"end":return f.stop()}}),null,null,[[8,16]])},G={univariateSummary:F,subspaceSearch:z,extractInsights:function(e,t,n){var a,r,i,o,c,s,u;return v.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return a=n.dataSource,r=n.fields,t((function(e){e.loading.gallery=!0})),l.prev=2,l.next=5,v.a.awrap(F(e,t,{dataSource:a,fields:r}));case 5:if(!(i=l.sent)){l.next=10;break}return o=i.groupedData,c=i.summary,s=i.newDimensions,u=i.measures,l.next=10,v.a.awrap(z(e,t,{groupedData:o,summary:c,dimensions:s,measures:u,operator:"sum"}));case 10:l.next=14;break;case 12:l.prev=12,l.t0=l.catch(2);case 14:return l.prev=14,t((function(e){e.loading.gallery=!1,e.loading.gallery=!1})),l.finish(14);case 17:case"end":return l.stop()}}),null,null,[[2,12,14,17]])},getDashBoard:function(e,t,n){var a,r,i,o,c;return v.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return a=e(),r=n.dataSource,i=n.dimensions,o=n.measures,t((function(e){e.loading.dashBoard=!0})),s.prev=3,s.next=6,v.a.awrap(T(r,i,o,a.subspaceList,a.useServer));case 6:c=s.sent,t((function(e){e.dashBoardList=c})),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(3),console.error(s.t0);case 13:return s.prev=13,t((function(e){e.loading.dashBoard=!1})),s.finish(13);case 16:case"end":return s.stop()}}),null,null,[[3,10,13,16]])},getViewSpaces:function(e,t,n){var a,r,i,o;return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.subspaceList,r=n.maxGroupNumber,i=n.useServer,o=[],e.prev=2,e.next=5,v.a.awrap(Q(r,a.map((function(e){return{dimensions:e.dimensions,measures:e.measures,matrix:e.correlationMatrix}})),i));case 5:o=e.sent,t((function(e){e.viewSpaces=o})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),null,null,[[2,9]])}};Object(p.b)(!1);var L={beCool:!1,currentPage:0,useServer:!1,fields:[],rawData:[],cookedDataSource:[],cookedDimensions:[],cookedMeasures:[],loading:{univariateSummary:!1,subspaceSearching:!1,gallery:!1,dashBoard:!1},topK:{subspacePercentSize:.3,dimensionSize:.72},maxGroupNumber:4,subspaceList:[],summary:{origin:[],grouped:[]},viewSpaces:[],dashBoardList:[]},R=Object(s.createContext)(null);function K(e){var t=e.children,n=Object(s.useState)(L),a=Object(f.a)(n,2),r=a[0],i=a[1],o=Object(s.useRef)(L),c=function(e){return{dimScores:Object(s.useMemo)((function(){return[].concat(Object(m.a)(e.summary.origin),Object(m.a)(e.summary.grouped)).map((function(e){return[e.fieldName,e.entropy,e.maxEntropy,{name:e.fieldName,type:e.type}]}))}),[e.summary])}}(r),l=Object(s.useCallback)((function(e){i((function(t){var n=Object(p.a)(t,(function(t){return e(t)}));return o.current=n,n}))}),[i]),d=Object(s.useCallback)((function(e,t){if("function"===typeof G[e]){G[e]((function(){return o.current}),l,t)}}),[l]);return u.a.createElement(R.Provider,{value:[r,l,d,c]},t)}function U(){return Object(s.useContext)(R)}var Y=n(354),q=n(170),J=n(152),H=n.n(J);function X(e){return new Promise((function(t,n){H.a.parse(e,{complete:function(e,n){var a=e.data,r=a[0],i=a.slice(1).map((function(e){var t={};return r.forEach((function(n,a){t[n]=e[a]})),t}));t(i)},error:function(e,t){n(e)}})}))}function W(e){return new Promise((function(t,n){var a=new FileReader;a.readAsText(e),a.onload=function(e){if(e.target)try{var a=JSON.parse(e.target.result);t(a)}catch(r){n(r)}else n(e)},a.onerror=n}))}function V(e){return isNaN(e)?null:Number(e)}function Z(e){var t=Object(s.useState)(e),n=Object(f.a)(t,2),a=n[0],r=n[1];return[a,Object(s.useCallback)((function(e){r((function(t){return Object(p.a)(t,(function(t){return e(t)}))}))}),[r])]}n(191);var _=n(153),$=n.n(_),ee=n(154),te=n.n(ee),ne=n(360),ae=n(366),re=n(355),ie=n(349),oe=n(176),ce=n(14),se=n(333),ue=n(352),le=n(22),de=n(357),fe=n(350),me=n(358),pe=function(){return{root:{marginTop:"10px"}}},ge=[{key:"sum",text:"Sum"},{key:"count",text:"Count"},{key:"mean",text:"Mean"}],ve=function(e){var t=e.show,n=void 0!==t&&t,a=e.onUpdateConfig,r=e.onClose,i=e.config,o=Object(s.useState)("sum"),c=Object(f.a)(o,2),l=c[0],d=c[1],m=Object(s.useState)(!0),p=Object(f.a)(m,2),g=p[0],v=p[1],h=Object(s.useState)(!0),y=Object(f.a)(h,2),b=y[0],x=y[1];Object(s.useEffect)((function(){var e=i.aggregator,t=i.defaultAggregated,n=i.defaultStack;d(e),v(t),x(n)}),[i,n]);return u.a.createElement(ue.a,{isOpen:n,type:le.a.smallFixedFar,onDismiss:r,headerText:"Preference",closeButtonAriaLabel:"Close",onRenderFooterContent:function(){return u.a.createElement("div",null,u.a.createElement(se.a,{onClick:function(){a({aggregator:l,defaultAggregated:g,defaultStack:b})}},"Save"))}},u.a.createElement(de.a,null,"Preference"),u.a.createElement(ie.a,{verticalFill:!0,tokens:{childrenGap:50,padding:6}},u.a.createElement(fe.a,{selectedKey:l,label:"Aggregator",allowFreeform:!0,autoComplete:"on",options:ge,onChange:function(e,t){t&&d(t.key)}}),u.a.createElement(me.a,{styles:pe,label:"measurement aggregation",checked:g,onChange:function(e,t){v(t||!1)}}),u.a.createElement(me.a,{styles:pe,label:"measurement stack",checked:b,onChange:function(e,t){x(t||!1)}})))},he=n(46),ye=n.n(he),be=n(31);function xe(e,t){console.log({query:e,fields:t});var n={},a=!0,r=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var s=o.value;n[s.name]=s}}catch(y){r=!0,i=y}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}function u(e){return n[e]?n[e].semanticType:"nominal"}function l(e,t){if("point"===t)return!1;var a=u(e);return"rect"===t?"quantitative"!==a:"quantitative"===a&&"measure"===function(e){return n[e]?n[e].type:"dimension"}(e)}var d=e.geomType[0]&&Se[e.geomType[0]]?Se[e.geomType[0]]:e.geomType[0],f=u(e.position[0]),m=u(e.position[1]),p=u(e.color[0]),g=l(e.position[0],d),v=l(e.position[1],d),h=e.color[0];return"rect"===d&&(e.color[0]&&"quantitative"!==p?d="point":e.opacity[0]&&e.size[0]&&(h=e.size[0]||e.opacity[0])),{data:{name:"dataSource"},autosize:{type:"pad"},mark:d,selection:{sl:{type:"bar"===d?"single":"interval",encodings:"bar"===d?["x"]:void 0}},encoding:{x:e.position[0]&&{field:e.position[0],type:u(e.position[0]),bin:"rect"===d&&"quantitative"===f&&{maxbins:20},aggregate:"rect"!==d&&g&&"sum"},y:e.position[1]&&{field:e.position[1],type:u(e.position[1]),bin:"rect"===d&&"quantitative"===m&&{maxbins:20},aggregate:"rect"!==d&&v&&"sum"},size:e.size[0]&&{field:e.size[0],type:u(e.size[0])},column:e.facets[0]&&{field:e.facets[0],type:u(e.facets[0])},row:e.facets[1]&&{field:e.facets[1],type:u(e.facets[1])},opacity:e.opacity[0]&&{field:e.opacity[0],type:u(e.opacity[0])},shape:e.shape[0]&&{field:e.shape[0],type:u(e.shape[0])},color:(h||"rect"===d)&&{field:h,aggregate:"rect"===d&&"quantitative"===u(h)&&(h?"sum":"count"),type:h&&u(h)}}}}function Ee(e,t){var n={},a=!0,r=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var s=o.value;n[s.name]=s}}catch(b){r=!0,i=b}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}function u(e){return n[e].semanticType||"nominal"}function l(e,t){if("point"===t)return!1;var a=u(e);return"rect"===t?"quantitative"!==a:"quantitative"===a&&"measure"===function(e){return n[e].type||"dimension"}(e)}var d=e.geomType[0]&&Se[e.geomType[0]]?Se[e.geomType[0]]:e.geomType[0],f=u(e.position[0]),m=u(e.position[1]),p=u(e.color[0]),g=l(e.position[0],d),v=l(e.position[1],d),h=[e.position[1]];e.highFacets&&(h=h.concat(e.highFacets.filter((function(e){return"quantitative"===u(e)}))));var y=e.color[0];return"rect"===d&&(e.color[0]&&"quantitative"!==p?d="point":e.opacity[0]&&e.size[0]&&(y=e.size[0]||e.opacity[0])),{config:{repeat:{columns:5}},data:{name:"dataSource"},autosize:{type:"pad"},repeat:h,spec:{mark:d,selection:{sl:{type:"bar"===d?"single":"interval",encodings:"bar"===d?["x"]:void 0}},encoding:{x:e.position[0]&&{field:e.position[0],type:u(e.position[0]),bin:"rect"===d&&"quantitative"===f&&{maxbins:20},aggregate:"rect"!==d&&g&&"sum"},y:h[0]&&{field:{repeat:"repeat"},type:u(h[0]),bin:"rect"===d&&"quantitative"===m&&{maxbins:20},aggregate:"rect"!==d&&v&&"sum"},size:e.size[0]&&{field:e.size[0],type:u(e.size[0])},opacity:e.opacity[0]&&{field:e.opacity[0],type:u(e.opacity[0])},shape:e.shape[0]&&{field:e.shape[0],type:u(e.shape[0])},color:(y||"rect"===d)&&{field:y,aggregate:"rect"===d&&"quantitative"===u(y)&&(y?"sum":"count"),type:y&&u(y)}}}}}var Ae={interval:"bar",line:"line",point:"point",density:"point"};var Se={interval:"bar",line:"line",point:"point",density:"rect"},we=function(e){var t=e.defaultAggregated,n=e.defaultStack,a=e.aggregator,r=e.dataSource,i=void 0===r?[]:r,o=e.dimensions,c=void 0===o?[]:o,l=e.measures,d=void 0===l?[]:l,f=e.schema,m=void 0===f?{}:f,p=e.fieldFeatures,g=void 0===p?[]:p,v=Object(s.useRef)(null),y=Object(s.useMemo)((function(){return d.map((function(e){return{op:a,field:e,as:"".concat(e,"_").concat(a)}}))}),[d,a]),b=Object(s.useMemo)((function(){return t?ye()({dataSource:i,dimensions:c,measures:d,operator:a,asFields:y.map((function(e){return e.as}))}):i}),[t,i,c,d,a,y]);return Object(s.useEffect)((function(){if(null!==v.current&&m.position&&m.position.length>0&&m.geomType&&m.geomType.length>0){var e=function(e,t,n,a,r,i,o,c){var s=e.position,u=void 0===s?[]:s,l=e.color,d=void 0===l?[]:l,f=e.size,m=void 0===f?[]:f,p=e.facets,g=void 0===p?[]:p,v=e.opacity,y=void 0===v?[]:v,b=e.geomType,x=void 0===b?[]:b,E=e.page,A=void 0===E?[]:E;function S(e){if(o&&a.includes(e)){var t=r.find((function(t){return t.field===e}));return t?t.as:e}return e}function w(e){var t=i.find((function(t){return t.name===e}));return t?t.type:"nominal"}var k={x:u[0],y:u[1],color:d[0],size:m[0],opacity:y[0],row:g[0],column:g[1]},O={width:600,data:{values:t}},j={width:600,mark:{type:x[0]&&Ae[x[0]]?Ae[x[0]]:x[0],tooltip:!0},encoding:{}};for(var C in k)k[C]&&(j.encoding[C]={field:S(k[C]),type:w(k[C])},["x","y"].includes(C)&&"quantitative"===w(k[C])&&!c&&(j.encoding[C].stack=null));if(c||0!==y.length||(j.encoding.opacity={value:.7}),0===A.length)O=Object(h.a)({},O,{},j);else if(A.length>0){j.transform=[{filter:{selection:"brush"}},o?{aggregate:r,groupby:n.filter((function(e){return e!==A[0]}))}:null].filter(Boolean);var N={width:600,mark:"tick",selection:{brush:{encodings:["x"],type:"interval"}},encoding:{x:{field:A[0],type:w(A[0])}}};O.vconcat=[j,N]}return O}(m,b,c,d,y,g,t,n);Object(be.a)(v.current,e)}}),[m,b,c,d,y,g,t,n]),u.a.createElement("div",{ref:v})},ke=n(6);function Oe(e){return JSON.parse(JSON.stringify(e))}function je(e,t){var n=new Map,a=!0,r=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var s=o.value[t];n.has(s)||n.set(s,0),n.set(s,n.get(s)+1)}}catch(u){r=!0,i=u}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}return Object(m.a)(n.entries())}function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Ne={interval:[0,10],line:[11,1/0],area:[11,1/0],point:[0,1e3],path:[0,100],density:[1001,1/0]};function Me(e,t){for(var n=t.length-1;n>=0;n--)if(t[n].type===e&&!t[n].choosen)return t[n];return!1}function Be(e){for(var t={},n={position:2,color:1,size:1,shape:1,opacity:1,facets:2,page:1,filter:1,highFacets:1e3},a=e.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){Object(ke.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{choosen:!1})})),r=[["quantitative",["position","size","color","highFacets","opacity","page","filter"]],["temporal",["position","page","filter"]],["ordinal",["position","color","opacity","facets","size","page","filter","highFacets"]],["nominal",["position","color","facets","shape","page","filter","hightFacets"]]],i=a.length,o=0;o<r.length&&i>0;o++)for(var c=r[o][0],s=r[o][1],u=0;u<s.length&&i>0;u++)for(var l=s[u],d=void 0;n[l]>0&&(d=Me(c,a));)"undefined"===typeof t[l]&&(t[l]=[]),t[l].push(d.name),n[l]--,i--,d.choosen=!0;return t}var Ie=function(e,t,n,a){var r=Be(e.sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[3]})));if(r.position&&2===r.position.length)if(n.includes(r.position[0])&&a.includes(r.position[1])||n.includes(r.position[1])&&a.includes(r.position[0])){var i=n.includes(r.position[0])?0:1,o=r.position[i],c=r.position[(i+1)%2];r.position=[o,c];var s=je(t,o);r.geomType=["interval","line","area"].filter((function(e){return s.length>=Ne[e][0]&&s.length<=Ne[e][1]}));var u=e.find((function(e){return e[0]===r.position[0]}))[3],l=e.find((function(e){return e[0]===r.position[1]}))[3];"nominal"!==u.type&&"nominal"!==l.type||(r.geomType=["interval"])}else r.geomType=["point","density"].filter((function(e){return t.length>=Ne[e][0]&&t.length<=Ne[e][1]}));return{schema:r,aggData:t}};n(4),n(5);function De(e){for(var t=[],n=0;n<e.length;n++)for(var a=n+1;a<e[n].length;a++)t.push([[n,a],Math.abs(e[n][a])]);return t}function Pe(e,t){return e[t]===t?t:e[t]=Pe(e,e[t])}function Qe(e,t,n){var a=Pe(e,t),r=Pe(e,n);e[a]=r,Pe(e,t),Pe(e,n)}function Te(e,t,n){return e[n]===n?n:(e[n]=Te(e,t,e[n]),t[n]=t[e[n]],e[n])}function Fe(e,t,n,a){var r=Te(e,t,n),i=Te(e,t,a),o=t[r],c=t[i];e[r]=i,t[r]=t[i]=o+c,Te(e,t,n),Te(e,t,a)}function ze(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=De(e);a.sort((function(e,t){return t[1]-e[1]}));var r=[],i=e.map((function(e,t){return t})),o=Object(m.a)(i),c=!1,s=!0,u=!1,l=void 0;try{for(var d,f=a[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var p=d.value;Pe(i,p[0][0])!==Pe(i,p[0][1])&&(Qe(i,p[0][0],p[0][1]),r.push([p[0],p[1],c]));for(var g=0;g<i.length;g++)i[g]=Pe(i,g);var v=new Set(i);if(v.size<=t||p[1]<n?c=!0:o=Object(m.a)(i),1===v.size)break}}catch(h){u=!0,l=h}finally{try{s||null==f.return||f.return()}finally{if(u)throw l}}return{edgesInMST:r,groups:o}}var Ge=function(e){var t,n=e.matrix,a=e.measures,r=(e.method,e.groupMaxSize),i=void 0===r?4:r,o=e.limitSize,c=void 0!==o&&o,s=e.threshold,u=void 0===s?0:s;t=c?function(e,t){var n=De(e);n.sort((function(e,t){return t[1]-e[1]}));var a=e.map((function(e,t){return t})),r=e.map((function(){return 1})),i=!0,o=!1,c=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if(Te(a,r,l[0][0])!==Te(a,r,l[0][1])){if(r[l[0][0]]+r[l[0][1]]>t)continue;Fe(a,r,l[0][0],l[0][1])}for(var d=0;d<a.length;d++)a[d]=Te(a,r,d);if(1===new Set(a).size)break}}catch(p){o=!0,c=p}finally{try{i||null==u.return||u.return()}finally{if(o)throw c}}for(var f=new Map,m=0;m<a.length;m++)f.has(a[m])||f.set(a[m],[]),f.get(a[m]).push(m);return f}(n,i):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=De(e);a.sort((function(e,t){return t[1]-e[1]}));var r=e.map((function(e,t){return t})),i=!0,o=!1,c=void 0;try{for(var s,u=a[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;Pe(r,l[0][0])!==Pe(r,l[0][1])&&Qe(r,l[0][0],l[0][1]);for(var d=0;d<r.length;d++)r[d]=Pe(r,d);var f=new Set(r);if(f.size<=t||l[1]<n)break}}catch(g){o=!0,c=g}finally{try{i||null==u.return||u.return()}finally{if(o)throw c}}for(var m=new Map,p=0;p<r.length;p++)m.has(r[p])||m.set(r[p],[]),m.get(r[p]).push(p);return m}(n,i,u);var l=[],d=!0,f=!1,m=void 0;try{for(var p,g=t.values()[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var v=p.value;l.push(v.map((function(e){return a[e]})))}}catch(h){f=!0,m=h}finally{try{d||null==g.return||g.return()}finally{if(f)throw m}}return l};n(11),n(8),n(10);function Le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if(e.length<=t)return e;for(var n=e.slice(0,t),a=e.length,r=t+1;r<a;r++){var i=Math.round(Math.random()*r);i<t&&(n[i]=e[r])}return n}function Re(e,t){for(var n=function(e,t){if(0===e)return[];for(var n=2147483647,a=[t],r=1;r<e;r++)a.push((1103515245*a[r-1]+12345)%n);return a.map((function(e){return e/n}))}(t,2147483647*Math.random()),a=[],r=0;r<t;r++){var i=Math.floor(n[r]*t)%t;a.push(e[i])}return a}var Ke;!function(e){e.outlier="default_outlier",e.cluster="default_group",e.trend="default_trend"}(Ke||(Ke={}));function Ue(e,t){var n=t.map((function(){return!1})),a=!0,r=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done);a=!0)for(var s=o.value,u=0;u<t.length;u++){var l=t[u];"undefined"!==typeof s[l]&&""!==s[l]&&null!==s[l]&&(n[u]=!0)}}catch(f){r=!0,i=f}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}var d=t.filter((function(e,t){return n[t]}));return{fields:d,dataSource:e.map((function(e){var t={},n=!0,a=!1,r=void 0;try{for(var i,o=d[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value;t[c]=e[c]}}catch(f){a=!0,r=f}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return t}))}}function Ye(e,t,n){var a=[],r=!0,i=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value,l=!0,d=!0,f=!1,m=void 0;try{for(var p,g=t[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var v=p.value;"undefined"!==typeof u[v]&&""!==u[v]&&null!==u[v]||(l=!1)}}catch(C){f=!0,m=C}finally{try{d||null==g.return||g.return()}finally{if(f)throw m}}var h=!0,y=!1,b=void 0;try{for(var x,E=n[Symbol.iterator]();!(h=(x=E.next()).done);h=!0){"number"!==typeof u[x.value]&&(l=!1)}}catch(C){y=!0,b=C}finally{try{h||null==E.return||E.return()}finally{if(y)throw b}}l&&a.push(u)}}catch(C){i=!0,o=C}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var A=!0,S=!1,w=void 0;try{for(var k,O=function(){var e=k.value;(function(e,t){return e.every((function(e){return!isNaN(e[t])||"undefined"===typeof e[t]||null===e[t]}))})(a,e)&&(je(a,e).length>20?a.forEach((function(t){t[e]=Number(t[e])||0})):a.forEach((function(t){t[e]=(Number(t[e])||0).toString()})))},j=t[Symbol.iterator]();!(A=(k=j.next()).done);A=!0)O()}catch(C){S=!0,w=C}finally{try{A||null==j.return||j.return()}finally{if(S)throw w}}return a}function qe(e){return["",null,void 0].includes(e)}function Je(e,t){var n=new Map,a=new Map,r=!0,i=!1,o=void 0;try{for(var c,s=t[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value;n.set(u,new Map),a.set(u,0)}}catch(W){i=!0,o=W}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var l=!0,d=!1,f=void 0;try{for(var p,g=e[Symbol.iterator]();!(l=(p=g.next()).done);l=!0){var v=p.value,h=!0,y=!1,b=void 0;try{for(var x,E=t[Symbol.iterator]();!(h=(x=E.next()).done);h=!0){var A=x.value,S=n.get(A);qe(v[A])||(S.has(v[A])||S.set(v[A],0),S.set(v[A],S.get(v[A])+1))}}catch(W){y=!0,b=W}finally{try{h||null==E.return||E.return()}finally{if(y)throw b}}}}catch(W){d=!0,f=W}finally{try{l||null==g.return||g.return()}finally{if(d)throw f}}var w=!0,k=!1,O=void 0;try{for(var j,C=n.keys()[Symbol.iterator]();!(w=(j=C.next()).done);w=!0){for(var N=j.value,M=n.get(N),B=Object(m.a)(M.entries()),I=0,D=0,P=0;P<B.length;P++){var Q=B[P];Q[1]>I&&(I=Q[1],D=P)}a.set(N,B[D][0])}}catch(W){k=!0,O=W}finally{try{w||null==C.return||C.return()}finally{if(k)throw O}}var T=Oe(e),F=!0,z=!1,G=void 0;try{for(var L,R=T[Symbol.iterator]();!(F=(L=R.next()).done);F=!0){var K=L.value,U=!0,Y=!1,q=void 0;try{for(var J,H=t[Symbol.iterator]();!(U=(J=H.next()).done);U=!0){var X=J.value;qe(K[X])&&(K[X]=a.get(X))}}catch(W){Y=!0,q=W}finally{try{U||null==H.return||H.return()}finally{if(Y)throw q}}}}catch(W){z=!0,G=W}finally{try{F||null==R.return||R.return()}finally{if(z)throw G}}return T}function He(e,t,n){var a=Oe(e),r=!0,i=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value,l=!0,d=!1,f=void 0;try{for(var m,p=t[Symbol.iterator]();!(l=(m=p.next()).done);l=!0){var g=m.value;qe(u[g])&&(u[g]="null")}}catch(A){d=!0,f=A}finally{try{l||null==p.return||p.return()}finally{if(d)throw f}}var v=!0,h=!1,y=void 0;try{for(var b,x=n[Symbol.iterator]();!(v=(b=x.next()).done);v=!0){var E=b.value;qe(u[E])&&(u[E]=0)}}catch(A){h=!0,y=A}finally{try{v||null==x.return||x.return()}finally{if(h)throw y}}}}catch(A){i=!0,o=A}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return a}var Xe=n(93),We=n.n(Xe),Ve=n(353),Ze=n(16),_e=(n(139),function(e){var t=e.space,n=e.dimensions,a=void 0===n?[]:n,r=e.measures,i=void 0===r?[]:r,o=e.dimScores,c=void 0===o?[]:o,l=e.spaceList,d=void 0===l?[]:l,p=e.schema,g=Object(s.useState)(!1),v=Object(f.a)(g,2),h=v[0],y=v[1],b=Object(s.useMemo)((function(){return Object(m.a)(c).sort((function(e,t){return e[1]-t[1]}))}),[c]),x=Object(s.useMemo)((function(){if("undefined"!==typeof t){var e=!0,n=!1,a=void 0;try{for(var r,i=d[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;if(o.dimensions.some((function(e){return t.dimensions.includes(e)})))return o.dimensions.find((function(e){return t.dimensions.includes(e)}))}}catch(c){n=!0,a=c}finally{try{e||null==i.return||i.return()}finally{if(n)throw a}}}}),[t,d]),E=Object(s.useMemo)((function(){if("undefined"!==typeof t){for(var e=t.measures.filter((function(e){return i.includes(e.name)})),n=1/0,a=0,r=0;r<e.length;r++)e[r].value<n&&(n=e[r].value,a=r);return e[a].name}}),[i,t]),A=Object(s.useMemo)((function(){var e=b.find((function(e){return a.includes(e[0])}));return e?e[0]:void 0}),[b,a]),S="\n  ".concat(p&&p.position?"Current chart mainly focus on the relationship between ***".concat(p.position[0],"*** and ***").concat(p.position[1],"***"):"","\n  ").concat(a.length>1?"+ DataSource is grouped by ***".concat(a.join(", "),"***, measures(indicators) will propose strong difference of distribution between each other."):"","\n  ").concat(i.length>1?"+ ***".concat(i.join(", "),"***are strongly related to each other"):"","\n  ").concat(A?"+ The distribution of member countings of ***".concat(A,"*** seems to contain more orders and patterns."):"","\n  ").concat(x?"+ ***".concat(x,"*** has great influence on aggregated measure values."):"","\n  ").concat(E?"+ ***".concat(E,"*** is more likely to have patterns according to its distribution."):"","\n  ``  ");return u.a.createElement("div",null,u.a.createElement(oe.a,{id:"vis-summary",text:"Summary",onClick:function(){y(!0)}}),h?u.a.createElement("div",null,u.a.createElement(Ve.a,{calloutProps:{directionalHint:Ze.a.bottomCenter},isWide:!0,hasCloseIcon:!0,closeButtonAriaLabel:"Close",target:"#vis-summary",onDismiss:function(){y(!1)},headline:"Chart Description"},u.a.createElement(We.a,{source:S}))):null)}),$e=function(e){var t=e.space,n=e.dimensions,a=void 0===n?[]:n,r=e.measures,i=void 0===r?[]:r,o=e.dimScores,c=void 0===o?[]:o,l=e.spaceList,d=void 0===l?[]:l,f=e.schema,p=Object(s.useMemo)((function(){return Object(m.a)(c).sort((function(e,t){return e[1]-t[1]}))}),[c]),g=Object(s.useMemo)((function(){if("undefined"!==typeof t){var e=!0,n=!1,a=void 0;try{for(var r,i=d[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;if(o.dimensions.some((function(e){return t.dimensions.includes(e)})))return o.dimensions.find((function(e){return t.dimensions.includes(e)}))}}catch(c){n=!0,a=c}finally{try{e||null==i.return||i.return()}finally{if(n)throw a}}}}),[t,d]),v=Object(s.useMemo)((function(){if("undefined"!==typeof t){for(var e=t.measures.filter((function(e){return i.includes(e.name)})),n=1/0,a=0,r=0;r<e.length;r++)e[r].value<n&&(n=e[r].value,a=r);return e[a].name}}),[i,t]),h=Object(s.useMemo)((function(){var e=p.find((function(e){return a.includes(e[0])}));return e?e[0]:void 0}),[p,a]),y="\n  ".concat(f&&f.position?"Current chart mainly focus on the relationship between ***".concat(f.position[0],"*** and ***").concat(f.position[1],"***"):"","\n  ").concat(a.length>1?"+ DataSource is grouped by ***".concat(a.join(", "),"***, measures(indicators) will propose strong difference of distribution between each other."):"","\n  ").concat(i.length>1?"+ ***".concat(i.join(", "),"***are strongly related to each other"):"","\n  ").concat(h?"+ The distribution of member countings of ***".concat(h,"*** seems to contain more orders and patterns."):"","\n  ").concat(g?"+ ***".concat(g,"*** has great influence on aggregated measure values."):"","\n  ").concat(v?"+ ***".concat(v,"*** is more likely to have patterns according to its distribution."):"","\n  ``  ");return u.a.createElement(We.a,{source:y})};function et(e,t){var n=new Set([].concat(Object(m.a)(e),Object(m.a)(t))),a=new Set(e),r=new Set(t),i=[],o=[],c=!0,s=!1,u=void 0;try{for(var l,d=n[Symbol.iterator]();!(c=(l=d.next()).done);c=!0){var f=l.value;i.push(Number(a.has(f))),o.push(Number(r.has(f)))}}catch(v){s=!0,u=v}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}for(var p=0,g=0;g<i.length;g++)p+=i[g]*o[g];return p/=Math.sqrt(e.length)*Math.sqrt(t.length)}var tt=function(e){var t=e.viewSpaces,n=e.interestedViewSpace,a=e.fieldScores,r=e.dataSource,i=Object(s.useMemo)((function(){var e=[],a=!0,r=!1,i=void 0;try{for(var o,c=function(){var t=o.value;t.dimensions.length>n.dimensions.length&&t.dimensions.length-n.dimensions.length<=2&&(n.dimensions.every((function(e){return t.dimensions.find((function(t){return e===t}))}))&&e.push(t))},s=t[Symbol.iterator]();!(a=(o=s.next()).done);a=!0)c()}catch(u){r=!0,i=u}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}return e}),[n,t]),o=Object(s.useMemo)((function(){var e=[],t=!0,a=!1,r=void 0;try{for(var o,c=i[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){var s=o.value,u=et(n.measures,s.measures);u>.2&&e.push(Object(h.a)({},s,{relatedScore:s.score/Math.sqrt(u)}))}}catch(l){a=!0,r=l}finally{try{t||null==c.return||c.return()}finally{if(a)throw r}}return e.sort((function(e,t){return e.relatedScore-t.relatedScore}))}),[i,n.measures]);return Object(s.useMemo)((function(){return o.slice(0,5).map((function(e){var t=a.filter((function(t){return e.dimensions.includes(t[0])||e.measures.includes(t[0])}));return Object(h.a)({},e,{schema:Ie(t,r,e.dimensions,e.measures).schema})}))}),[o,a,r])};var nt=function(e){var t=e.digDimensionProps,n=e.subspaceList,a=e.onSelectView,r=t.dataSource,i=t.visualConfig,o=t.fieldScores,c=tt(t),s=o.map((function(e){return e[3]}));return u.a.createElement("div",null,u.a.createElement("div",{className:"ms-Grid"},c.map((function(e,t){var c=n.find((function(t){return n=t.dimensions,a=e.dimensions,n.length===a.length&&n.every((function(e){return a.includes(e)}));var n,a}));return u.a.createElement("div",{key:"associate-row-".concat(t),className:"ms-Grid-row",style:{border:"solid 1px #bfbfbf",margin:"1em",padding:"1em"}},u.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md8 ms-lg9",style:{overflow:"auto"}},u.a.createElement(we,{aggregator:i.aggregator,defaultAggregated:!e.schema.geomType||!e.schema.geomType.includes("point"),defaultStack:i.defaultStack,dimensions:e.dimensions,measures:e.measures,dataSource:r,schema:e.schema,fieldFeatures:s})),u.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md4 ms-lg3",style:{fontSize:14,color:"#8a8886",overflow:"auto"}},u.a.createElement("div",null,u.a.createElement(ie.a,{tokens:{childrenGap:8},horizontal:!0},u.a.createElement(ae.a,{iconProps:{iconName:"Lightbulb"},title:"Interested",onClick:function(){a(e.index)}}))),c&&u.a.createElement($e,{dimensions:e.dimensions,measures:e.measures,dimScores:o,space:c,spaceList:n,schema:e.schema})))}))))},at=n(48),rt=n(359),it=n(167),ot=n.n(it),ct=n(49);function st(){var e=Object(at.a)(["\n  margin-right: 1rem;\n  cursor: pointer;\n  color: rgb(16, 110, 190);\n"]);return st=function(){return e},e}function ut(){var e=Object(at.a)(["\n  padding: 1rem;\n  overflow-x: auto;\n  margin: 1rem;\n"]);return ut=function(){return e},e}var lt=ct.a.div(ut()),dt=ct.a.a(st());var ft=function(e){var t=U(),n=Object(f.a)(t,4),a=n[0],r=n[2],i=n[3],o=Object(s.useState)([]),c=Object(f.a)(o,2),l=c[0],d=c[1],p=a.subspaceList,g=a.viewSpaces,v=a.maxGroupNumber,h=a.useServer,y=i.dimScores;Object(s.useEffect)((function(){r("getViewSpaces",{subspaceList:p,maxGroupNumber:v,useServer:h})}),[p,v,h,r]);var b=Object(s.useMemo)((function(){return new ot.a(g,{keys:["dimensions","measures"]})}),[g]),x=function(e){var t=Object(s.useState)(0),n=Object(f.a)(t,2),a=n[0],r=n[1];Object(s.useEffect)((function(){r(0)}),[e]);var i=Math.ceil(e/4),o=Math.max(a-2,0),c=Math.min(a+2,i),u=Object(s.useMemo)((function(){return[4*a,Math.min(4*(a+1),e)]}),[e,a]),l=Object(m.a)(new Array(c-o+1)).map((function(e,t){return o+t}));return{currentPage:a,visPageRange:l,itemRange:u,gotoPage:function(e){r((e+i)%i)},lastPage:function(){r((function(e){return(e+i-1)%i}))},nextPage:function(){r((function(e){return(e+i+1)%i}))}}}(l.length),E=x.currentPage,A=x.visPageRange,S=x.itemRange,w=x.gotoPage,k=x.lastPage,O=x.nextPage,j=Object(s.useMemo)((function(){return l.slice(S[0],S[1]).map((function(e){var t=e.dimensions,n=e.measures,r=y.filter((function(e){return t.includes(e[0])||n.includes(e[0])}));return{schema:Ie(r,a.cookedDataSource,t,n).schema,fieldFeatures:r.map((function(e){return e[3]})),aggData:a.cookedDataSource,dimensions:t,measures:n}}))}),[a.cookedDataSource,l,S,y]);return u.a.createElement("div",null,u.a.createElement(rt.a,{placeholder:"Search",onSearch:function(e){var t=b.search(e);d(t)},underlined:!0}),u.a.createElement("p",{className:"state-description"},l.length," results are found. current page is ",E+1),u.a.createElement("div",null,u.a.createElement(dt,{onClick:k},"Last Page"),l.length>0&&A.map((function(e){return u.a.createElement(dt,{key:"page-btn-".concat(e),onClick:function(){w(e)}},e+1)})),u.a.createElement(dt,{onClick:O},"Next Page")),u.a.createElement("div",null,j.map((function(e,t){return u.a.createElement(lt,{key:"result-".concat(t)},u.a.createElement(we,{aggregator:"sum",defaultAggregated:!0,defaultStack:!0,dimensions:e.dimensions,measures:e.measures,dataSource:e.aggData,schema:e.schema,fieldFeatures:e.fieldFeatures}))}))))},mt=["Rank List","Search"].map((function(e,t){return{title:e,itemKey:"pivot-"+t}})),pt=function(e){var t=e.dataSource,n=e.summary,a=e.subspaceList,r=Object(s.useState)(0),i=Object(f.a)(r,2),o=i[0],c=i[1],l=Object(s.useState)(mt[0].itemKey),d=Object(f.a)(l,2),p=d[0],g=d[1],v=U(),y=Object(f.a)(v,2),b=y[0],x=y[1],E=Z({show:{insightBoard:!1,fieldConfig:!1,configPanel:!1,dataConfig:!1}}),A=Object(f.a)(E,2),S=A[0],w=A[1],k=Object(s.useState)(!1),O=Object(f.a)(k,2),j=O[0],C=O[1],N=Object(s.useState)({aggregator:"sum",defaultAggregated:!0,defaultStack:!0}),M=Object(f.a)(N,2),B=M[0],I=M[1],D=Object(s.useState)([]),P=Object(f.a)(D,2),T=P[0],F=P[1],z=Object(s.useState)({schema:{position:[],color:[],opacity:[],geomType:[]},fieldFeatures:[],aggData:[],dimensions:[],measures:[]}),G=Object(f.a)(z,2),L=G[0],R=G[1],K=function(e){c(e)};Object(s.useEffect)((function(){x((function(e){e.loading.gallery=!0})),Q(b.maxGroupNumber,a.map((function(e){return{dimensions:e.dimensions,measures:e.measures,matrix:e.correlationMatrix}})),b.useServer).then((function(e){F(e),x((function(e){e.loading.gallery=!1}))}))}),[a,t,b.maxGroupNumber,b.useServer,x]);var J=Object(s.useMemo)((function(){return[].concat(Object(m.a)(n.origin),Object(m.a)(n.grouped)).map((function(e){return[e.fieldName,e.entropy,e.maxEntropy,{name:e.fieldName,type:e.type}]}))}),[n.origin,n.grouped]);Object(s.useEffect)((function(){var e=T[o];if(e){var n=e.dimensions,a=e.measures;try{var r=J.filter((function(e){return n.includes(e[0])||a.includes(e[0])})),i=Ie(r,t,n,a).schema;R({schema:i,fieldFeatures:r.map((function(e){return e[3]})),aggData:t,dimensions:n,measures:a}),i.geomType&&(i.geomType.includes("point")||i.geomType.includes("density"))?I((function(e){return Object(h.a)({},e,{defaultAggregated:!1})})):I((function(e){return Object(h.a)({},e,{defaultAggregated:!0})}))}catch(c){console.log(c)}}}),[T,o,t,J]);var H=Object(s.useMemo)((function(){return a.find((function(e){return e.dimensions.join(",")===L.dimensions.join(",")}))}),[a,L]);return Object(s.useEffect)((function(){C(!1)}),[o]),u.a.createElement("div",{className:"content-container"},u.a.createElement(ve,{show:S.show.configPanel,config:B,onUpdateConfig:function(e){I(e),w((function(e){e.show.configPanel=!1}))},onClose:function(){w((function(e){e.show.configPanel=!1}))}}),u.a.createElement("div",{className:"card",style:{paddingTop:"0.2rem"}},u.a.createElement(Y.a,{selectedKey:p,onLinkClick:function(e){e&&g(e.props.itemKey)}},mt.map((function(e){return u.a.createElement(q.a,{headerText:e.title,key:e.itemKey,itemKey:e.itemKey})}))),(b.loading.gallery||b.loading.subspaceSearching||b.loading.univariateSummary)&&u.a.createElement(ne.a,{description:"calculating"}),p===mt[0].itemKey&&u.a.createElement("div",null,u.a.createElement("h2",{style:{marginBottom:0}},"Visual Insights"," ",u.a.createElement(ae.a,{iconProps:{iconName:"Settings"},title:"Preference",ariaLabel:"preference",onClick:function(){w((function(e){e.show.configPanel=!0}))}}),u.a.createElement(ae.a,{iconProps:{iconName:"Lightbulb"},title:"Dig In",ariaLabel:"digIn",onClick:function(){C(!0)}})),u.a.createElement("p",{className:"state-description"},"Details of the recommendation process can be seen in"," ",u.a.createElement("b",null,"NoteBook")," Board. You can adjust some of the parameters and operators and see how it influence recommendation results."),u.a.createElement("p",{className:"state-description"},'Try to use the setting button beside the "visual insight" title to adjust the visualization settings to get a view you prefer better.'),u.a.createElement("div",{className:"ms-Grid",dir:"ltr"},u.a.createElement("div",{className:"ms-Grid-row"},u.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md8 ms-lg3",style:{overflow:"auto"}},u.a.createElement("div",{style:{marginBottom:"1rem"}},u.a.createElement(re.a,{label:"Current Page",value:(o+1).toString(),min:0,max:T.length,step:1,iconProps:{iconName:"Search"},labelPosition:ce.a.end,onValidate:function(e){K((Number(e)-1)%T.length)},onIncrement:function(){K((o+1)%T.length)},onDecrement:function(){K((o-1+T.length)%T.length)},incrementButtonAriaLabel:"Increase value by 1",decrementButtonAriaLabel:"Decrease value by 1"})),u.a.createElement("p",{className:"state-description"},"Page No. ",o+1," of ",T.length),u.a.createElement(ie.a,{horizontal:!0,tokens:{childrenGap:20}},u.a.createElement(oe.a,{text:"Last",onClick:function(){K((o-1+T.length)%T.length)},allowDisabledFocus:!0}),u.a.createElement(oe.a,{text:"Next",onClick:function(){K((o+1)%T.length)},allowDisabledFocus:!0})),u.a.createElement("h3",null,"Specification"),u.a.createElement("pre",null,JSON.stringify(L.schema,null,2)),u.a.createElement(_e,{dimensions:L.dimensions,measures:L.measures,dimScores:J,space:H,spaceList:a,schema:L.schema})),u.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md4 ms-lg9",style:{overflow:"auto"}},u.a.createElement(we,{aggregator:B.aggregator,defaultAggregated:B.defaultAggregated,defaultStack:B.defaultStack,dimensions:L.dimensions,measures:L.measures,dataSource:L.aggData,schema:L.schema,fieldFeatures:L.fieldFeatures}))))),p===mt[1].itemKey&&u.a.createElement(ft,null)),p===mt[0].itemKey&&j&&u.a.createElement("div",{className:"card"},u.a.createElement("h2",null," Related Views "),u.a.createElement(nt,{onSelectView:function(e){var t=T.findIndex((function(t){return t.index===e}));t>-1&&K(t)},subspaceList:a,digDimensionProps:{visualConfig:B,dataSource:t,viewSpaces:T,fieldScores:J,interestedViewSpace:T[o]}})))},gt=n(356),vt=n(347),ht=n(345),yt=n(34),bt=n(171),xt=n.n(bt),Et=n(175),At=function(e){var t=Object(s.useRef)(null),n=e.x,a=e.y,r=e.dataSource,i=e.fieldType;return Object(s.useEffect)((function(){if(t.current){var e=[],o=!1;e="ordinal"===i&&r.some((function(e){return/(\[|\()-?([0-9.]+|Infinity),\s*([0-9.]+|Infinity)(\]|\))/.test(e.memberName)}))?r.map((function(e){o=!0;var t=Object(Et.a)(/(\[|\()(\x2D?([\.0-9]+|Infinity)),[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([\.0-9]+|Infinity)(\]|\))/,{left:2}).exec(e.memberName);return Object(h.a)({},e,{index:null===t?e.name:Number(t.groups.left)})})):r;var c=void 0;"nominal"===i?c="-y":"ordinal"===i&&o&&(c={field:"index"}),Object(be.a)(t.current,{background:"#fff",data:{values:e},height:120,width:200,mark:["quantitative","temporal"].includes(i)?"line":"bar",encoding:{x:{field:n,axis:r.length>16?null:void 0,type:i,sort:c},y:{field:a,type:"quantitative",aggregate:"sum"}}},{actions:!1})}}),[n,a,r,i]),u.a.createElement("div",{ref:t})},St=(n(287),[{key:"fieldName",name:"fieldName",fieldName:"fieldName",minWidth:70,maxWidth:150},{key:"type",name:"type",fieldName:"type",minWidth:50},{key:"entropy",name:"entropy",fieldName:"entropy",minWidth:120},{key:"maxEntropy",name:"maxEntropy",fieldName:"maxEntropy",minWidth:120}]);function wt(e){switch(e){case"nominal":return"TextField";case"quantitative":return"NumberField";case"ordinal":return"Breadcrumb";case"temporal":return"EventDate";default:return""}}var kt=function(e){var t=e.originSummary,n=e.groupedSummary,a=Object(s.useMemo)((function(){var e=t.map((function(e){return e.maxEntropy}));return[0,Math.max.apply(Math,Object(m.a)(e))]}),[t]),r=function(e){return u.a.createElement("div",{className:"field-hover-card"},u.a.createElement("h2",null,e.fieldName),u.a.createElement("div",null,"Field entropy is ",Number(e.entropy).toFixed(2)),u.a.createElement("div",{className:"chart-vertical-margin-container"},u.a.createElement(At,{x:"memberName",y:"count",fieldType:e.type,dataSource:e.distribution})))},i=function(e){var t=e.fieldName,a=n.find((function(e){return e.fieldName===t+"(group)"}));return u.a.createElement("div",{className:"field-hover-card"},a?u.a.createElement("div",null,u.a.createElement("h3",null,a.fieldName),u.a.createElement("div",null,"Field entropy is ",Number(a.entropy).toFixed(2)),u.a.createElement("div",{className:"chart-vertical-margin-container"},u.a.createElement(At,{x:"memberName",y:"count",fieldType:a.type,dataSource:a.distribution}))):u.a.createElement("div",null,"This field is not grouped."))};return u.a.createElement(ht.a,{compact:!0,columns:St,items:t,selectionMode:yt.b.none,onRenderItemColumn:function(e,t,o){if(void 0!==o){var c=e.fieldName,s=n.find((function(e){return e.fieldName===c+"(group)"})),l={onRenderCompactCard:r,onRenderExpandedCard:i,renderData:e,compactCardHeight:320,expandedCardHeight:s?320:40},d=e[o.fieldName],f=[255,255,255];switch(o.key){case"type":return u.a.createElement("div",null,u.a.createElement(gt.a,{iconName:wt(d)})," ",d);case"entropy":case"maxEntropy":v=e[o.key],h=a,f=xt.a.scale("YlGnBu").domain([h[1],h[0]])(v).rgb();var m="rgb(".concat(f.join(","),")"),p="rgb(".concat((g=f,(.299*g[0]+.587*g[1]+.114*g[2])/255>.5?[0,0,0]:[255,255,255]).join(","),")");return u.a.createElement(vt.a,{expandedCardOpenDelay:800,expandingCardProps:l,instantOpenOnClick:!0},u.a.createElement("div",{style:{boxShadow:"".concat(m," 0px 0px 0px 10px"),backgroundColor:m,color:p}},d));default:return u.a.createElement(vt.a,{expandedCardOpenDelay:800,expandingCardProps:l,instantOpenOnClick:!0},u.a.createElement("div",null,d))}}var g,v,h}})};function Ot(e){return e.join(",")}var jt=function(e){var t=e.subspaceList,n=e.onSpaceChange,a=Object(s.useState)(0),r=Object(f.a)(a,2),i=r[0],o=r[1],c=Object(s.useRef)(null),l=Object(s.useRef)(null);Object(s.useEffect)((function(){var e=t.length-1;if(e>-1){var a=t[e];n(a.dimensions,a.measures.map((function(e){return e.name})),a.correlationMatrix),o(e)}}),[t,n]);var d=Object(s.useMemo)((function(){for(var e=[],n=0;n<t.length;n++){var a=t[n],r=Ot(a.dimensions),i=!0,o=!1,c=void 0;try{for(var s,u=a.measures[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,d=l.name,f=l.value,m={test:n,score:a.score,dimensions:r,measureName:d,measureValue:f};e.push(m)}}catch(p){o=!0,c=p}finally{try{i||null==u.return||u.return()}finally{if(o)throw c}}}return e}),[t]);return Object(s.useEffect)((function(){c.current&&t.length>0&&Object(be.a)(c.current,{data:{values:d},vconcat:[{mark:"rect",selection:{dim:{type:"single",on:"click",encodings:["y"]}},encoding:{x:{field:"measureName",type:"nominal"},y:{field:"dimensions",type:"ordinal",sort:{field:"score"}},color:{field:"measureValue",type:"quantitative",aggregate:"mean",scale:{reverse:!0}},opacity:{condition:{selection:"dim",value:1},value:.72}}}]}).then((function(e){e.view.addEventListener("click",(function(e,a){if(a){var r=a.datum,i=t.findIndex((function(e){return Ot(e.dimensions)===r.dimensions}));if(i>-1){var c=t[i];n(c.dimensions,c.measures.map((function(e){return e.name})),c.correlationMatrix),o(i)}}}))}))}),[t,d]),Object(s.useEffect)((function(){var e=t[i];if(l.current&&t.length>0&&e){for(var n=[],a=0;a<e.correlationMatrix.length;a++)for(var r=0;r<e.correlationMatrix[a].length;r++)n.push({x:e.measures[a].name,y:e.measures[r].name,correlation:e.correlationMatrix[a][r]});Object(be.a)(l.current,{data:{values:n},mark:"rect",encoding:{x:{field:"x",type:"nominal"},y:{field:"y",type:"nominal"},color:{field:"correlation",type:"quantitative",aggregate:"mean",scale:{scheme:"redyellowgreen",domain:[-1,1]}}}})}}),[t,i]),u.a.createElement("div",null,u.a.createElement("div",{ref:c}),u.a.createElement("div",{ref:l}))},Ct=function(e){var t=e.adjMatrix,n=e.measures,a=e.onFocusGroup,r=U(),o=Object(f.a)(r,1)[0],c=Object(s.useRef)(null),l=Object(s.useMemo)((function(){var e=i.kruskalWithFullMST(t,o.maxGroupNumber);return{edgesInMST:e.edgesInMST,groups:e.groups}}),[t,o.maxGroupNumber]),d=Object(s.useMemo)((function(){for(var e=l.edgesInMST,t=l.groups,a=e.map((function(e){return{source:e[0][0],target:e[0][1],value:1/e[1],inCutEdge:e[2]}})),r=[],i=0;i<t.length;i++)r.push({name:n[i],index:i,value:1,group:t[i]});return{nodes:r,edges:a}}),[n,l]);return Object(s.useEffect)((function(){c.current&&n.length>0&&Object(be.a)(c.current,{$schema:"https://vega.github.io/schema/vega/v5.json",width:700,height:500,padding:0,autosize:"none",signals:[{name:"cx",update:"width / 2"},{name:"cy",update:"height / 2"},{description:"State variable for active node fix status.",name:"fix",value:!1,on:[{events:"text:mouseout[!event.buttons], window:mouseup",update:"false"},{events:"text:mouseover",update:"fix || true"},{events:"[text:mousedown, window:mouseup] > window:mousemove!",update:"xy()",force:!0}]},{description:"Graph node most recently interacted with.",name:"node",value:null,on:[{events:"text:mouseover",update:"fix === true ? item() : node"}]},{description:"Flag to restart Force simulation upon data changes.",name:"restart",value:!1,on:[{events:{signal:"fix"},update:"fix && fix.length"}]}],data:[{name:"node-data",values:d.nodes},{name:"link-data",values:d.edges}],scales:[{name:"color",type:"ordinal",domain:{data:"node-data",field:"group"},range:{scheme:"tableau20"}},{name:"colorEdge",type:"quantize",domain:{data:"link-data",field:"value"},range:{scheme:"viridis"}}],marks:[{name:"nodes",type:"text",zindex:1,from:{data:"node-data"},on:[{trigger:"fix",modify:"node",values:"fix === true ? {fx: node.x, fy: node.y} : {fx: fix[0], fy: fix[1]}"},{trigger:"!fix",modify:"node",values:"{fx: null, fy: null}"}],encode:{enter:{fill:{scale:"color",field:"group"},text:{field:"name"},fontSize:{value:14},fontWeight:{value:600}},update:{cursor:{value:"pointer"}}},transform:[{type:"force",iterations:300,restart:{signal:"restart"},signal:"force",forces:[{force:"center",x:{signal:"cx"},y:{signal:"cy"}},{force:"collide"},{force:"nbody"},{force:"link",links:"link-data"}]}]},{type:"path",from:{data:"link-data"},interactive:!1,encode:{update:{stroke:{scale:"colorEdge",field:"value"},strokeWidth:{value:.8},opacity:{value:.5}}},transform:[{type:"linkpath",require:{signal:"force"},shape:"line",sourceX:"datum.source.x",sourceY:"datum.source.y",targetX:"datum.target.x",targetY:"datum.target.y"}]}]}).then((function(e){e.view.addEventListener("click",(function(e,t){if(t){var r=t.datum.group,i=n.filter((function(e,t){return l.groups[t]===r}));a(i)}}))}))}),[d,n,l.groups,a]),u.a.createElement("div",{ref:c})},Nt=n(361),Mt=n(362),Bt=(n(288),function(e){var t=e.summary,n=e.subspaceList,a=e.dataSource,r=U(),i=Object(f.a)(r,2),o=i[0],c=i[1],l=Object(s.useState)(!0),d=Object(f.a)(l,2),p=d[0],g=d[1],v=Object(s.useState)({measures:[],dimensions:[],matrix:[]}),h=Object(f.a)(v,2),y=h[0],b=h[1],x=Object(s.useState)([]),E=Object(f.a)(x,2),A=E[0],S=E[1],w=Object(s.useMemo)((function(){return[].concat(Object(m.a)(t.origin),Object(m.a)(t.grouped)).map((function(e){return[e.fieldName,e.entropy,e.maxEntropy,{name:e.fieldName,type:e.type}]}))}),[t.origin,t.grouped]),k=Object(s.useMemo)((function(){var e=y.dimensions;try{var t=w.filter((function(t){return e.includes(t[0])||A.includes(t[0])}));return Ie(t,a,e,A).schema}catch(n){return console.log(n),{position:[]}}}),[w,y,a,A]),O=Object(s.useMemo)((function(){return n.slice(0,Math.round(n.length*o.topK.subspacePercentSize))}),[n,o.topK.subspacePercentSize]);Object(s.useEffect)((function(){c((function(e){e.maxGroupNumber=Math.round(o.cookedMeasures.length/4)}))}),[o.cookedMeasures,c]);var j=Object(s.useCallback)((function(e,t,n){b({dimensions:e,measures:t,matrix:n})}),[b]),C=Object(s.useCallback)((function(e){S(e)}),[]);return u.a.createElement("div",null,u.a.createElement("h3",{className:"notebook header"},"Univariate Summary"),u.a.createElement("p",{className:"state-description"},"Hover your mouse over the fields and see the distails and entropy reducing strategy."),o.loading.univariateSummary&&u.a.createElement(ne.a,{description:"analyzing"}),u.a.createElement("div",{className:"notebook content container"},u.a.createElement(kt,{originSummary:t.origin,groupedSummary:t.grouped})),u.a.createElement("h3",{className:"notebook header"},"Subspace Searching"),u.a.createElement("p",{className:"state-description"},"Try to choose one row(combination of dimensions) of the subspace and see the changes of the processes below."),o.loading.subspaceSearching&&u.a.createElement(ne.a,{description:"analyzing"}),!o.loading.univariateSummary&&u.a.createElement(Nt.a,{disabled:o.loading.subspaceSearching,value:100*o.topK.dimensionSize,label:"top k percent dimension used",max:100,valueFormat:function(e){return"".concat(e,"%")},showValue:!0,onChange:function(e){c((function(t){t.topK.dimensionSize=e/100,t.loading.subspaceSearching=!0}));var t=o.cookedDimensions.slice(0,Math.round(o.cookedDimensions.length*e/100));P(a,t,o.cookedMeasures,"sum",o.useServer).then((function(e){e&&c((function(t){t.subspaceList=e,t.loading.subspaceSearching=!1}))}))}}),!o.loading.univariateSummary&&u.a.createElement(Nt.a,{disabled:o.loading.subspaceSearching,value:100*o.topK.subspacePercentSize,label:"top k percent subspace used",max:100,valueFormat:function(e){return"".concat(e,"%")},showValue:!0,onChange:function(e){c((function(t){t.topK.subspacePercentSize=e/100}))}}),u.a.createElement("div",{className:"notebook content center container"},u.a.createElement(jt,{subspaceList:O,onSpaceChange:j})),u.a.createElement("h3",{className:"notebook header"},"Measurement Clustering"),u.a.createElement("p",{className:"state-description"},"Try to choose one group to visualize them."),u.a.createElement(Nt.a,{label:"Max Group Number",min:1,max:o.cookedMeasures.length||4,step:1,value:o.maxGroupNumber,showValue:!0,onChange:function(e){c((function(t){t.maxGroupNumber=e}))}}),u.a.createElement("div",{className:"notebook content center container"},u.a.createElement(Ct,{adjMatrix:y.matrix,measures:y.measures,onFocusGroup:C})),u.a.createElement("h3",{className:"notebook header"},"Visualization"),u.a.createElement("p",{className:"state-description"},"If there is no result here, try to click one group of measures in"," ",u.a.createElement("b",null,"Clustering")," process above."),u.a.createElement(Mt.a,{checked:p,label:"aggregate measures",defaultChecked:!0,onText:"On",offText:"Off",onChange:function(e,t){g(!!t)}}),u.a.createElement("div",{className:"notebook content center container"},u.a.createElement(we,{defaultAggregated:p,defaultStack:!0,aggregator:"sum",schema:k,fieldFeatures:w.map((function(e){return e[3]})),dataSource:a,dimensions:y.dimensions,measures:A})))}),It=n(174),Dt=n(351),Pt=n(346),Qt=function(e){var t=e.dataSource,n=void 0===t?[]:t,a=e.fields,r=(void 0===a?[]:a).map((function(e){return{key:e.name,name:e.name,fieldName:e.name,minWidth:70,maxHeight:90}}));return u.a.createElement("div",{style:{maxHeight:400,overflow:"auto"}},u.a.createElement(ht.a,{items:n,columns:r,selectionMode:yt.b.none}))},Tt=function(e){var t=e.show,n=void 0!==t&&t,a=e.onUpdateConfig,r=e.onClose,i=Object(s.useState)([]),o=Object(f.a)(i,2),c=o[0],l=o[1];Object(s.useEffect)((function(){l(e.fields)}),[e.fields]);return u.a.createElement(ue.a,{isOpen:n,type:le.a.smallFixedFar,onDismiss:r,headerText:"Meta Config",closeButtonAriaLabel:"Close",onRenderFooterContent:function(){return u.a.createElement("div",null,u.a.createElement(se.a,{onClick:function(){a(c),r()}},"Save"))}},u.a.createElement("div",null,c.map((function(e){return u.a.createElement(Mt.a,{key:e.name,checked:"dimension"===e.type,label:e.name,onText:"dimension",offText:"measure",onChange:function(t,n){!function(e,t){l((function(n){return n.map((function(n){return e.name===n.name?{name:e.name,type:t}:n}))}))}(e,n?"dimension":"measure")}})}))))};var Ft=[{key:"dropNull",text:"drop null records"},{key:"useMode",text:"replace null with mode"},{key:"simpleClean",text:"simple cleaning"}];function zt(e,t,n){var a=Object(s.useMemo)((function(){return t.filter((function(e){return"dimension"===e.type})).map((function(e){return e.name}))}),[t]),i=Object(s.useMemo)((function(){return t.filter((function(e){return"measure"===e.type})).map((function(e){return e.name}))}),[t]),o=Object(s.useMemo)((function(){return e.map((function(e){var n={};return t.forEach((function(t){n[t.name]="dimension"===t.type?e[t.name]:r.transNumber(e[t.name])})),n}))}),[e,t]),u=Object(s.useMemo)((function(){return function(e,t,n,a){switch(a){case"dropNull":return c.dropNull(e,t,n);case"useMode":return c.useMode(e,t.concat(n));case"simpleClean":default:return c.simpleClean(e,t,n)}}(function(e){return JSON.parse(JSON.stringify(e))}(o),a,i,n)}),[a,i,o,n]);return[o,u]}var Gt,Lt=n(344);!function(e){e.none="none",e.reservoir="reservoir"}(Gt||(Gt={}));var Rt=[{key:Gt.none,text:"none"},{key:Gt.reservoir,text:"reservoir"}],Kt=function(e){var t=U(),n=Object(f.a)(t,3),r=n[0],i=n[1],l=n[2],d=Z({show:{insightBoard:!1,fieldConfig:!1,configPanel:!1,dataConfig:!1}}),m=Object(f.a)(d,2),p=m[0],g=m[1],h=Object(s.useState)("dropNull"),y=Object(f.a)(h,2),b=y[0],x=y[1],E=Object(s.useState)(!0),A=Object(f.a)(E,2),S=A[0],w=A[1],k=Object(s.useState)(Gt.none),O=Object(f.a)(k,2),j=O[0],C=O[1],N=Object(s.useState)(.2),M=Object(f.a)(N,2),B=M[0],I=M[1],D=Object(s.useRef)(null),P=Object(s.useRef)(null),Q=zt(r.rawData,r.fields,b),T=Object(f.a)(Q,2),F=T[0],z=T[1],G=Object(Lt.a)("labelElement");var L=[{key:"upload",name:"Upload",iconProps:{iconName:"Upload"},onClick:function(){P.current&&P.current.click()}}];return u.a.createElement("div",{className:"content-container"},u.a.createElement(Tt,{fields:r.fields,show:p.show.fieldConfig,onUpdateConfig:function(e){i((function(t){t.fields=e}))},onClose:function(){g((function(e){e.show.fieldConfig=!1}))}}),u.a.createElement("div",{className:"card"},u.a.createElement(ie.a,{horizontal:!0},u.a.createElement(se.a,{disabled:0===F.length,iconProps:{iconName:"Financial"},text:"Extract Insights",onClick:function(){l("extractInsights",{dataSource:z,fields:r.fields}),e.onExtractInsights()}}),u.a.createElement("div",{ref:D},u.a.createElement(ae.a,{iconProps:{iconName:"ExcelDocument"},title:"Upload",ariaLabel:"upload data",onClick:function(){g((function(e){e.show.dataConfig=!0}))}}),u.a.createElement(It.a,{style:{maxWidth:300},className:"vi-callout-callout",role:"alertdialog",gapSpace:0,target:D.current,onDismiss:function(){g((function(e){e.show.dataConfig=!1}))},setInitialFocus:!0,hidden:!p.show.dataConfig},u.a.createElement("div",{className:"vi-callout-header"},u.a.createElement("p",{className:"vi-callout-title"},"Upload Your own dataset")),u.a.createElement("div",{className:"vi-callout-inner"},u.a.createElement("div",{className:"vi-callout-content"},u.a.createElement("p",{className:"vi-callout-subTex"},".csv, .json are supportted.")),u.a.createElement("div",null,u.a.createElement(me.a,{label:"Add unique ids for fields",checked:S,onChange:function(e,t){w(!!t)}}),u.a.createElement(de.a,{id:G,required:!0},"Sampling"),u.a.createElement(Dt.a,{defaultSelectedKey:"B",options:Rt,selectedKey:j,onChange:function(e,t){t&&C(t.key)},ariaLabelledBy:G}),j!==Gt.none&&u.a.createElement(Nt.a,{label:"sample size(percent)",min:0,max:1,step:.001,value:B,showValue:!0,valueFormat:function(e){return"".concat((100*e).toFixed(1),"%")},onChange:function(e){I(e)}})),u.a.createElement("div",{className:"vi-callout-actions"},u.a.createElement("input",{type:"file",ref:P,multiple:!0,accept:"*",style:{display:"none"},onChange:function(){var e,t,n,r;return v.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(null===P.current||null===P.current.files){s.next=24;break}if(e=P.current.files[0],t=[],n=[],"text/csv"!==e.type&&"application/vnd.ms-excel"!==e.type){s.next=10;break}return s.next=7,v.a.awrap(a.csvLoader(e));case 7:n=s.sent,s.next=17;break;case 10:if("application/json"!==e.type){s.next=16;break}return s.next=13,v.a.awrap(a.jsonLoader(e));case 13:n=s.sent,s.next=17;break;case 16:throw new Error("unsupported file type=".concat(e.type," "));case 17:j===Gt.reservoir&&(n=o.reservoirSampling(n,Math.round(n.length*B))),n=c.dropNullColumn(n,Object.keys(n[0])).dataSource,r=Object.keys(n[0]),t=r.map((function(e,t){return{name:e,type:n.every((function(t){return!isNaN(t[e])||void 0===t[e]}))?"measure":"dimension"}})),S&&(t.forEach((function(e,t){e.name="".concat(e.name,"-rid-").concat(t)})),n=n.map((function(e){for(var n={},a=0;a<r.length;a++)n[t[a].name]=e[r[a]];return n}))),i((function(e){e.fields=t,e.rawData=n})),g((function(e){e.show.dataConfig=!1}));case 24:case"end":return s.stop()}}))}}),u.a.createElement(Pt.a,{overflowButtonProps:{name:"More"},items:L}))))),u.a.createElement(ae.a,{iconProps:{iconName:"Settings"},title:"Field Setting",ariaLabel:"field setting",onClick:function(){g((function(e){e.show.fieldConfig=!0}))}})),u.a.createElement("div",{style:{margin:"20px 0px"}},u.a.createElement(fe.a,{styles:{root:{maxWidth:"180px"}},selectedKey:b,label:"Clean Method",allowFreeform:!0,autoComplete:"on",options:Ft,onChange:function(e,t){t&&x(t.key)}})),u.a.createElement("p",{style:{fontSize:12,fontWeight:400,color:"#595959"}},"Remember to adjust the fields' types and cleaning strategy before extracting insights."),u.a.createElement("i",{style:{fontSize:12,fontWeight:300,color:"#595959"}},"Number of records ",z.length),u.a.createElement(Qt,{fields:r.fields,dataSource:z})))},Ut=n(363),Yt=n(172),qt=n.n(Yt);function Jt(){var e=Object(at.a)(["\n  display: inline-block;\n  padding: 1rem;\n  border: 1px solid #f5f5f5;\n  margin: 1rem;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB',\n  'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif, 'Apple Color Emoji',\n  'Segoe UI Emoji', 'Segoe UI Symbol';\n  .indicator-card.header {\n    color: #8c8c8c;\n    margin-top: 0px;\n    margin-bottom: 0px;\n    font-size: 20px;\n    line-height: 28px;\n    font-weight: 400;\n  }\n  .indicator-card.content {\n    color: #0078d4;\n    font-size: 56px;\n    line-height: 64px;\n    font-weight: 400;\n    margin: 0px;\n  }\n"]);return Jt=function(){return e},e}var Ht=ct.a.div(Jt()),Xt=function(e){var t=e.dataSource,n=void 0===t?[]:t,a=e.measures,r=void 0===a?[]:a,i=e.operator,o=void 0===i?"sum":i,c=Object(s.useMemo)((function(){if(0===r.length||0===n.length)return"-";var e=0;try{e=qt.a[o](n.map((function(e){return e[r[0]]})))}catch(t){console.log("operator does not exist or not in vega/datalib.")}return Math.abs(e-Math.round(e))>1e-5&&(e=Number(e.toFixed(2))),function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}(e)}),[n,r,o]);return u.a.createElement(Ht,null,u.a.createElement("h4",{className:"indicator-card header"},r[0]," ",o&&"(".concat(o,")")),u.a.createElement("h1",{className:"indicator-card content"},c))},Wt=function(e){var t=e.spec,n=e.dataSource,a=e.signalHandler,r=void 0===a?{}:a,i=Object(s.useRef)(null),o=Object(s.useState)(),c=Object(f.a)(o,2),l=c[0],d=c[1];return Object(s.useEffect)((function(){i.current&&Object(be.a)(i.current,t).then((function(e){d(e.view)}))}),[t]),Object(s.useEffect)((function(){if(l&&r)for(var e in r)l.addSignalListener("sl",r[e]);return function(){if(l&&r)for(var e in r)l.removeSignalListener("sl",r[e])}}),[l,r]),Object(s.useEffect)((function(){l&&l.change("dataSource",be.b.changeset().remove((function(){return!0})).insert(n)),l&&l.resize(),l&&l.runAsync()}),[l,n]),u.a.createElement("div",{ref:i})},Vt=function(e){var t=e.dashBoard,n=void 0===t?[]:t,a=e.dataSource,r=void 0===a?[]:a,i=e.dimScores,o=void 0===i?[]:i,c=Z({}),l=Object(f.a)(c,2),d=l[0],p=l[1],g=Object(s.useState)([]),v=Object(f.a)(g,2),h=v[0],y=v[1];Object(s.useEffect)((function(){y(n.map((function(){return!1})))}),[n]);var b=Object(s.useMemo)((function(){return n&&r&&o?n.map((function(e){var t=e.dimensions,n=e.measures,a=e.type,i=o.filter((function(e){return t.includes(e[0])||n.includes(e[0])})),c=Ie(i,r,t,n).schema;return c.position=c.position||[],c.color=c.color||[],c.opacity=c.opacity||[],c.size=c.size||[],c.shape=c.shape||[],c.geomType=c.geomType||[],c.highFacets=c.highFacets||[],c.facets=c.facets||[],{dimensions:t,measures:n,type:a,schema:c}})):[]}),[n,r,o]),x=Object(s.useMemo)((function(){return o.map((function(e){return e[3]}))}),[o]),E=Object(s.useMemo)((function(){return b.map((function(e,t){var n=e.dimensions,a=e.measures,r=e.schema,i=e.type,o=[],c=!0,s=!1,u=void 0;try{for(var l,d=function(){var e=l.value,t=x.find((function(t){return t.name===e}));o.push({name:e,semanticType:t?t.type:"nominal",type:"dimension"})},f=n[Symbol.iterator]();!(c=(l=f.next()).done);c=!0)d()}catch(E){s=!0,u=E}finally{try{c||null==f.return||f.return()}finally{if(s)throw u}}var m=!0,p=!1,g=void 0;try{for(var v,h=function(){var e=v.value,t=x.find((function(t){return t.name===e}));o.push({name:e,semanticType:t?t.type:"nominal",type:"measure"})},y=a[Symbol.iterator]();!(m=(v=y.next()).done);m=!0)h()}catch(E){p=!0,g=E}finally{try{m||null==y.return||y.return()}finally{if(p)throw g}}if("target"===i&&1===a.length)return{specIndex:t,type:"indicator",measures:a,operator:"sum"};var b={};return"target"===i&&(b=Ee(r,o)),"feature"===i&&(b=xe(r,o)),b.specIndex=t,b}))}),[b,x]),A=Object(s.useMemo)((function(){return n.map((function(e,t){return{sl:function(e,n){h[t]&&p((function(e){if(0===Object.keys(n).length)for(var t in e)e[t]=[];else for(var a in n)e[a]=n[a]}))}}}))}),[n,h,p]),S=Object(s.useMemo)((function(){for(var e=[],t=Object.keys(d).map((function(e){return{fieldName:e,filter:d[e],isRange:2===d[e].length&&"number"===typeof d[e][0]&&"number"===typeof d[e][1]&&d[e][0]<d[e][1]}})),a=r.filter((function(e){return t.every((function(t){return 0===t.filter.length||(t.isRange?e[t.fieldName]>=t.filter[0]&&e[t.fieldName]<=t.filter[1]:t.filter.includes(e[t.fieldName]))}))})),i=0;i<n.length;i++)h[i]?e.push(r):e.push(a);return e}),[n,d,r,h]);return u.a.createElement("div",null,u.a.createElement("div",null,E.filter((function(e){return"indicator"===e.type})).map((function(e,t){return u.a.createElement(Xt,{key:"ds-ind-chart-".concat(t),dataSource:S[e.specIndex],measures:e.measures})}))),u.a.createElement("div",null,E.filter((function(e){return"indicator"!==e.type})).map((function(e,t){return u.a.createElement("div",{key:"ds-chart-".concat(t),style:{display:"inline-block",padding:"4px",margin:"2px",height:"380px",overflowY:"auto"}},u.a.createElement("div",{style:{float:"left",minWidth:"300px",minHeight:"300px"}},u.a.createElement(Wt,{dataSource:S[e.specIndex],spec:e,signalHandler:h[e.specIndex]&&A[e.specIndex]})),u.a.createElement("div",{style:{float:"left"}},u.a.createElement(ae.a,{title:"use as filter",ariaLabel:"use as filter",iconProps:{iconName:h[e.specIndex]?"FilterSolid":"Filter"},onClick:function(){y((function(t){var n=Object(m.a)(t);return n[e.specIndex]=!n[e.specIndex],n[e.specIndex]||p((function(e){for(var t in e)e[t]=[]})),n}))}})))}))))},Zt=function(e){var t=U(),n=Object(f.a)(t,4),a=n[0],r=n[2],i=n[3],o=Object(s.useState)(0),c=Object(f.a)(o,2),l=c[0],d=c[1],m=a.subspaceList,p=a.cookedDataSource,g=a.cookedDimensions,v=a.cookedMeasures,h=a.dashBoardList,y=i.dimScores;return u.a.createElement("div",{className:"content-container"},u.a.createElement("div",{className:"card"},u.a.createElement(se.a,{text:"Generate Dashboard",disabled:0===m.length,iconProps:{iconName:"AreaChart"},onClick:function(){r("getDashBoard",{dataSource:p,dimensions:g,measures:v})}}),a.loading.dashBoard&&u.a.createElement(ne.a,{description:"generating dashboard"}),u.a.createElement(Ut.a,null,"current page no: ",l+1," of ",h.length),u.a.createElement(ie.a,{horizontal:!0,tokens:{childrenGap:20}},u.a.createElement(oe.a,{text:"Last",onClick:function(){d((function(e){return(e+h.length-1)%h.length}))},allowDisabledFocus:!0}),u.a.createElement(oe.a,{text:"Next",onClick:function(){d((function(e){return(e+1)%h.length}))},allowDisabledFocus:!0})),u.a.createElement("p",{className:"state-description"},"Double click the chart with selection to clear selection(filter)."),u.a.createElement("div",{style:{overflowX:"auto",margin:"1rem",border:"1px solid #e8e8e8"}},h[l]&&h[l].length>0&&u.a.createElement(Vt,{dataSource:p,dashBoard:h[l],dimScores:y}))))},_t=function(e){var t=e.x,n=e.y,a=e.threshold,r=e.dataSource,i=void 0===r?[]:r,o=Object(s.useMemo)((function(){return{width:180,height:200,data:{name:"dataSource"},transform:[{calculate:a.toString(),as:"threshold"}],layer:[{mark:"point",encoding:{x:{field:t,type:"nominal"},y:{field:n,type:"quantitative",scale:{domain:[0,1]}}}},{mark:"rule",encoding:{y:{field:"threshold",type:"quantitative"},color:{value:"red"}}}]}}),[t,n,a]);return u.a.createElement("div",null,u.a.createElement(Wt,{spec:o,dataSource:i}))},$t=n(61);Object($t.scheme)("threshold",["#1890ff","#ffccc7"]);var en,tn=function(e){var t=e.keyField,n=e.valueField,a=e.dataSource,r=void 0===a?[]:a,i=e.threshold,o=Object(s.useRef)(null),c=Object(s.useMemo)((function(){var e=r.map((function(e){return{key:e[t],value:Math.round(1e3*e[n])/1e3,category:0}}));Object.values(Ke).forEach((function(t){e.find((function(e){return e.key===t}))||e.push({key:t,value:0,category:0})}));var a=e.map((function(e){return{key:e.key,value:i,category:1}}));return e.concat(a)}),[t,n,r,i]);return Object(s.useEffect)((function(){o.current&&Object(be.a)(o.current,{width:280,height:280,padding:50,autosize:{type:"none",contains:"padding"},signals:[{name:"radius",update:"width / 2"}],data:[{name:"table",values:c},{name:"keys",source:"table",transform:[{type:"aggregate",groupby:["key"]}]}],scales:[{name:"angular",type:"point",range:{signal:"[-PI, PI]"},padding:.5,domain:{data:"table",field:"key"}},{name:"radial",type:"linear",range:{signal:"[0, radius]"},zero:!0,nice:!1,domain:[0,1],domainMin:0},{name:"color",type:"ordinal",domain:{data:"table",field:"category"},range:{scheme:"threshold"}}],encode:{enter:{x:{signal:"radius"},y:{signal:"radius"}}},marks:[{type:"group",name:"categories",zindex:1,from:{facet:{data:"table",name:"facet",groupby:["category"]}},marks:[{type:"line",name:"category-line",from:{data:"facet"},encode:{enter:{interpolate:{value:"linear-closed"},x:{signal:"scale('radial', datum.value) * cos(scale('angular', datum.key))"},y:{signal:"scale('radial', datum.value) * sin(scale('angular', datum.key))"},stroke:{scale:"color",field:"category"},strokeWidth:{value:1},fill:{scale:"color",field:"category"},fillOpacity:{value:.1}}}},{type:"text",name:"value-text",from:{data:"category-line"},encode:{enter:{x:{signal:"datum.x"},y:{signal:"datum.y"},text:{signal:"datum.datum.value"},align:{value:"center"},baseline:{value:"middle"},fill:{value:"#262626"}}}}]},{type:"rule",name:"radial-grid",from:{data:"keys"},zindex:0,encode:{enter:{x:{value:0},y:{value:0},x2:{signal:"radius * cos(scale('angular', datum.key))"},y2:{signal:"radius * sin(scale('angular', datum.key))"},stroke:{value:"lightgray"},strokeWidth:{value:1}}}},{type:"text",name:"key-label",from:{data:"keys"},zindex:1,encode:{enter:{x:{signal:"(radius + 5) * cos(scale('angular', datum.key))"},y:{signal:"(radius + 5) * sin(scale('angular', datum.key))"},text:{field:"key"},align:[{test:"abs(scale('angular', datum.key)) > PI / 2",value:"right"},{value:"left"}],baseline:[{test:"scale('angular', datum.key) > 0",value:"top"},{test:"scale('angular', datum.key) == 0",value:"middle"},{value:"bottom"}],fill:{value:"black"},fontWeight:{value:"bold"}}}},{type:"line",name:"outer-line",from:{data:"radial-grid"},encode:{enter:{interpolate:{value:"linear-closed"},x:{field:"x2"},y:{field:"y2"},stroke:{value:"lightgray"},strokeWidth:{value:1}}}}]},{actions:!1})}),[c]),u.a.createElement("div",{ref:o})};function nn(){var e=Object(at.a)(["\n  display: flex;\n  div.left{\n    flex-basis: 300px;\n    flex-grow: 1;\n    border-right: 1px solid #f0f0f0;\n  }\n  div.right{\n    margin-left: 1em;\n    flex-grow: 8;\n  }\n  padding: 1em 0em;\n"]);return nn=function(){return e},e}function an(){var e=Object(at.a)(["\n  display: inline-block;\n  padding: 0.1em 0.3em;\n  margin: 0.2em;\n  border-radius: 3px;\n  color: #fff;\n  font-size: 12px;\n  background-color: ",";\n"]);return an=function(){return e},e}var rn=ct.a.div(an(),(function(e){return e.color})),on=ct.a.div(nn()),cn=(en={},Object(ke.a)(en,Ke.outlier,"#cf1322"),Object(ke.a)(en,Ke.trend,"#7cb305"),Object(ke.a)(en,"general","#08979c"),Object(ke.a)(en,Ke.cluster,"#c41d7f"),en);function sn(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var un=function(e){var t=Object(s.useState)([]),n=Object(f.a)(t,2),a=n[0],r=n[1],i=Object(s.useState)(.6),o=Object(f.a)(i,2),c=o[0],l=o[1],d=Object(s.useState)(!1),m=Object(f.a)(d,2),p=m[0],g=m[1],y=Object(s.useState)({aggregator:"sum",defaultAggregated:!0,defaultStack:!0}),b=Object(f.a)(y,2),x=b[0],E=b[1],A=Z({show:{configPanel:!1}}),S=Object(f.a)(A,2),w=S[0],k=S[1],O=U(),j=Object(f.a)(O,4),C=j[0],M=(j[2],j[3]),I=Object(s.useState)(0),D=Object(f.a)(I,2),P=D[0],Q=D[1],T=C.cookedDataSource,F=C.cookedDimensions,z=C.cookedMeasures,G=C.topK,L=M.dimScores,R=Object(s.useMemo)((function(){return a.filter((function(e){return e.significance>=c}))}),[a,c]),K=Object(s.useMemo)((function(){if(0===R.length)return null;var e=R[P],t=e.dimensions,n=e.measures,a=L.filter((function(e){return t.includes(e[0])||n.includes(e[0])}));return{schema:Ie(a,T,t,n).schema,fieldFeatures:a.map((function(e){return e[3]})),dimensions:t,measures:n}}),[R,P,T]),Y=Object(s.useMemo)((function(){if(null!==K){var e=K.dimensions,t=K.measures;return a.filter((function(n){return!(!sn(e,n.dimensions)||!sn(t,n.measures))}))}return[]}),[a,K]);return Object(s.useEffect)((function(){if(null!==K){var e=K.schema;e.geomType&&(e.geomType.includes("point")||e.geomType.includes("density"))?E((function(e){return Object(h.a)({},e,{defaultAggregated:!1})})):E((function(e){return Object(h.a)({},e,{defaultAggregated:!0})}))}}),[K]),u.a.createElement("div",{className:"content-container"},u.a.createElement(ve,{show:w.show.configPanel,config:x,onUpdateConfig:function(e){E(e),k((function(e){e.show.configPanel=!1}))},onClose:function(){k((function(e){e.show.configPanel=!1}))}}),T.length>0&&u.a.createElement("div",{className:"card"},u.a.createElement(se.a,{text:"Get Insights",onClick:function(){g(!0),function(e,t,n){var a,r,i;return v.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return a=[],o.prev=1,r=new N.a,o.next=5,v.a.awrap(B(r,{dataSource:e,dimensions:t,measures:n}));case 5:if(!(i=o.sent).success){o.next=10;break}a=i.data,o.next=11;break;case 10:throw new Error("[getInsightViewSpace]"+i.message);case 11:r.terminate(),o.next=17;break;case 14:o.prev=14,o.t0=o.catch(1),console.error(o.t0);case 17:return o.abrupt("return",a);case 18:case"end":return o.stop()}}),null,null,[[1,14]])}(T,F.slice(0,F.length*G.dimensionSize),z).then((function(e){r(e),g(!1)}))}}),p&&u.a.createElement(ne.a,{description:"generating dashboard"}),u.a.createElement(on,null,u.a.createElement("div",{className:"left"},u.a.createElement(_t,{x:"type",y:"significance",dataSource:a,threshold:c}),u.a.createElement(Nt.a,{label:"significance threshold",max:100,value:100*c,valueFormat:function(e){return"".concat(e,"%")},showValue:!0,onChange:function(e){l(e/100),Q(0)}}),u.a.createElement("p",{className:"state-description"},"There are ",R.length," of views of which insight significance is no less than ",(100*c).toFixed(2)," %")),u.a.createElement("div",{className:"right"},u.a.createElement("div",{style:{width:"280px"}},u.a.createElement(re.a,{label:"Current Index",value:(P+1).toString(),min:0,max:R.length,step:1,iconProps:{iconName:"Search"},labelPosition:ce.a.start,onValidate:function(e){Q((Number(e)-1)%R.length)},onIncrement:function(){Q((P+1)%R.length)},onDecrement:function(){Q((P-1+R.length)%R.length)},incrementButtonAriaLabel:"Increase value by 1",decrementButtonAriaLabel:"Decrease value by 1"})),u.a.createElement("div",{style:{display:"flex",padding:"1em"}},u.a.createElement(tn,{dataSource:Y,threshold:c,keyField:"type",valueField:"significance"}),u.a.createElement("div",null,Y.length>0&&Y.filter((function(e){return e.significance>=c})).map((function(e,t){return u.a.createElement(rn,{key:t,color:cn[e.type]},e.type)})),R[P]&&u.a.createElement("p",{className:"state-description"},"Dimensions are ",R[P].dimensions,", and measures are ",R[P].measures,". ",u.a.createElement("br",null),"There is a significance of",(100*R[P].significance).toFixed(2),"% that there exits a ",R[P].type," in the graph. ",u.a.createElement("br",null),JSON.stringify(R[P].description)))),u.a.createElement("div",null))),R.length>0&&null!==K&&u.a.createElement("div",null,u.a.createElement(we,{aggregator:x.aggregator,defaultAggregated:x.defaultAggregated,defaultStack:x.defaultStack,dimensions:K.dimensions,measures:K.measures,dataSource:T,schema:K.schema,fieldFeatures:K.fieldFeatures}))),0===T.length&&u.a.createElement("div",{className:"card"},u.a.createElement("p",null,"Dev Page now is testing for different types of insight worker.",u.a.createElement("br",null),"If you see this hint, it means you have not upload dataSource or not click the 'extract insights' button in dataSource page which will produce a cooked dataSource for dev page.")))},ln=n(180),dn=function(e){var t=Object(s.useRef)(null),n=Object(s.useState)(!1),a=Object(f.a)(n,2),r=a[0],i=a[1],o=U(),c=Object(f.a)(o,2),l=c[0],d=c[1];return u.a.createElement("div",null,u.a.createElement("div",{ref:t},u.a.createElement(ln.a,{text:"Preference",iconProps:{iconName:"PlayerSettings"},onClick:function(){i(!0)}})),r&&u.a.createElement(It.a,{target:t.current,directionalHint:Ze.a.bottomLeftEdge,onDismiss:function(){i(!1)}},u.a.createElement("div",{style:{padding:"1rem"}},u.a.createElement(Mt.a,{label:"Be Cool",checked:l.beCool,onText:"On",offText:"Off",onChange:function(e,t){d((function(e){e.beCool=t||!1}))}}),u.a.createElement(Mt.a,{label:"Use Server",disabled:!0,checked:l.useServer,onText:"On",offText:"Off",onChange:function(e,t){d((function(e){e.useServer=t||!1}))}}))))},fn=["DataSource","NoteBook","Explore","DashBoard","Dev"].map((function(e,t){return{title:e,itemKey:"pivot-"+(t+1)}}));function mn(){var e,t=U(),n=Object(f.a)(t,1)[0],a=Z({show:{insightBoard:!1,fieldConfig:!1,configPanel:!1,dataConfig:!1},current:{pivotKey:fn[0].itemKey}}),r=Object(f.a)(a,2),i=r[0],o=r[1];return u.a.createElement("div",null,u.a.createElement("div",{className:"header-bar"},u.a.createElement("div",{className:"ms-Grid-row"},u.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md4 ms-lg1"},u.a.createElement("a",{href:"https://github.com/ObservedObserver/visual-insights",className:"logo"},u.a.createElement("img",{style:n.beCool?void 0:{width:"48px",marginTop:"4px"},src:(e=n.beCool,e?te.a:$.a),alt:"rath"}))),u.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md8 ms-lg8"},u.a.createElement(Y.a,{selectedKey:i.current.pivotKey,onLinkClick:function(e){e&&e.props.itemKey&&o((function(t){t.current.pivotKey=e.props.itemKey}))},headersOnly:!0},fn.map((function(e){return u.a.createElement(q.a,{key:e.itemKey,headerText:e.title,itemKey:e.itemKey})})))),u.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md8 ms-lg3"},u.a.createElement("div",{className:"header-toolbar"},u.a.createElement(dn,null))))),"pivot-3"===i.current.pivotKey&&u.a.createElement(pt,{subspaceList:n.subspaceList,dataSource:n.cookedDataSource,summary:n.summary}),"pivot-1"===i.current.pivotKey&&u.a.createElement(Kt,{onExtractInsights:function(){o((function(e){e.current.pivotKey="pivot-2",e.show.insightBoard=!0}))}}),"pivot-2"===i.current.pivotKey&&u.a.createElement("div",{className:"content-container"},u.a.createElement("div",{className:"card"},u.a.createElement(Bt,{summary:n.summary,subspaceList:n.subspaceList,dataSource:n.cookedDataSource}))),"pivot-4"===i.current.pivotKey&&u.a.createElement(Zt,null),"pivot-5"===i.current.pivotKey&&u.a.createElement(un,null))}var pn=n(173);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(pn.a)(),d.a.render(u.a.createElement((function(){return u.a.createElement(K,null,u.a.createElement(mn,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[185,1,2]]]);
//# sourceMappingURL=main.e340b010.chunk.js.map