DESC datasets.suicideRate
SELECT uniq(`country`),uniq(`year`),uniq(`sex`),uniq(`age`),uniq(`suicides_no`),uniq(`population`),uniq(`suicides/100k_pop`),uniq(`gdp_for_year($)`),uniq(`gdp_per_capita($)`),uniq(`generation`) FROM datasets.suicideRate;
SELECT COUNT(*) FROM datasets.suicideRate;
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `country`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `year`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `sex`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `age`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `suicides_no`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `population`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `suicides/100k_pop`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `gdp_for_year($)`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `gdp_per_capita($)`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM datasets.suicideRate GROUP BY `generation`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
SELECT min(`suicides_no`),max(`suicides_no`),min(`population`),max(`population`),min(`suicides/100k_pop`),max(`suicides/100k_pop`),min(`gdp_for_year($)`),max(`gdp_for_year($)`),min(`gdp_per_capita($)`),max(`gdp_per_capita($)`) FROM datasets.suicideRate;
DROP VIEW IF EXISTS test_view;
CREATE VIEW IF NOT EXISTS test_view AS SELECT *, case when `suicides_no` < 2792.25 then '(-Infinity, 2792.25)'
when `suicides_no` >= 2792.25 and `suicides_no` < 5584.5 then '[2792.25, 5584.5)'
when `suicides_no` >= 5584.5 and `suicides_no` < 8376.75 then '[5584.5, 8376.75)'
when `suicides_no` >= 8376.75 and `suicides_no` < 11169 then '[8376.75, 11169)'
when `suicides_no` >= 11169 and `suicides_no` < 13961.25 then '[11169, 13961.25)'
when `suicides_no` >= 13961.25 and `suicides_no` < 16753.5 then '[13961.25, 16753.5)'
when `suicides_no` >= 16753.5 and `suicides_no` < 19545.75 then '[16753.5, 19545.75)'
when `suicides_no` >= 19545.75 then '[19545.75, Infinity)' end
as `bin_suicides_no`,case when `population` < 5475895 then '(-Infinity, 5475895)'
when `population` >= 5475895 and `population` < 10951512 then '[5475895, 10951512)'
when `population` >= 10951512 and `population` < 16427129 then '[10951512, 16427129)'
when `population` >= 16427129 and `population` < 21902746 then '[16427129, 21902746)'
when `population` >= 21902746 and `population` < 27378363 then '[21902746, 27378363)'
when `population` >= 27378363 and `population` < 32853980 then '[27378363, 32853980)'
when `population` >= 32853980 and `population` < 38329597 then '[32853980, 38329597)'
when `population` >= 38329597 then '[38329597, Infinity)' end
as `bin_population`,case when `suicides/100k_pop` < 28.12125 then '(-Infinity, 28.12125)'
when `suicides/100k_pop` >= 28.12125 and `suicides/100k_pop` < 56.2425 then '[28.12125, 56.2425)'
when `suicides/100k_pop` >= 56.2425 and `suicides/100k_pop` < 84.36375 then '[56.2425, 84.36375)'
when `suicides/100k_pop` >= 84.36375 and `suicides/100k_pop` < 112.485 then '[84.36375, 112.485)'
when `suicides/100k_pop` >= 112.485 and `suicides/100k_pop` < 140.60625 then '[112.485, 140.60625)'
when `suicides/100k_pop` >= 140.60625 and `suicides/100k_pop` < 168.7275 then '[140.60625, 168.7275)'
when `suicides/100k_pop` >= 168.7275 and `suicides/100k_pop` < 196.84875 then '[168.7275, 196.84875)'
when `suicides/100k_pop` >= 196.84875 then '[196.84875, Infinity)' end
as `bin_suicides/100k_pop`,case when `gdp_for_year($)` < 2262541054671.875 then '(-Infinity, 2262541054671.875)'
when `gdp_for_year($)` >= 2262541054671.875 and `gdp_for_year($)` < 4525035189718.75 then '[2262541054671.875, 4525035189718.75)'
when `gdp_for_year($)` >= 4525035189718.75 and `gdp_for_year($)` < 6787529324765.625 then '[4525035189718.75, 6787529324765.625)'
when `gdp_for_year($)` >= 6787529324765.625 and `gdp_for_year($)` < 9050023459812.5 then '[6787529324765.625, 9050023459812.5)'
when `gdp_for_year($)` >= 9050023459812.5 and `gdp_for_year($)` < 11312517594859.375 then '[9050023459812.5, 11312517594859.375)'
when `gdp_for_year($)` >= 11312517594859.375 and `gdp_for_year($)` < 13575011729906.25 then '[11312517594859.375, 13575011729906.25)'
when `gdp_for_year($)` >= 13575011729906.25 and `gdp_for_year($)` < 15837505864953.125 then '[13575011729906.25, 15837505864953.125)'
when `gdp_for_year($)` >= 15837505864953.125 then '[15837505864953.125, Infinity)' end
as `bin_gdp_for_year($)`,case when `gdp_per_capita($)` < 16013.625 then '(-Infinity, 16013.625)'
when `gdp_per_capita($)` >= 16013.625 and `gdp_per_capita($)` < 31776.25 then '[16013.625, 31776.25)'
when `gdp_per_capita($)` >= 31776.25 and `gdp_per_capita($)` < 47538.875 then '[31776.25, 47538.875)'
when `gdp_per_capita($)` >= 47538.875 and `gdp_per_capita($)` < 63301.5 then '[47538.875, 63301.5)'
when `gdp_per_capita($)` >= 63301.5 and `gdp_per_capita($)` < 79064.125 then '[63301.5, 79064.125)'
when `gdp_per_capita($)` >= 79064.125 and `gdp_per_capita($)` < 94826.75 then '[79064.125, 94826.75)'
when `gdp_per_capita($)` >= 94826.75 and `gdp_per_capita($)` < 110589.375 then '[94826.75, 110589.375)'
when `gdp_per_capita($)` >= 110589.375 then '[110589.375, Infinity)' end
as `bin_gdp_per_capita($)` FROM datasets.suicideRate;
DESC test_view
SELECT uniq(`country`),uniq(`year`),uniq(`sex`),uniq(`age`),uniq(`suicides_no`),uniq(`population`),uniq(`suicides/100k_pop`),uniq(`gdp_for_year($)`),uniq(`gdp_per_capita($)`),uniq(`generation`),uniq(`bin_suicides_no`),uniq(`bin_population`),uniq(`bin_suicides/100k_pop`),uniq(`bin_gdp_for_year($)`),uniq(`bin_gdp_per_capita($)`) FROM test_view;
SELECT COUNT(*) FROM test_view;
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `country`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `year`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `sex`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `age`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `suicides_no`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `population`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `suicides/100k_pop`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `gdp_for_year($)`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `gdp_per_capita($)`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `generation`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `bin_suicides_no`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `bin_population`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `bin_suicides/100k_pop`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `bin_gdp_for_year($)`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with frequency_list as (SELECT COUNT(*) as frequency FROM test_view GROUP BY `bin_gdp_per_capita($)`),                total as (select sum(frequency) as total from frequency_list),                pb_list as (select (frequency_list.frequency / total.total) as pb from frequency_list, total)                 SELECT SUM(-pb * log2(pb)) FROM pb_list
with col1Totals as (select `country` as col1, count(*) as values_count from test_view group by `country`),            col2Totals as (select `country` as col2, count(*) as values_count from test_view group by `country`),            total as (select count(*) as values_count from test_view),            colPairs as (select `country` as col1, `country` as col2, count(*) as values_count from test_view group by `country`, `country`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`country`), uniq(`country`) from test_view
with col1Totals as (select `country` as col1, count(*) as values_count from test_view group by `country`),            col2Totals as (select `year` as col2, count(*) as values_count from test_view group by `year`),            total as (select count(*) as values_count from test_view),            colPairs as (select `country` as col1, `year` as col2, count(*) as values_count from test_view group by `country`, `year`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`country`), uniq(`year`) from test_view
with col1Totals as (select `country` as col1, count(*) as values_count from test_view group by `country`),            col2Totals as (select `sex` as col2, count(*) as values_count from test_view group by `sex`),            total as (select count(*) as values_count from test_view),            colPairs as (select `country` as col1, `sex` as col2, count(*) as values_count from test_view group by `country`, `sex`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`country`), uniq(`sex`) from test_view
with col1Totals as (select `country` as col1, count(*) as values_count from test_view group by `country`),            col2Totals as (select `age` as col2, count(*) as values_count from test_view group by `age`),            total as (select count(*) as values_count from test_view),            colPairs as (select `country` as col1, `age` as col2, count(*) as values_count from test_view group by `country`, `age`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`country`), uniq(`age`) from test_view
with col1Totals as (select `country` as col1, count(*) as values_count from test_view group by `country`),            col2Totals as (select `generation` as col2, count(*) as values_count from test_view group by `generation`),            total as (select count(*) as values_count from test_view),            colPairs as (select `country` as col1, `generation` as col2, count(*) as values_count from test_view group by `country`, `generation`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`country`), uniq(`generation`) from test_view
with col1Totals as (select `year` as col1, count(*) as values_count from test_view group by `year`),            col2Totals as (select `country` as col2, count(*) as values_count from test_view group by `country`),            total as (select count(*) as values_count from test_view),            colPairs as (select `year` as col1, `country` as col2, count(*) as values_count from test_view group by `year`, `country`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`year`), uniq(`country`) from test_view
with col1Totals as (select `year` as col1, count(*) as values_count from test_view group by `year`),            col2Totals as (select `year` as col2, count(*) as values_count from test_view group by `year`),            total as (select count(*) as values_count from test_view),            colPairs as (select `year` as col1, `year` as col2, count(*) as values_count from test_view group by `year`, `year`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`year`), uniq(`year`) from test_view
with col1Totals as (select `year` as col1, count(*) as values_count from test_view group by `year`),            col2Totals as (select `sex` as col2, count(*) as values_count from test_view group by `sex`),            total as (select count(*) as values_count from test_view),            colPairs as (select `year` as col1, `sex` as col2, count(*) as values_count from test_view group by `year`, `sex`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`year`), uniq(`sex`) from test_view
with col1Totals as (select `year` as col1, count(*) as values_count from test_view group by `year`),            col2Totals as (select `age` as col2, count(*) as values_count from test_view group by `age`),            total as (select count(*) as values_count from test_view),            colPairs as (select `year` as col1, `age` as col2, count(*) as values_count from test_view group by `year`, `age`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`year`), uniq(`age`) from test_view
with col1Totals as (select `year` as col1, count(*) as values_count from test_view group by `year`),            col2Totals as (select `generation` as col2, count(*) as values_count from test_view group by `generation`),            total as (select count(*) as values_count from test_view),            colPairs as (select `year` as col1, `generation` as col2, count(*) as values_count from test_view group by `year`, `generation`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`year`), uniq(`generation`) from test_view
with col1Totals as (select `sex` as col1, count(*) as values_count from test_view group by `sex`),            col2Totals as (select `country` as col2, count(*) as values_count from test_view group by `country`),            total as (select count(*) as values_count from test_view),            colPairs as (select `sex` as col1, `country` as col2, count(*) as values_count from test_view group by `sex`, `country`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`sex`), uniq(`country`) from test_view
with col1Totals as (select `sex` as col1, count(*) as values_count from test_view group by `sex`),            col2Totals as (select `year` as col2, count(*) as values_count from test_view group by `year`),            total as (select count(*) as values_count from test_view),            colPairs as (select `sex` as col1, `year` as col2, count(*) as values_count from test_view group by `sex`, `year`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`sex`), uniq(`year`) from test_view
with col1Totals as (select `sex` as col1, count(*) as values_count from test_view group by `sex`),            col2Totals as (select `sex` as col2, count(*) as values_count from test_view group by `sex`),            total as (select count(*) as values_count from test_view),            colPairs as (select `sex` as col1, `sex` as col2, count(*) as values_count from test_view group by `sex`, `sex`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`sex`), uniq(`sex`) from test_view
with col1Totals as (select `sex` as col1, count(*) as values_count from test_view group by `sex`),            col2Totals as (select `age` as col2, count(*) as values_count from test_view group by `age`),            total as (select count(*) as values_count from test_view),            colPairs as (select `sex` as col1, `age` as col2, count(*) as values_count from test_view group by `sex`, `age`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`sex`), uniq(`age`) from test_view
with col1Totals as (select `sex` as col1, count(*) as values_count from test_view group by `sex`),            col2Totals as (select `generation` as col2, count(*) as values_count from test_view group by `generation`),            total as (select count(*) as values_count from test_view),            colPairs as (select `sex` as col1, `generation` as col2, count(*) as values_count from test_view group by `sex`, `generation`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`sex`), uniq(`generation`) from test_view
with col1Totals as (select `age` as col1, count(*) as values_count from test_view group by `age`),            col2Totals as (select `country` as col2, count(*) as values_count from test_view group by `country`),            total as (select count(*) as values_count from test_view),            colPairs as (select `age` as col1, `country` as col2, count(*) as values_count from test_view group by `age`, `country`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`age`), uniq(`country`) from test_view
with col1Totals as (select `age` as col1, count(*) as values_count from test_view group by `age`),            col2Totals as (select `year` as col2, count(*) as values_count from test_view group by `year`),            total as (select count(*) as values_count from test_view),            colPairs as (select `age` as col1, `year` as col2, count(*) as values_count from test_view group by `age`, `year`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`age`), uniq(`year`) from test_view
with col1Totals as (select `age` as col1, count(*) as values_count from test_view group by `age`),            col2Totals as (select `sex` as col2, count(*) as values_count from test_view group by `sex`),            total as (select count(*) as values_count from test_view),            colPairs as (select `age` as col1, `sex` as col2, count(*) as values_count from test_view group by `age`, `sex`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`age`), uniq(`sex`) from test_view
with col1Totals as (select `age` as col1, count(*) as values_count from test_view group by `age`),            col2Totals as (select `age` as col2, count(*) as values_count from test_view group by `age`),            total as (select count(*) as values_count from test_view),            colPairs as (select `age` as col1, `age` as col2, count(*) as values_count from test_view group by `age`, `age`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`age`), uniq(`age`) from test_view
with col1Totals as (select `age` as col1, count(*) as values_count from test_view group by `age`),            col2Totals as (select `generation` as col2, count(*) as values_count from test_view group by `generation`),            total as (select count(*) as values_count from test_view),            colPairs as (select `age` as col1, `generation` as col2, count(*) as values_count from test_view group by `age`, `generation`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`age`), uniq(`generation`) from test_view
with col1Totals as (select `generation` as col1, count(*) as values_count from test_view group by `generation`),            col2Totals as (select `country` as col2, count(*) as values_count from test_view group by `country`),            total as (select count(*) as values_count from test_view),            colPairs as (select `generation` as col1, `country` as col2, count(*) as values_count from test_view group by `generation`, `country`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`generation`), uniq(`country`) from test_view
with col1Totals as (select `generation` as col1, count(*) as values_count from test_view group by `generation`),            col2Totals as (select `year` as col2, count(*) as values_count from test_view group by `year`),            total as (select count(*) as values_count from test_view),            colPairs as (select `generation` as col1, `year` as col2, count(*) as values_count from test_view group by `generation`, `year`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`generation`), uniq(`year`) from test_view
with col1Totals as (select `generation` as col1, count(*) as values_count from test_view group by `generation`),            col2Totals as (select `sex` as col2, count(*) as values_count from test_view group by `sex`),            total as (select count(*) as values_count from test_view),            colPairs as (select `generation` as col1, `sex` as col2, count(*) as values_count from test_view group by `generation`, `sex`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`generation`), uniq(`sex`) from test_view
with col1Totals as (select `generation` as col1, count(*) as values_count from test_view group by `generation`),            col2Totals as (select `age` as col2, count(*) as values_count from test_view group by `age`),            total as (select count(*) as values_count from test_view),            colPairs as (select `generation` as col1, `age` as col2, count(*) as values_count from test_view group by `generation`, `age`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`generation`), uniq(`age`) from test_view
with col1Totals as (select `generation` as col1, count(*) as values_count from test_view group by `generation`),            col2Totals as (select `generation` as col2, count(*) as values_count from test_view group by `generation`),            total as (select count(*) as values_count from test_view),            colPairs as (select `generation` as col1, `generation` as col2, count(*) as values_count from test_view group by `generation`, `generation`)            select sum(value) from (select pow(col1Totals.values_count * (col2Totals.values_count / total.values_count) - colPairs.values_count, 2) / (col1Totals.values_count * (col2Totals.values_count / total.values_count)) as value            from colPairs, total             inner join col1Totals on colPairs.col1 = col1Totals.col1            inner join col2Totals on colPairs.col2 = col2Totals.col2);
select count(*), uniq(`generation`), uniq(`generation`) from test_view
select corr(`suicides_no`, `suicides_no`) from test_view
select corr(`suicides_no`, `population`) from test_view
select corr(`suicides_no`, `suicides/100k_pop`) from test_view
select corr(`suicides_no`, `gdp_for_year($)`) from test_view
select corr(`suicides_no`, `gdp_per_capita($)`) from test_view
select corr(`population`, `suicides_no`) from test_view
select corr(`population`, `population`) from test_view
select corr(`population`, `suicides/100k_pop`) from test_view
select corr(`population`, `gdp_for_year($)`) from test_view
select corr(`population`, `gdp_per_capita($)`) from test_view
select corr(`suicides/100k_pop`, `suicides_no`) from test_view
select corr(`suicides/100k_pop`, `population`) from test_view
select corr(`suicides/100k_pop`, `suicides/100k_pop`) from test_view
select corr(`suicides/100k_pop`, `gdp_for_year($)`) from test_view
select corr(`suicides/100k_pop`, `gdp_per_capita($)`) from test_view
select corr(`gdp_for_year($)`, `suicides_no`) from test_view
select corr(`gdp_for_year($)`, `population`) from test_view
select corr(`gdp_for_year($)`, `suicides/100k_pop`) from test_view
select corr(`gdp_for_year($)`, `gdp_for_year($)`) from test_view
select corr(`gdp_for_year($)`, `gdp_per_capita($)`) from test_view
select corr(`gdp_per_capita($)`, `suicides_no`) from test_view
select corr(`gdp_per_capita($)`, `population`) from test_view
select corr(`gdp_per_capita($)`, `suicides/100k_pop`) from test_view
select corr(`gdp_per_capita($)`, `gdp_for_year($)`) from test_view
select corr(`gdp_per_capita($)`, `gdp_per_capita($)`) from test_view
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `country`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `year`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `year`,`age`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `year`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `year`,`age`,`generation`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no`,sum(`population`) as `sum_population`,sum(`gdp_for_year($)`) as `sum_gdp_for_year($)` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no`,sum(abs(`sum_population`)) as `abssum_sum_population`,sum(abs(`sum_gdp_for_year($)`)) as `abssum_sum_gdp_for_year($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`,abs(`sum_population`) / `abssum_sum_population` as `pb_population`,abs(`sum_gdp_for_year($)`) / `abssum_sum_gdp_for_year($)` as `pb_gdp_for_year($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no`,if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population`,if(`pb_gdp_for_year($)` = 0, 0, -`pb_gdp_for_year($)` * log2(`pb_gdp_for_year($)`)) as `safe_gdp_for_year($)` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`),sum(`safe_population`),sum(`safe_gdp_for_year($)`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`gdp_per_capita($)`) as `sum_gdp_per_capita($)` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_gdp_per_capita($)`)) as `abssum_sum_gdp_per_capita($)` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_gdp_per_capita($)`) / `abssum_sum_gdp_per_capita($)` as `pb_gdp_per_capita($)`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_gdp_per_capita($)` = 0, 0, -`pb_gdp_per_capita($)` * log2(`pb_gdp_per_capita($)`)) as `safe_gdp_per_capita($)` from pb_view)            select sum(safe_count), sum(`safe_gdp_per_capita($)`) from safe_value
SELECT * from datasets.suicideRate;
DESC datasets.suicideRate
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides/100k_pop`) as `sum_suicides/100k_pop` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides/100k_pop`)) as `abssum_sum_suicides/100k_pop` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides/100k_pop`) / `abssum_sum_suicides/100k_pop` as `pb_suicides/100k_pop`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides/100k_pop` = 0, 0, -`pb_suicides/100k_pop` * log2(`pb_suicides/100k_pop`)) as `safe_suicides/100k_pop` from pb_view)            select sum(safe_count), sum(`safe_suicides/100k_pop`) from safe_value
select `sex`, sum(`suicides/100k_pop`) as `suicides/100k_pop` from test_view group by `sex`
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
with agg_view as (select count(*) as values_count, sum(`suicides_no`) as `sum_suicides_no` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_suicides_no`)) as `abssum_sum_suicides_no` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_suicides_no`) / `abssum_sum_suicides_no` as `pb_suicides_no`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_suicides_no` = 0, 0, -`pb_suicides_no` * log2(`pb_suicides_no`)) as `safe_suicides_no` from pb_view)            select sum(safe_count), sum(`safe_suicides_no`) from safe_value
select `sex`, sum(`suicides_no`) as `suicides_no` from test_view group by `sex`
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
with agg_view as (select count(*) as values_count, sum(`population`) as `sum_population` from test_view group by `sex`),            abs_sum as (select sum(values_count) as abssum_values_count, sum(abs(`sum_population`)) as `abssum_sum_population` from agg_view),            pb_view as (select agg_view.values_count / abs_sum.abssum_values_count as pb_count,                abs(`sum_population`) / `abssum_sum_population` as `pb_population`                from agg_view, abs_sum),            safe_value as (select if(pb_count = 0, 0, -pb_count * log2(pb_count)) as safe_count, if(`pb_population` = 0, 0, -`pb_population` * log2(`pb_population`)) as `safe_population` from pb_view)            select sum(safe_count), sum(`safe_population`) from safe_value
select `sex`, sum(`population`) as `population` from test_view group by `sex`
